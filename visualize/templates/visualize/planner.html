{% extends "base.html" %}
{% load static %}

{% block title %}Marine Planner{% endblock %}

{% block extra_css %}
        <link href="{% static 'visualize/css/print.css' %}" rel="stylesheet" media="print">
        <link href="{% static 'visualize/css/scalebar-thin.css' %}" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="{% static 'visualize/deps/openlayers/theme/default/style.css' %}">
        <link href="{% static 'bower_components/jquery-ui/themes/smoothness/jquery-ui.min.css' %}" rel="stylesheet">
        <link href="{% static 'bower_components/jscrollpane/style/jquery.jscrollpane.css' %}" rel="stylesheet">
{% endblock%}

{% block body_class %}template-visualize{% endblock %}
{% block outer_content %}

        <!-- Check for Mobile Client -->
        <script type="text/javascript">
            var width = window.innerWidth;
            if (width < 768) {
                //window.location.href = "/mobile/mobile";
                window.location.pathname = "/mobile/mobile/";
            }
        </script>
        <!-- modals -->
        {% include "visualize/modals.html" %}
        {% if user.is_authenticated %}
        {% include "visualize/bookmark-modals.html" %}
        {% endif %}
        <!-- end modals -->

        <div class="container-fluid" id="primary-content">
            <div class="row" id="fullscreen">

                <!-- Map Panel (center panel) -->
                {% if user.is_authenticated %}
                <div id="map-panel" data-bind="css: { 'fullscreen-map': isFullScreen() && !showLayers() && !showLegend(), 'fullscreen-with-layers-authenticated': isFullScreen() && showLayers() && !showLegend(), 'fullscreen-with-legend': isFullScreen() && !showLayers() && showLegend(), 'fullscreen-with-legend-and-layers': isFullScreen() && showLayers() && showLegend(), 'shift-left': ! showLayers(), span12: !showLayers() && !showLegend(), span9: !showLayers() && showLegend(), span7: showLayers() && !showLegend(), span4: showLayers() && showLegend() }">
                {% else %}
                <div id="map-panel" data-bind="css: { 'fullscreen-map': isFullScreen() && !showLayers() && !showLegend(), 'fullscreen-with-layers': isFullScreen() && showLayers() && !showLegend(), 'fullscreen-with-legend': isFullScreen() && !showLayers() && showLegend(), 'fullscreen-with-legend-and-layers': isFullScreen() && showLayers() && showLegend(), 'shift-left': ! showLayers(), span12: !showLayers() && !showLegend(), span9: !showLayers() && showLegend(), span8: showLayers() && !showLegend(), span5: showLayers() && showLegend() }">
                {% endif %}
                    <div class="row">
                        <div id="map-wrapper">
                            <div id="map"></div>
                            <div id="map-controls"> <!-- Basemaps, Legends, Layers, Bookmarks, and FullScreen buttons -->
                                <div class="btn-group btn-group-vertical">
                                  <!-- Print Button -->
                                  <a class="btn" id="btn-print" onclick="window.print();" data-toggle="tooltip" data-placement="left" title="Print/Export">
                                    <i class="fa fa-print" id="print-icon"> </i>
                                  </a>

                                  <!--Hide/Show Legends Button-->
                                  <a id="btn-legend" class="btn" data-toggle="tooltip" title="Toggle Legends" data-placement="left" data-bind="click: toggleLegend">
                                      <i class="fa fa-list-ul"></i>
                                  </a>
                                  <!--Bookmarks Button-->
                                  <a id="bookmarks-button"  class="btn"  data-toggle="tooltip" data-placement="left" title="Toggle Bookmarks" data-bind="click: showBookmarks">
                                     <i class="fa fa-bookmark"></i>
                                  </a>
                                  <!--Map Links Button-->
                                  <a id="basemap-button" class="btn" data-toggle="tooltip" data-placement="left" title="Share&nbsp;this&nbsp;Map" href="#map-links-modal" data-toggle="modal" data-bind="click: resetMapLinks">
                                      <i class="fa fa-link"></i>
                                  </a>

                                  <!--Fullscreen Button-->
                                  <a class="btn" id="btn-fullscreen" data-toggle="tooltip" data-placement="left" title="Full Screen">
                                      <i class="fa fa-arrows-alt"></i>
                                  </a>
                                </div>
                            </div>
                            <div id="baselayers">
                                <div id="toggleBaselayer" data-bind="click: showBasemaps">
                                  <!--Baselayers Button-->
                                      Basemaps
                                </div>
                            </div>
                            <div id="map-buttons">
                                <!--
                                <p><a class="btn pull-right">
                                  Coordinates &amp; Depth
                                </a></p>
                                -->
                            </div>
                            <!-- the following container is used to estimate width for the actual Aggregated Attribution Overlay -->
                            <div id="aggregated-attribute-overlay-test" style="position: absolute; visibility: hidden; height: auto; width: auto; top:0px">
                                <div data-bind="foreach: attributeLayers()" style="overflow: hidden; max-height: 10px;">
                                    <div data-bind="css: {display: $root.aggregatedAttributes()[featureAttributionName] ? 'block' : 'none'}">
                                      <h4 data-bind="text: featureAttributionName"></h4>
                                      <dl data-bind="foreach: { data: $root.aggregatedAttributes()[featureAttributionName], afterAdd:$root.updateMarker }">
                                        <dt>
                                            <span data-bind="text: display"></span><span data-bind="visible: display && data ? true : data===0">:</span>
                                            <span style="font-weight: normal" data-bind="text: data"></span>
                                        </dt>
                                      </dl>
                                    </div>
                                </div>
                            </div>
                            <!-- Aggregated Attribution Overlay -->
                            <div data-bind="visible: showFeatureAttribution">
                                <div id="aggregated-attribute-overlay" class="scrollpane" data-bind="visible: aggregatedAttributes, style: {width: aggregatedAttributesWidth}" style="display: none">
                                    <div id="aggregated-attribute-heading">
                                        <h4>Available Information</h4>
                                    </div>
                                    <div id="aggregated-attribute-content" class="accordion">
                                        <div data-bind="foreach: attributeLayers()">
                                            <div class="accordion-group">
                                                <div data-bind="visible: $root.aggregatedAttributes()[featureAttributionName]">
                                                    <div class="accordion-heading" data-bind="click: toggleLayerAttribution">
                                                        <a class="accordion-toggle">
                                                            <span data-bind="text: featureAttributionName"></span>
                                                        </a>
                                                    </div>
                                                    <div class="accordion-body collapse in" data-bind="attr: { id: $root.convertToSlug(featureAttributionName) }" >
                                                        <div class="accordion-inner">
                                                            <dl data-bind="foreach: { data: $root.aggregatedAttributes()[featureAttributionName], afterAdd:$root.updateMarker }">
                                                                <dt>
                                                                    <!-- ko if: $data.hasOwnProperty("tab") -->
                                                                    <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                    <!-- /ko -->
                                                                    <span data-bind="text: display"></span><span data-bind="visible: display && data ? true : data===0">:</span>
                                                                    <span style="font-weight: normal" data-bind="text: data"></span>
                                                                </dt>
                                                            </dl>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <span id="close-attribute-overlay" class="pull-right"><a href="#" style="position: absolute; top: 0px; right: 0px; opacity: .6;" class="btn btn-mini close" data-bind="click: closeAttribution"> x </a> </span>
                                </div>
                            </div>

                            <!-- Bookmark Message -->
                            <div id="error-overlay" data-bind="visible: error() === 'restoreState'" style="display:none">
                                <div>
                                    <span class="pull-right">
                                        <a href="#" style="margin-left: 10px; opacity: .6;" class="close btn btn-mini" data-bind="click: closeAlert"> x </a>
                                        <a class="btn btn-mini" data-bind="click: bookmarks.restoreState">
                                            Return to Previous View
                                        </a>
                                    </span>
                                    <span data-bind="text: bookmarks.activeBookmark"></span>
                                    <div class="clearfix"></div>
                                </div>
                            </div>

                            <!-- FullScreen Fail Message -->
                            <div id="fullscreen-error-overlay" style="display:none">
                                <div>
                                    <span class="pull-right">
                                        <a href="#" style="margin-left: 10px; opacity: .6;" class="close btn btn-mini" data-bind="click: closeAlert"> x </a>

                                    </span>
                                    <span>We're sorry, the Fullscreen option is not supported in all browsers at this time...If it's important, you might try Firefox or Chrome.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row panel panel-default" data-bind="visible: showLayers()" id="left-panel">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <div id="left-maximized">
                                <form class="form-search" data-bind="submit: layerSearch">
                                    <div class="input-group">
                                        <input type="text" class="search-box form-control" data-provide="typeahead" data-bind="value: searchTerm, event: { keyup: keySearch }" style="overflow: hidden; text-overflow: ellipsis;" placeholder="Search">
                                        <span class="input-group-btn">
                                            <a class="btn">
                                                <i class="fa fa-search"></i>
                                            </a>
                                        </span>
                                    </div>
                                </form>
                            </div>
                            <a data-toggle="collapse" data-target="#collapsible-left-panel" class="collapse-button">
                                <i class="fa fa-angle-double-left"></i>
                            </a>
                        </h4>
                        <span class="panel-title">
                            <div style="display:none" id="left-minimized" >
                            <h4>
                                Data Layers
                            </h4>

                                <span data-bind="visible: activeLayers().length > 0">
                                    <span data-bind="text: activeLayers().length">0</span> Active
                                </span>
                        </div>
                        </span>
                    </div>
                    <div id="collapsible-left-panel" class="panel-collapse collapse in">
                      <div class="panel-body">
               <!-- Data Panel (left panel) -->


                {% if user.is_authenticated %}
                <div class="frame tabs" id="data-panel" data-bind="visible: showLayers(), css: {'fullscreen-data-authenticated': isFullScreen()}">
                {% else %}
                <div class="frame tabs" id="data-panel" data-bind="visible: showLayers(), css: {'fullscreen-data': isFullScreen()}">
                {% endif %}
                    <div class="sidebar-nav">
                        <!-- tab controls -->
                        <ul id="myTab" class="nav nav-tabs">
                            <li class="active" data-tab="active" >
                                <div class="row col-md-12">
                                <h4>
                                    <a href="#active" data-toggle="tab" id="activeTab">Active
                                        <span data-bind="visible: activeLayers().length > 0">
                                            &#8226;&nbsp;<span data-bind="text: activeLayers().length">0</span>
                                        </span>
                                    </a>
                                </h4>
                                </div>
                            </li>
                            <li data-tab="designs" {% if not user.is_authenticated %} class="disabled" {% endif %}>
                            <div class="row col-md-12">
                                <h4>
                                    <a href="#designs" data-toggle="tab" id="designsTab">Custom</a>
                                </h4> 
                                </div>
                            </li>
                            <li data-tab="data">
                            <div class="row col-md-12">

                                <h4>
                                    <a href="#data" data-toggle="tab" id="dataTab">Data Catalog</a>
                                </h4>
                            </div>
                            </li>
                        </ul>
                        <!-- tab body -->
                        <div id="myTabContent" class="tab-content">
                            <!-- ACTIVE TAB -->
                            <div class="tab-pane fade" id="active">
                                <div class="row-fluid">
                                    <div class="col-md-12">
                                        <div data-bind="visible: activeLayers().length === 0">
                                            <div style="padding: 10px;">
                                                <p>
                                                    You currently have no activated data layers.
                                                </p>
                                                <p>
                                                    Data layers that are activated in the Data panel will appear in this Active panel.
                                                </p>
                                                <p>
                                                    Data layers in the Active panel can be adjusted in terms of their transparency and their ordering on the map.
                                                </p>
                                            </div>
                                        </div>
                                        <ul class="unstyled list" data-bind="sortable: { data: activeLayers, options: {  } }">
                                            <li>
                                            <div class="active-wrapper">
                                                <table width="380px">
                                                    <tr>
                                                        <td width="10%">
                                                            <a class="btn btn-info-sign" data-bind="click: toggleDescription, css: { 'active': infoActive()}" data-toggle="tooltip" data-placement="right" title="More Info">
                                                                <i class="fa fa-info-circle"></i>
                                                            </a>
                                                        </td>
                                                        <td width="60%">
                                                            <a class="btn btn-layer" data-bind="css: { 'active': visible() }, click: toggleVisible">
                                                                <div class="btn-text" data-bind="text: name"></div>
                                                            </a>
                                                        </td>
                                                        <td width="10%">
                                                            <a class="btn btn-layer" >
                                                                <i class="fa" data-bind="css: { 'fa-check-circle-o active': visible(), 'fa-circle-o': ! visible() }, click: toggleVisible" data-toggle="tooltip" data-placement="left" title="Show/Hide layer"></i>
                                                            </a>
                                                        </td>
                                                        <td width="10%">
                                                            <a class="btn opacity-button" data-bind="click: $parent.showOpacity">
                                                                <i class="fa fa-adjust" data-toggle="tooltip" data-placement="left" title="Adjust opacity"></i>
                                                            </a>
                                                        </td>
                                                        <td width="10%">
                                                            <a class="btn" data-bind="click: toggleActive">
                                                                <i class="fa fa-times-circle" data-toggle="tooltip" data-placement="left" title="Remove layer"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                    <tr class="layer-info " data-bind="visible: infoActive()">
                                                        <td colspan="5">
                                                            <div class="link-bar">
                                                                <span data-toggle="tooltip" data-placement="bottom" title="Download for Google Maps">
                                                                    <!-- ko if: $data.hasOwnProperty("kml") -->
                                                                    <a class="btn btn-mini" data-bind="css: { disabled: ! kml }, attr: { href: kml }" target="_blank">
                                                                        kml <i class="fa fa-arrow-down" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                    <!-- ko ifnot: $data.hasOwnProperty("kml") -->
                                                                    <a class="btn btn-mini disabled">
                                                                        kml <i class="fa fa-arrow-down" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                </span>
                                                                <span data-toggle="tooltip" data-placement="bottom" title="Download ESRI Formatted Dataset">
                                                                    <!-- ko if: $data.hasOwnProperty("data_download") -->
                                                                    <a class="btn btn-mini" data-bind="css: { disabled: ! data_download }, attr: { href: data_download }" target="_blank">
                                                                        data <i class="fa fa-arrow-down" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                    <!-- ko ifnot: $data.hasOwnProperty("data_download") -->
                                                                    <a class="btn btn-mini disabled">
                                                                        data <i class="fa fa-arrow-down" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                </span>
                                                                <span data-toggle="tooltip" data-placement="bottom" title="Download Metadata">
                                                                    <!-- ko if: $data.hasOwnProperty("metadata") -->
                                                                    <a class="btn btn-mini" data-bind="css: { disabled: ! metadata }, attr: { href: metadata }" target="_blank">
                                                                        metadata <i class="fa fa-external-link-square" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                    <!-- ko ifnot: $data.hasOwnProperty("metadata") -->
                                                                    <a class="btn btn-mini disabled">
                                                                        metadata <i class="fa fa-external-link-square" ></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                </span>
                                                                <span data-toggle="tooltip" data-placement="bottom" title="Link to Dataset Source Provider">
                                                                    <!-- ko if: $data.hasOwnProperty("source") -->
                                                                    <a class="btn btn-mini" data-bind="css: { disabled: ! source }, attr: { href: source }" target="_blank">
                                                                        source <i class="fa fa-external-link-square"></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                    <!-- ko ifnot: $data.hasOwnProperty("source") -->
                                                                    <a class="btn btn-mini disabled">
                                                                        source <i class="fa fa-external-link-square"></i>
                                                                    </a>
                                                                    <!-- /ko -->
                                                                </span>
                                                            </div>
                                                            <div class="layer-text">
                                                                <span data-bind="truncatedText: overview, maxTextLength: 100"></span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!-- END ACTIVE TAB -->
                            <!-- DATA TAB -->
                            <div class="tab-pane active in fade" id="data">
                                <div class="row-fluid">

                                    <div class="row-fluid">
                                        <div class="col-md-12 accordion-wrapper">
                                            <!-- data accordion -->
                                            <div id="data-accordion">
                                                <div class="accordion" data-bind="foreach: themes">
                                                    <div class="accordion-group">
                                                        <div class="accordion-heading" data-bind="click: setOpenTheme, css: { 'active': isOpenTheme() }">
                                                            <div>
                                                                <a class="accordion-toggle">
                                                                    <span data-bind="text: name">Themes</span></a>
                                                            </div>
                                                        </div>
                                                        <div class="accordion-body collapse" data-bind="css: { 'in': isOpenTheme() }">
                                                            <div class="accordion-inner">
                                                                <ul  class="unstyled" data-bind="foreach: layers ">
                                                                    <li class="layer" data-bind="css: { nosublayers: subLayers.length === 0 }">
                                                                        <div class="btn-group btn-group-layer" data-bind="css: {'open': showSublayers() }, attr: {name: name}">
                                                                            <table width="380px" class="catalog-data">
                                                                                <tr>
                                                                                    <td width="10%">
                                                                                        <a class="btn btn-info-sign" data-bind="click: toggleDescription, css: { 'active': infoActive() }">
                                                                                            <i class="fa fa-info-circle"></i>
                                                                                        </a>
                                                                                    </td>
                                                                                    <td width="75%">
                                                                                        <a class="btn btn-layer" data-bind="css: { 'active': active(), 'not-active': ! active(), 'disabled': isDisabled() }, click: toggleActive, attr: { 'data-content': disabledMessage() }" rel="popover" data-placement="right" data-container="body">
                                                                                                <span data-bind="text: name"></span>
                                                                                                <span class="caret" style="display:none" data-bind="visible: subLayers.length > 0"></span>
                                                                                        </a>

                                                                                        
                                                                                    </td>
                                                                                    <td width="10%">
                                                                                        <a class="btn btn-layer" data-bind="css: { 'active': active(), 'not-active': ! active(), 'disabled': isDisabled() }, click: toggleActive, attr: { 'data-content': disabledMessage() }" rel="popover" data-placement="right" data-container="body">
                                                                                            <i class="fa" data-bind="css: { 'fa-check-circle-o active': visible(), 'fa-circle-o': ! visible() }, click: toggleVisible" data-toggle="tooltip" data-placement="left" title="Show/Hide layer"></i>
                                                                                         </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>

                                                                            <!-- ko if: subLayers.length > 0 -->
                                                                            <!-- ko if: !isCheckBoxLayer() -->
                                                                            <ul class="dropdown-menu layer-menu" data-bind="event: { mouseleave: closeMenu }">
                                                                                <li data-bind="foreach: subLayers">
                                                                                    <a data-bind="click: toggleActive">
                                                                                        <!--<span data-bind="style: {visibility: active() ? 'visible': 'hidden' }">• </span>-->
                                                                                        <span><i class="fa" data-bind="css: { 'fa-check-circle-o': visible(), 'fa-circle-o': ! visible() }"></i></span>
                                                                                        <span data-bind="text: name"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                            <!-- /ko -->
                                                                            <!-- ko if: isCheckBoxLayer() -->
                                                                            <ul class="dropdown-menu layer-menu" data-bind="event: { mouseleave: closeMenu }">
                                                                                <li data-bind="foreach: subLayers">
                                                                                    <a data-bind="click: toggleActive" style="padding-left: 15px">
                                                                                        <span><i class="fa" data-bind="css: { 'fa-check-square-o': visible(), 'fa-square-o': ! visible() }"></i></span>
                                                                                        <span data-bind="text: name"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                            <!-- /ko -->
                                                                            <!-- /ko -->

                                                                        </div>
                                                                        <div class="layer-info col-md-12" data-bind="visible: infoActive()">
                                                                            <div class="row-fluid">
                                                                                <div class="link-bar">
                                                                                    <span data-toggle="tooltip" data-placement="bottom" title="Download for Google Maps">
                                                                                        <a class="btn btn-mini" data-bind="css: { disabled: ! kml }, attr: { href: kml }" target="_blank">
                                                                                            kml <i class="fa fa-arrow-down" ></i>
                                                                                        </a>
                                                                                    </span>
                                                                                    <span data-toggle="tooltip" data-placement="bottom" title="Download ESRI Formatted Dataset">
                                                                                        <a class="btn btn-mini" data-bind="css: { disabled: ! data_download }, attr: { href: data_download }" target="_blank">
                                                                                            data <i class="fa fa-arrow-down" ></i>
                                                                                        </a>
                                                                                    </span>
                                                                                    <span data-toggle="tooltip" data-placement="bottom" title="Download Metadata">
                                                                                        <a class="btn btn-mini" data-bind="css: { disabled: ! metadata }, attr: { href: metadata }" target="_blank">
                                                                                            metadata <i class="fa fa-arrow-down" ></i>
                                                                                        </a>
                                                                                    </span>
                                                                                    <span data-toggle="tooltip" data-placement="bottom" title="Link to Dataset Source Provider">
                                                                                        <a class="btn btn-mini" data-bind="css: { disabled: ! source }, attr: { href: source }" target="_blank">
                                                                                            source <i class="fa fa-external-link-square"></i>
                                                                                        </a>
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                            <div class="row-fluid">
                                                                                <div class="layer-text col-md-10">
                                                                                    <span data-bind="truncatedText: overview, maxTextLength: 100"></span>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- /data-accordion -->
                                        </div>
                                    </div>
                                    <!-- /span -->
                                </div>
                                <!-- /row -->
                            </div>
                            <!-- END DATA TAB -->

                            <!-- DESIGNS TAB -->
                            {% if user.is_authenticated %}
                              {% include "visualize/scenarios.html" %}
                            {% endif %}
                            <!-- END DESIGNS TAB -->
                        </div>
                    </div>
                </div>


                <!-- /Data Panel -->

                      </div>
                    </div>
                  </div>
                </div>
            </div>
            <span class="timestamp" data-bind="visible: mapTitle"><span data-bind="text: new Date().toString('M/d/yyyy HH:mm')"></span></span>
        </div>

        <!--/row-->

        <!--/.fluid-container-->

        <!-- transparency tool -->
        <div style="display:none" id="opacity-popover" class="popover fade bottom in">
            <div class="arrow">
            </div>
            <div class="popover-inner">
                <div class="popover-content" data-bind="if: selectedLayer">
                    <div class="slider" data-bind="jqSlider: selectedLayer().opacity, jqOptions: { min: 0, max: 1, step: .01, range: 'min' }"></div>
                </div>
            </div>
        </div>

        {% include "visualize/bookmarks.html" %}

        {% include "visualize/legend.html" %}

    {% endblock %}

    {% block extra_js %}
        <script src="{% static 'bower_components/amplify/lib/amplify.min.js' %}"></script>
        <script src="{% static 'bower_components/jquery-migrate/jquery-migrate.min.js' %}"></script>
        <script src="{% static 'bower_components/jquery.bbq/jquery.ba-bbq.js' %}"></script>
        <script src="{% static 'bower_components/bootstrap3-typeahead/bootstrap3-typeahead.min.js' %}"></script>
        <script src="{% static 'bower_components/jquery-ui/jquery-ui.min.js' %}"></script>
        <<script charset="utf-8">
          $.widget.bridge('uitooltip', $.ui.tooltip);
        </script>
        <script src="{% static 'bower_components/lodash/dist/lodash.min.js' %}"></script>
        <script src="{% static 'bower_components/knockout/build/output/knockout-latest.js' %}"></script>
        <script src="{% static 'visualize/js/knockout-bindings.js' %}"></script>
        <script src="{% static 'bower_components/knockout-mapping/build/output/knockout.mapping-latest.js' %}"></script>
        <script src="{% static 'visualize/deps/highcharts/highcharts.js' %}" type="text/javascript"></script>
        <script src="{% static 'visualize/deps/highcharts/highcharts-more.js' %}" type="text/javascript"></script>
        <script src="http://maps.google.com/maps/api/js?v=3.6&amp;sensor=false"></script>
        <script src="{% static 'visualize/deps/openlayers/OpenLayers-marco-min.js' %}"></script>
        <script src="{% static 'bower_components/bigscreen/bigscreen.js' %}"></script>
        <script src="{% static 'bower_components/jqueryui-touch-punch/jquery.ui.touch-punch.min.js' %}"></script>

        <script src="{% static 'visualize/js/fixtures.js' %}"></script>
        <script src="{% static 'visualize/js/controls.js' %}"></script>
        <script src="{% static 'visualize/js/map.js' %}"></script>
        <script src="{% static 'visualize/js/state.js' %}"></script>
        <script src="{% static 'visualize/js/models.js' %}"></script>
        <script src="{% static 'visualize/js/bookmarks.js' %}"></script>
        {% if user.is_authenticated %}
            <script src="{% static 'visualize/js/scenarios.js' %}"></script>
            <script src="{% static 'visualize/js/reports.js' %}"></script>
            <script src="{% static 'visualize/js/drawing.js' %}"></script>
        {% endif %}
        <script src="{% static 'visualize/js/server.js' %}"></script>
        <script src="{% static 'visualize/js/app.js' %}"></script>


{% endblock %}
