(()=>{var e={420:e=>{var t=Object.prototype.toString,n="undefined"!=typeof Buffer&&"function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;e.exports=function(e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return a=e,"ArrayBuffer"===t.call(a).slice(8,-1)?function(e,t,r){t>>>=0;var i=e.byteLength-t;if(i<0)throw new RangeError("'offset' is out of bounds");if(void 0===r)r=i;else if((r>>>=0)>i)throw new RangeError("'length' is out of bounds");return n?Buffer.from(e.slice(t,t+r)):new Buffer(new Uint8Array(e.slice(t,t+r)))}(e,r,i):"string"==typeof e?function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');return n?Buffer.from(e,t):new Buffer(e,t)}(e,r):n?Buffer.from(e):new Buffer(e);var a}},747:(e,t,n)=>{!function(){var t=Object.freeze({__proto__:null,get default(){return t},get getUniqueName(){return f},get isFunction(){return l},get isObject(){return d},get clamp(){return p},get isArray(){return h},get isNumber(){return g},get isValidNumber(){return m},get isFiniteNumber(){return y},get isNonNegNumber(){return v},get isInteger(){return b},get isEven(){return x},get isOdd(){return _},get isString(){return w},get isDate(){return S},get isBoolean(){return A},get formatDateISO(){return I},get toArray(){return M},get isArrayLike(){return P},get addslashes(){return E},get regexEscape(){return j},get htmlEscape(){return F},get defaults(){return k},get extend(){return N},get inherit(){return C},get reduceAsync(){return z},get merge(){return T},get difference(){return L},get intersection(){return B},get indexOf(){return D},get contains(){return R},get some(){return U},get every(){return q},get find(){return G},get range(){return V},get repeat(){return $},get sum(){return J},get getArrayBounds(){return Y},get uniq(){return W},get pluck(){return H},get countValues(){return X},get indexOn(){return Q},get groupBy(){return Z},get arrayToIndex(){return K},get forEach(){return ee},get forEachProperty(){return te},get initializeArray(){return ne},get replaceArray(){return re},get repeatString(){return ie},get splitLines(){return ae},get pluralSuffix(){return oe},get endsWith(){return se},get lpad(){return ue},get rpad(){return ce},get trim(){return fe},get ltrim(){return de},get rtrim(){return he},get addThousandsSep(){return ge},get numToStr(){return me},get formatNumber(){return ye},get formatIntlNumber(){return ve},get formatNumberForDisplay(){return be},get shuffle(){return xe},get sortOn(){return _e},get genericSort(){return we},get getSortedIds(){return Se},get sortArrayIndex(){return Ae},get reorderArray(){return Ie},get getKeyComparator(){return Me},get getGenericComparator(){return Pe},get quicksort(){return Ee},get quicksortPartition(){return je},get findRankByValue(){return Oe},get findValueByPct(){return Fe},get findValueByRank(){return ke},get findMedian(){return Ne},get findQuantile(){return Ce},get mean(){return ze},get format(){return Te},get formatter(){return Be},get wildcardToRegExp(){return De},get createBuffer(){return Re},get expandoBuffer(){return Ue},get copyElements(){return qe},get extendBuffer(){return Ge},get mergeNames(){return Ve},get findStringPrefix(){return $e},get parsePercent(){return Je},get formatVersionedName(){return Ye},get uniqifyNames(){return We},get parseString(){return He},get parseNumber(){return Xe},get parseIntlNumber(){return Qe},get cleanNumericString(){return Ke},get trimQuotes(){return tt}}),r={};function i(e,t){e in r&&lt("Tried to replace a stashed variable:",e),r[e]=t}function a(e){if(e in r!=0)return r[e]}function o(){r={}}var s=Object.freeze({__proto__:null,stashVar:i,getStashedVar:a,clearStash:o}),u="undefined"!=typeof Buffer?Buffer:n(420).Buffer,c=0;function f(e){return(e||"__id_")+ ++c}function l(e){return"function"==typeof e}function d(e){return e===Object(e)}function p(e,t,n){return e<t?t:e>n?n:e}function h(e){return Array.isArray(e)}function g(e){return null!=e&&e.constructor==Number}function m(e){return g(e)&&!isNaN(e)}function y(e){return m(e)&&e!==1/0&&e!==-1/0}function v(e){return g(e)&&e>=0}function b(e){return g(e)&&(0|e)===e}function x(e){return e%2==0}function _(e){return e%2==1}function w(e){return null!=e&&e.toString===String.prototype.toString}function S(e){return!!e&&e.getTime===Date.prototype.getTime}function A(e){return!0===e||!1===e}function I(e){return S(e)?e.toISOString().replace(":00.000Z","Z"):""}function M(e){var t;P(e)||lt("toArray() requires an array-like object");try{t=Array.prototype.slice.call(e,0)}catch(i){t=[];for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}return t}function P(e){return!!e&&(!!h(e)||!w(e)&&(0===e.length||e.length>0))}function E(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}function j(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function F(e){return String(e).replace(/[&<>"'/]/g,(function(e){return O[e]}))}function k(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t]||{};for(var i in r)i in e==0&&r.hasOwnProperty(i)&&(e[i]=r[i])}return e}function N(e){var t,n,r,i=e||{},a=arguments.length;for(n=1;n<a;n++)for(t in r=arguments[n]||{})r.hasOwnProperty(t)&&(i[t]=r[t]);return i}function C(e,t){var n=function(){this.__super__==n&&(this.__super__=t.prototype.__super__,t.apply(this,arguments),delete this.__super__)};n.prototype=t.prototype||t,e.prototype=N(new n,e.prototype),e.prototype.constructor=e,e.prototype.__super__=n}function z(e,t,n,r){var i="undefined"==typeof setImmediate?setTimeout:setImmediate,a=0;!function t(o,s){if(o)return r(o,null);i((function(){a<e.length==0?r(null,s):n(s,e[a++],t)}),0)}(null,t)}function T(e,t){h(e)&&h(t)||lt("Usage: merge(destArray, srcArray);");for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e}function L(e,t){var n=K(t);return e.filter((function(e){return!Object.prototype.hasOwnProperty.call(n,e)}))}function B(e,t){return e.filter((function(e){return t.includes(e)}))}function D(e,t){for(var n=t!=t,r=0,i=e.length||0;r<i;r++){if(e[r]===t)return r;if(n&&e[r]!=e[r])return r}return-1}function R(e,t){return w(e)?-1!=e.indexOf(t):P(e)?-1!=D(e,t):void lt("Expected Array or String argument")}function U(e,t){return e.reduce((function(e,n){return e||t(n)}),!1)}function q(e,t){return e.reduce((function(e,n){return e&&t(n)}),!0)}function G(e,t,n){var r=e.filter(t,n);return 0===r.length?null:r[0]}function V(e,t,n){for(var r=[],i=void 0===t?0:t,a=void 0===n?1:n;e--;)r.push(i),i+=a;return r}function $(e,t){for(var n,r=[],i=0;i<e;i++)void 0!==(n=t(i))&&(r[i]=n);return r.length>0?r:void 0}function J(e,t){P(e)||lt("sum() expects an array, received:",e);for(var n,r=0,i=0,a=0,o=e.length;a<o;a++)(n=e[a])?r+=n:isNaN(n)&&i++;return t&&(t.nan=i),r}function Y(e){for(var t,n=1/0,r=-1/0,i=0,a=0,o=e.length;a<o;a++)(t=e[a])!=t&&i++,t<n&&(n=t),t>r&&(r=t);return{min:n,max:r,nan:i}}function W(e){for(var t,n=new Set,r=[],i=0,a=e.length;i<a;i++)t=e[i],n.has(t)||(r.push(t),n.add(t));return r}function H(e,t){return e.map((function(e){return e[t]}))}function X(e){return e.reduce((function(e,t){return e[t]=t in e?e[t]+1:1,e}),{})}function Q(e,t){return e.reduce((function(e,n){return e[n[t]]=n,e}),{})}function Z(e,t){return e.reduce((function(e,n){var r=n[t];return r in e?e[r].push(n):e[r]=[n],e}),{})}function K(e,t){var n=arguments.length>1;return e.reduce((function(e,r){return e[r]=!n||t,e}),{})}function ee(e,t,n){if(!P(e))throw new Error("#forEach() takes an array-like argument. "+e);for(var r=0,i=e.length;r<i;r++)t.call(n,e[r],r)}function te(e,t,n){Object.keys(e).forEach((function(r){t.call(n,e[r],r)}))}function ne(e,t){for(var n=0,r=e.length;n<r;n++)e[n]=t;return e}function re(e,t){e.splice(0,e.length);for(var n=0,r=t.length;n<r;n++)e.push(t[n])}function ie(e,t){for(var n="",r=0;r<t;r++)n+=e;return n}function ae(e){return e.split(/\r?\n/)}function oe(e){return 1!=e?"s":""}function se(e,t){return-1!==e.indexOf(t,e.length-t.length)}function ue(e,t,n){return ie(n=n||" ",t-(e=String(e)).length)+e}function ce(e,t,n){return n=n||" ",(e=String(e))+ie(n,t-e.length)}function fe(e){return de(he(e))}var le=/^\s+/;function de(e){return e.replace(le,"")}var pe=/\s+$/;function he(e){return e.replace(pe,"")}function ge(e){for(var t="",n="-"==e[0]?1:0,r=e.indexOf("."),i=e.length,a=(-1==r?i:r)-3;a>n;)t=","+e.substring(a,i)+t,i=a,a-=3;return e.substring(0,i)+t}function me(e,t){return t>=0?e.toFixed(t):String(e)}function ye(e){return e+""}function ve(e){return'"'+ye(e).replace(".",",")+'"'}function be(e,t,n,r){var i;return isNaN(e)?i=n||"-":(i=ge(i=me(e,t)),r&&parseFloat(i)>0&&(i="+"+i)),i}function xe(e){var t,n,r;for(n=e.length-1;n>0;n--)r=Math.floor(Math.random()*(n+1)),t=e[n],e[n]=e[r],e[r]=t}function _e(e){for(var t=[],n=1;n<arguments.length;n+=2)t.push(Me(arguments[n],arguments[n+1]));return e.sort((function(e,n){for(var r=0,i=0,a=t.length;i<a&&0===r;)r=t[i](e,n),i++;return r})),e}function we(e,t){var n=Pe(t);return Array.prototype.sort.call(e,n),e}function Se(e,t){var n=V(e.length);return Ae(n,e,t),n}function Ae(e,t,n){var r=Pe(n);e.sort((function(e,n){var i=r(t[e],t[n]);return i>0||0===i&&e>n?1:-1}))}function Ie(e,t){for(var n=t.length,r=[],i=0;i<n;i++){var a=t[i];(a<0||a>=n)&&lt("Out-of-bounds array idx"),r[i]=e[a]}re(e,r)}function Me(e,t){var n=Pe(t);return function(t,r){return n(t[e],r[e])}}function Pe(e){return e=!1!==e,function(t,n){var r=0;return null==n?r=null==t?0:-1:null==t?r=1:t<n?r=e?-1:1:t>n?r=e?1:-1:t!=t?r=1:n!=n&&(r=-1),r}}function Ee(e,t){return je(e,0,e.length-1),!1===t&&Array.prototype.reverse.call(e),e}function je(e,t,n){for(var r,i,a=t,o=n;a<n;){for(r=e[t+n>>1];a<=o;){for(;e[a]<r;)a++;for(;e[o]>r;)o--;a<=o&&(i=e[a],e[a]=e[o],e[o]=i,a++,o--)}t<o&&je(e,t,o),t=a,o=n}}function Oe(e,t){if(isNaN(t))return e.length;for(var n=1,r=0,i=e.length;r<i;r++)t>e[r]&&n++;return n}function Fe(e,t){return ke(e,Math.ceil((1-t)*e.length))}function ke(e,t){(!e.length||t<1||t>e.length)&&lt("[findValueByRank()] invalid input");for(var n,r,i,a,o=(t=p(0|t,1,e.length))-1,s=0,u=e.length-1;s<u;){i=e[o],n=s,r=u;do{for(;e[n]<i;)n++;for(;i<e[r];)r--;n<=r&&(a=e[n],e[n]=e[r],e[r]=a,n++,r--)}while(n<=r);r<o&&(s=n),o<n&&(u=r)}return e[o]}function Ne(e){return Ce(e,.5)}function Ce(e,t){var n=e.length,r=Math.floor((n-1)*t),i=Math.ceil((n-1)*t);if(r<0||i>=n)return NaN;var a=ke(e,r+1);return r==i?a:(a*(i/(n-1)-t)+ke(e,i+1)*(t-r/(n-1)))*(n-1)}function ze(e){for(var t,n=0,r=NaN,i=0,a=e.length;i<a;i++)t=e[i],isNaN(t)||(r=1==++n?t:t/n+(n-1)/n*r);return r}function Te(e){var t=Be(e),n=t.apply(null,Array.prototype.slice.call(arguments,1));return n}function Le(e,t){var n,r,i,a=t[1],o=t[2],s=t[3]?parseInt(t[3].substr(1)):void 0,u=t[4],c="s"==u,f="x"==u||"X"==u,l=!c,d="",p=0,h=!1,g=!1;if(c?n=String(e):f?(n=e.toString(16),"X"==u&&(n=n.toUpperCase())):l&&("-"==(n=me(e,s))[0]&&(g=!0,n=n.substr(1)),h=0==parseFloat(n),-1==a.indexOf("'")&&-1==a.indexOf(",")||(n=ge(n)),h||(g?d="−":-1!=a.indexOf("+")&&(d="+"))),o){var m=n.length+d.length,y=parseInt(o,10);m<y&&(p=y-m,i=ie(r=-1==a.indexOf("0")?" ":"0",p))}return 0==p?d+n:"0"==r?d+i+n:i+d+n}function Be(e){for(var t,n=/%([',+0]*)([1-9]?)((?:\.[1-9])?)([sdifxX%])/g,r=[],i=[],a=0,o="",s=n.exec(e);s;)t=e.substring(a,n.lastIndex-s[0].length),"%%"==s[0]?o+=t+"%":(r.push(o+t),o="",i.push(s)),a=n.lastIndex,s=n.exec(e);return r.push(o+e.substr(a)),function(){var t=r[0],n=arguments.length;n!=i.length&&lt("[format()] Data does not match format string; format:",e,"data:",arguments);for(var a=0;a<n;a++)t+=Le(arguments[a],i[a])+r[a+1];return t}}function De(e){var t=e.split("*").map((function(e){return j(e)})).join(".*");return new RegExp("^"+t+"$")}function Re(e,t){return b(e)?u.allocUnsafe?u.allocUnsafe(e):new u(e):u.from&&u.allocUnsafe?u.from(e,t):new u(e,t)}function Ue(e,t){var n,r=0,i=t>=1?t:1.2;return function(t){return t>r&&(r=Math.ceil(t*i),n=e?new e(r):Re(r)),n}}function qe(e,t,n,r,i,a){var o,s=e==n||e.buffer&&e.buffer==n.buffer,u=1,c=0;if(a&&(s&&lt("copy error"),u=-1,c=i-1),s&&r>t)for(o=i-1;o>=0;o--)n[r+o]=e[t+o];else for(o=0;o<i;o++,c+=u)n[o+r]=e[t+c]}function Ge(e,t,n){var r=Math.max(e.length,t),i=n||e.length,a=new e.constructor(r);return qe(e,0,a,0,i),a}function Ve(e,t){var n;return e&&t&&(n=$e(e,t).replace(/[-_]$/,"")),n||""}function $e(e,t){for(var n=0,r=e.length;n<r&&e[n]===t[n];n++);return e.substr(0,n)}function Je(e){var t,n=String(e);return(t=n.indexOf("%")>0?Number(n.replace("%",""))/100:Number(n))>=0&&t<=1||dt(Te("Invalid percentage: %s",n)),t}function Ye(e,t){var n=String(t);return/[0-9]$/.test(e)&&(n="-"+n),e+n}function We(e,t){var n=X(e),r=t||Ye,i=[];return e.forEach((function(e){for(var t,a=0,o=e;i.indexOf(o)>-1||o==e&&n[o]>1||o!=e&&n[o]>0;){if(a++,!(t=r(e,a))||t==o)throw new Error("Naming error");o=t}i.push(o)})),i}function He(e){return e||""}function Xe(e){return Ze(e,Ke)}function Qe(e){return Ze(e,et)}function Ze(e,t){var n=String(e).trim(),r=n?Number(t(n)):NaN;return isNaN(r)?null:r}function Ke(e){return e.indexOf(",")>0?e.replace(/,([0-9]{3})/g,"$1"):e}function et(e){return(e=e.replace(/[ .]([0-9]{3})/g,"$1")).replace(",",".")}function tt(e){var t,n,r=e.length;return r>=2&&(t=e.charAt(0),n=e.charAt(r-1),'"'==t&&'"'==n&&!e.includes('","')||"'"==t&&"'"==n&&!e.includes("','"))?e.substr(1,r-2):e}var nt,rt,it,at=!1,ot=!1,st=function(){throw new _t(At(arguments))};function ut(){gt((function(){Mt(arguments)}),(function(){var e=t.toArray(arguments).join(" ");throw new Error(e)}),(function(){throw new xt(At(arguments))}))}function ct(){at=!0}function ft(){return!!at}function lt(){nt.apply(null,t.toArray(arguments))}function dt(){rt.apply(null,t.toArray(arguments))}function pt(){st.apply(null,t.toArray(arguments))}function ht(){it.apply(null,It(arguments))}function gt(e,t,n){it=e,nt=t,rt=n}function mt(){ot=!0,it(t.toArray(arguments)),ot=!1}function yt(){a("VERBOSE")&&ht.apply(null,arguments)}function vt(){a("DEBUG")&&Mt(arguments)}function bt(e){var n;at&&(t.isString(e)&&(e=new xt(e)),"NonFatalError"==e.name?console.error(It([e.message]).join(" ")):"UserError"==e.name?(n=e.message,/Error/.test(n)||(n="Error: "+n),console.error(It([n]).join(" ")),console.error("Run mapshaper -h to view help")):console.error(e))}function xt(e){var t=new Error(e);return t.name="UserError",t}function _t(e){var t=new Error(e);return t.name="NonFatalError",t}function wt(e,t){var n=e.reduce((function(e,t){return t.map((function(t,n){return e?Math.max(e[n],t.length):t.length}))}),null);return e.map((function(e){return"  "+(e=e.map((function(e,r){return(t&&"right"==t[r]?e.padStart:e.padEnd).bind(e)(n[r]," ")}))).join(" ")})).join("\n")}function St(e){var n=e.reduce((function(e,t){return Math.max(e,t.length)}),0)+2,r=Math.floor(80/n)||1;return e.reduce((function(e,i,a){var o=a%r;return a>0&&0===o&&(e+="\n"),o<r-1&&(i=t.rpad(i,n-2," ")),e+"  "+i}),"")}function At(e){return t.toArray(e).join(" ")}function It(e){var n=t.toArray(e),r=a("current_command");return r&&"help"!=r&&n.unshift("["+r+"]"),n}function Mt(e){if(at&&!a("QUIET")&&t.isArrayLike(e)){var n=At(e);ot?console.log(n):console.error(n)}}ut();var Pt=Object.freeze({__proto__:null,getLoggingSetter:function(){var e=nt,t=rt,n=it;return function(){gt(n,e,t)}},setLoggingForCLI:ut,enableLogging:ct,loggingEnabled:ft,error:lt,stop:dt,interrupt:pt,message:ht,setLoggingFunctions:gt,print:mt,verbose:yt,debug:vt,printError:bt,UserError:xt,NonFatalError:_t,formatColumns:wt,formatStringsAsGrid:St,formatLogArgs:At,logArgs:Mt});function Et(){this.mx=this.my=1,this.bx=this.by=0}function jt(){arguments.length>0&&this.setBounds.apply(this,arguments)}function Ot(e){var t=new jt;return Nt(e,(function(e){t.mergePoint(e[0],e[1])})),t}function Ft(e,t){var n,r=e?e.length:0;t||(t=new jt);for(var i=0;i<r;i++)n=e[i],t.mergePoint(n[0],n[1]);return t}function kt(e){var t=[];return Nt(e.shapes,(function(e){t.push(e)})),t}function Nt(e,t){var n,r,i,a,o;for(n=0,r=e.length;n<r;n++)for(i=0,a=(o=e[n])?o.length:0;i<a;i++)t(o[i],n)}Et.prototype.isNull=function(){return!this.mx||!this.my||isNaN(this.bx)||isNaN(this.by)},Et.prototype.invert=function(){var e=new Et;return e.mx=1/this.mx,e.my=1/this.my,e.bx=-this.bx/this.mx,e.by=-this.by/this.my,e},Et.prototype.transform=function(e,t,n){return(n=n||[])[0]=e*this.mx+this.bx,n[1]=t*this.my+this.by,n},Et.prototype.toString=function(){return JSON.stringify(Object.assign({},this))},jt.from=function(){var e=new jt;return e.setBounds.apply(e,arguments)},jt.prototype.toString=function(){return JSON.stringify({xmin:this.xmin,xmax:this.xmax,ymin:this.ymin,ymax:this.ymax})},jt.prototype.toArray=function(){return this.hasBounds()?[this.xmin,this.ymin,this.xmax,this.ymax]:[]},jt.prototype.hasBounds=function(){return this.xmin<=this.xmax&&this.ymin<=this.ymax},jt.prototype.sameBounds=jt.prototype.equals=function(e){return e&&this.xmin===e.xmin&&this.xmax===e.xmax&&this.ymin===e.ymin&&this.ymax===e.ymax},jt.prototype.width=function(){return this.xmax-this.xmin||0},jt.prototype.height=function(){return this.ymax-this.ymin||0},jt.prototype.area=function(){return this.width()*this.height()||0},jt.prototype.empty=function(){return this.xmin=this.ymin=this.xmax=this.ymax=void 0,this},jt.prototype.setBounds=function(e,n,r,i){return 1==arguments.length&&(t.isArrayLike(e)?(n=e[1],r=e[2],i=e[3],e=e[0]):(n=e.ymin,r=e.xmax,i=e.ymax,e=e.xmin)),this.xmin=e,this.ymin=n,this.xmax=r,this.ymax=i,(e>r||n>i)&&this.update(),this},jt.prototype.centerX=function(){return.5*(this.xmin+this.xmax)},jt.prototype.centerY=function(){return.5*(this.ymax+this.ymin)},jt.prototype.containsPoint=function(e,t){return e>=this.xmin&&e<=this.xmax&&t<=this.ymax&&t>=this.ymin},jt.prototype.containsBufferedPoint=jt.prototype.containsCircle=function(e,t,n){return e+n>this.xmin&&e-n<this.xmax&&t-n<this.ymax&&t+n>this.ymin},jt.prototype.intersects=function(e){return e.xmin<=this.xmax&&e.xmax>=this.xmin&&e.ymax>=this.ymin&&e.ymin<=this.ymax},jt.prototype.contains=function(e){return e.xmin>=this.xmin&&e.ymax<=this.ymax&&e.xmax<=this.xmax&&e.ymin>=this.ymin},jt.prototype.shift=function(e,t){this.setBounds(this.xmin+e,this.ymin+t,this.xmax+e,this.ymax+t)},jt.prototype.padBounds=function(e,t,n,r){this.xmin-=e,this.ymin-=t,this.xmax+=n,this.ymax+=r},jt.prototype.scale=function(e,t){var n=.5*(this.xmax-this.xmin),r=.5*(this.ymax-this.ymin),i=e-1,a=void 0===t?i:t-1;this.xmin-=n*i,this.ymin-=r*a,this.xmax+=n*i,this.ymax+=r*a},jt.prototype.cloneBounds=jt.prototype.clone=function(){return new jt(this.xmin,this.ymin,this.xmax,this.ymax)},jt.prototype.clearBounds=function(){this.setBounds(new jt)},jt.prototype.mergePoint=function(e,t){void 0===this.xmin?this.setBounds(e,t,e,t):(e<this.xmin?this.xmin=e:e>this.xmax&&(this.xmax=e),t<this.ymin?this.ymin=t:t>this.ymax&&(this.ymax=t))},jt.prototype.fillOut=function(e,t,n){arguments.length<3&&(t=.5,n=.5);var r,i=this.width(),a=this.height(),o=i/a;return isNaN(e)||e<=0||(o<e?(r=a*e-i,this.xmin-=(1-t)*r,this.xmax+=t*r):(r=i/e-a,this.ymin-=(1-n)*r,this.ymax+=n*r)),this},jt.prototype.update=function(){var e;this.xmin>this.xmax&&(e=this.xmin,this.xmin=this.xmax,this.xmax=e),this.ymin>this.ymax&&(e=this.ymin,this.ymin=this.ymax,this.ymax=e)},jt.prototype.transform=function(e){return this.xmin=this.xmin*e.mx+e.bx,this.xmax=this.xmax*e.mx+e.bx,this.ymin=this.ymin*e.my+e.by,this.ymax=this.ymax*e.my+e.by,this.update(),this},jt.prototype.getTransform=function(e,t){var n=new Et;return n.mx=e.width()/this.width()||1,n.bx=e.xmin-n.mx*this.xmin,t?(n.my=-e.height()/this.height()||1,n.by=e.ymax-n.my*this.ymin):(n.my=e.height()/this.height()||1,n.by=e.ymin-n.my*this.ymin),n},jt.prototype.mergeCircle=function(e,t,n){n<0&&(n=-n),this.mergeBounds([e-n,t-n,e+n,t+n])},jt.prototype.mergeBounds=function(e){var t,n,r,i;return e instanceof jt?(t=e.xmin,n=e.ymin,r=e.xmax,i=e.ymax):4==arguments.length?(t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3]):4==e.length?(t=e[0],n=e[1],r=e[2],i=e[3]):lt("Bounds#mergeBounds() invalid argument:",e),void 0===this.xmin?this.setBounds(t,n,r,i):(t<this.xmin&&(this.xmin=t),n<this.ymin&&(this.ymin=n),r>this.xmax&&(this.xmax=r),i>this.ymax&&(this.ymax=i)),this};var Ct=Object.freeze({__proto__:null,countPointsInLayer:function(e){var t=0;return Xr(e)&&Nt(e.shapes,(function(){t++})),t},getPointBounds:Ot,getPointFeatureBounds:Ft,getPointsInLayer:kt,forEachPoint:Nt});function zt(e){return e>=0?e:~e}function Tt(e,t,n,r){var i,a,o,s,u,c,f=0|n,l=isNaN(r)?e.length-f:r+f;for(l>0&&(o=u=e[f],s=c=t[f]),f++;f<l;f++)(i=e[f])<o&&(o=i),i>u&&(u=i),(a=t[f])<s&&(s=a),a>c&&(c=a);return[o,s,u,c]}var Lt=Object.freeze({__proto__:null,absArcId:zt,calcArcBounds:Tt,deleteVertex:function(e,n){for(var r=e.getVertexData(),i=r.nn,a=r.xx.length,o=new Float64Array(r.xx.buffer,0,a-1),s=new Float64Array(r.yy.buffer,0,a-1),u=e.isFlat()?null:new Float64Array(r.zz.buffer,0,a-1),c=e.getRetainedInterval(),f=0,l=!1,d=0;d<i.length;d++)(f+=i[d])>=n&&!l&&(i[d]=i[d]-1,l=!0);t.copyElements(r.xx,0,o,0,n),t.copyElements(r.yy,0,s,0,n),t.copyElements(r.xx,n+1,o,n,a-n-1),t.copyElements(r.yy,n+1,s,n,a-n-1),u&&(t.copyElements(r.zz,0,u,0,n),t.copyElements(r.zz,n+1,u,n,a-n-1)),e.updateVertexData(i,o,s,u),e.setRetainedInterval(c)},insertVertex:function(e,n,r){var i,a,o,s=e.getVertexData(),u=s.nn,c=s.xx.length,f=0,l=!1;s.xx.buffer.byteLength>=8*s.xx.length+8?(i=new Float64Array(s.xx.buffer,0,c+1),a=new Float64Array(s.yy.buffer,0,c+1)):(i=new Float64Array(new ArrayBuffer(8*(c+50)),0,c+1),a=new Float64Array(new ArrayBuffer(8*(c+50)),0,c+1)),e.isFlat()||(o=new Float64Array(new ArrayBuffer(8*(c+1)),0,c+1));for(var d=0;d<u.length;d++)(f+=u[d])>=n&&!l&&(u[d]=u[d]+1,l=!0);t.copyElements(s.xx,0,i,0,n),t.copyElements(s.yy,0,a,0,n),t.copyElements(s.xx,n,i,n+1,c-n),t.copyElements(s.yy,n,a,n+1,c-n),i[n]=r[0],a[n]=r[1],o&&(o[n]=1/0,t.copyElements(s.zz,0,o,0,n),t.copyElements(s.zz,n,o,n+1,c-n)),e.updateVertexData(u,i,a,o)}}),Bt=6378137,Dt=Bt,Rt=Math.PI/180,Ut=180/Math.PI;function qt(e,t,n,r,i,a){var o=e-r,s=t-i,u=n-a;return Math.sqrt(o*o+s*s+u*u)}function Gt(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function Vt(e,t,n,r){var i=e-n,a=t-r;return Math.sqrt(i*i+a*a)}function $t(e,t,n,r,i,a){var o=e-r,s=t-i,u=n-a;return o*o+s*s+u*u}function Jt(e){for(var t=2*Math.PI;e<0;)e+=t;for(;e>=t;)e-=t;return e}function Yt(e,t,n,r){var i=Math.PI/180;e*=i,n*=i,t*=i,r*=i;var a=Math.sin(n-e)*Math.cos(r),o=Math.cos(t)*Math.sin(r)-Math.sin(t)*Math.cos(r)*Math.cos(n-e);return Math.atan2(a,o)}function Wt(e,t,n){var r;e*=Rt,t*=Rt,r=Math.cos(t),n[0]=Math.cos(e)*r*Dt,n[1]=Math.sin(e)*r*Dt,n[2]=Math.sin(t)*Dt}function Ht(e,t,n,r){var i=n-e,a=r-t,o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(t)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function Xt(e,t,n,r){var i=Math.PI/180;return Ht(e*i,t*i,n*i,r*i)*Dt}function Qt(e,t,n,r,i,a){var o=e*r-e*a+n*a-n*t+i*t-i*r;return o*o}function Zt(e,t,n){var r;if(0===n)r=e;else if(e>=t+n)r=t;else if(t>=e+n)r=e;else{var i=e+n-t;r=e-i*i/n*.25}return r<0&&(r=0),r}function Kt(e,t,n,r,i,a){var o=Gt(n,r,i,a),s=((e-n)*(i-n)+(t-r)*(a-r))/o;return 0===o?Gt(e,t,n,r):(s<0&&(s=0),s>1&&(s=1),Gt(e,t,n+s*(i-n),r+s*(a-r)))}var en,tn=Object.freeze({__proto__:null,R:Dt,D2R:Rt,R2D:Ut,degreesToMeters:function(e){return e*Rt*Dt},distance3D:qt,distanceSq:Gt,distance2D:Vt,distanceSq3D:$t,innerAngle2:function(e,t,n,r,i,a){var o=Math.atan2(t-r,e-n),s=Math.atan2(a-r,i-n),u=Math.abs(o-s);return u>Math.PI&&(u=2*Math.PI-u),u},standardAngle:Jt,signedAngle:function(e,t,n,r,i,a){if(e==n&&t==r||n==i&&r==a)return NaN;var o=e-n,s=t-r,u=i-n,c=a-r,f=o*u+s*c,l=o*c-s*u;return Jt(Math.atan2(l,f))},bearing2D:function(e,t,n,r){var i=Math.PI/2-Math.atan2(r-t,n-e);return i>Math.PI?i-2*Math.PI:i},bearing:Yt,signedAngleSph:function(e,t,n,r,i,a){if(e==n&&t==r||n==i&&r==a)return NaN;var o=Yt(n,r,e,t),s=Yt(n,r,i,a);return Jt(2*Math.PI+o-s)},convLngLatToSph:function(e,t,n,r,i){for(var a=[],o=0,s=e.length;o<s;o++)Wt(e[o],t[o],a),n[o]=a[0],r[o]=a[1],i[o]=a[2]},xyzToLngLat:function(e,t,n,r){var i=qt(0,0,0,e,t,n),a=Math.asin(n/i)/Rt,o=Math.atan2(t/i,e/i)/Rt;r[0]=o,r[1]=a},lngLatToXYZ:Wt,sphericalDistance:Ht,greatCircleDistance:Xt,innerAngle:function(e,t,n,r,i,a){var o,s=Vt(e,t,n,r),u=Vt(n,r,i,a);return 0===s||0===u||(o=((e-n)*(i-n)+(t-r)*(a-r))/(s*u))>=1-1e-14?0:o<=1e-14-1?Math.PI:Math.acos(o)},innerAngle3D:function(e,t,n,r,i,a,o,s,u){var c,f=qt(e,t,n,r,i,a),l=qt(r,i,a,o,s,u);return 0===f||0===l||(c=((e-r)*(o-r)+(t-i)*(s-i)+(n-a)*(u-a))/(f*l))>=1?0:c<=-1?Math.PI:Math.acos(c)},triangleArea:function(e,t,n,r,i,a){return Math.abs(((t-a)*(n-i)+(r-a)*(i-e))/2)},cosine:function(e,t,n,r,i,a){var o=Vt(e,t,n,r)*Vt(n,r,i,a),s=0;return o>0&&((s=((e-n)*(i-n)+(t-r)*(a-r))/o)>1?s=1:s<-1&&(s=-1)),s},cosine3D:function(e,t,n,r,i,a,o,s,u){var c=qt(e,t,n,r,i,a)*qt(r,i,a,o,s,u),f=0;return c>0&&((f=((e-r)*(o-r)+(t-i)*(s-i)+(n-a)*(u-a))/c)>1?f=1:f<-1&&(f=-1)),f},triangleArea3D:function(e,t,n,r,i,a,o,s,u){return.5*Math.sqrt(Qt(e,t,r,i,o,s)+Qt(e,n,r,a,o,u)+Qt(t,n,i,a,s,u))},pointSegDistSq:function(e,t,n,r,i,a){return Zt(Gt(e,t,n,r),Gt(e,t,i,a),Gt(n,r,i,a))},pointSegDistSq3D:function(e,t,n,r,i,a,o,s,u){return Zt($t(e,t,n,r,i,a),$t(e,t,n,o,s,u),$t(r,i,a,o,s,u))},pointSegDistSq2:Kt,containsBounds:function(e,t){return e[0]<=t[0]&&e[2]>=t[2]&&e[1]<=t[1]&&e[3]>=t[3]}});function nn(e,t,n,r){var i,a,o,s,u,c,f,l,d,p,h=r.getShapeIter(n),g=1/0;for(h.hasNext()&&(a=c=l=h.x,o=f=d=h.y);h.hasNext();)(p=Kt(e,t,a,o,s=h.x,u=h.y))<g&&(g=p,i=h._ids[h._i],c=a,f=o,l=s,d=u),a=s,o=u;return g==1/0?{distance:1/0}:{segment:[[c,f],[l,d]],distance:Math.sqrt(g),arcId:i}}function rn(e,t,n,r){return(n||[]).reduce((function(n,i){var a=nn(e,t,i,r);return!n||a.distance<n.distance?a:n}),null)||{distance:1/0,arcId:-1,segment:null}}function an(e,t){var n=t.getShapeIter(e);if(!n.hasNext())return null;for(var r=n.x,i=n.y,a=0,o=0,s=0;n.hasNext();)a++,o+=n.x,s+=n.y;return 0!==a&&n.x===r&&n.y===i||(o+=r,s+=i,a++),{x:o/a,y:s/a}}function on(e,t){var n=0;return(e||[]).reduce((function(e,r){var i=t.getSimpleShapeBounds(r).area();return i>n&&(n=i,e=r),e}),null)}en=function(){var e,t;function n(n,r,i,a){e+=t(i[n],a[n],i[r],a[r])}return function(r,i,a){a&&i.isPlanar()&&lt("Expected lat-long coordinates"),t=a?Xt:Vt,e=0;for(var o=0,s=r.length;o<s;o++)i.forEachArcSegment(r[o],n);return e}}();var sn=Object.freeze({__proto__:null,pathIsClosed:function(e,t){var n=e[0],r=e[e.length-1],i=t.getVertex(n,0),a=t.getVertex(r,-1);return i.x===a.x&&i.y===a.y},getPointToPathDistance:function(e,t,n,r){return nn(e,t,n,r).distance},getPointToPathInfo:nn,getPointToShapeDistance:function(e,t,n,r){var i=rn(e,t,n,r);return i?i.distance:1/0},getPointToShapeInfo:rn,getAvgPathXY:an,getMaxPath:on,countVerticesInPath:function(e,t){for(var n=t.getShapeIter(e),r=0;n.hasNext();)r++;return r},getPathBounds:function(e){for(var t=new jt,n=0,r=e.length;n<r;n++)t.mergePoint(e[n][0],e[n][1]);return t},get calcPathLen(){return en}});function un(e,t){var n,r,i,a,o,s,u,c,f=t.getShapeIter(e),l=0,d=0,p=0;if(!f.hasNext())return null;for(i=0,a=0,n=-f.x,r=-f.y;f.hasNext();)o=i,s=a,i=f.x+n,l+=u=o*(a=f.y+r)-s*i,d+=u*(o+i),p+=u*(s+a);return 0==(c=l/2)?an(e,t):{x:d/(6*c)-n,y:p/(6*c)-r}}var cn=Object.freeze({__proto__:null,getShapeCentroid:function(e,t){var n=on(e,t);return n?un(n,t):null},getPathCentroid:un});function fn(e,t,n,r){var i=!1,a=!1;return n&&n.forEach((function(n){var o=ln(e,t,n,r);1==o?i=!i:-1==o&&(a=!0)})),a||i}function ln(e,t,n,r){var i=!1,a=!1;return Xn(n,r,(function(n,r,o,s){var u=dn(e,t,o[n],s[n],o[r],s[r]);1==u?i=!i:isNaN(u)&&(a=!0)})),a?-1:i?1:0}function dn(e,t,n,r,i,a){var o=pn(e,t,n,r,i,a);return o!=o?NaN:o==-1/0?0:1}function pn(e,t,n,r,i,a){var o,s=-1/0;return e<n&&e<i||e>n&&e>i||t>r&&t>a||(e===n||e===i?e===n&&e===i?t!=r&&t!=a&&t>r==t>a||(s=NaN):e===n?t===r?s=NaN:i<n&&t<r&&(s=r):t===a?s=NaN:n<i&&t<a&&(s=a):(o=function(e,t,n,r,i){return n+(e-t)*(i-n)/(r-t)}(e,n,r,i,a),o>t?s=o:o==t&&(s=NaN))),s}function hn(e,t){return(t.isPlanar()?yn:gn)(e,t)}function gn(e,t,n){return mn(t.getShapeIter(e),n)}function mn(e,t){var n,r,i,a,o=0,s=!1,u=Math.PI/180;for(t=t||Bt;e.hasNext();)n=e.x*u,r=Math.sin(e.y*u),s?o+=(n-i)*(2+r+a):s=!0,i=n,a=r;return o/2*t*t}function yn(e,t){var n,r,i,a,o,s,u=t.getShapeIter(e),c=0;if(u.hasNext())for(n=0,r=0,o=-u.x,s=-u.y;u.hasNext();)i=n,a=r,c+=(n=u.x+o)*a-i*(r=u.y+s);return c/2}function vn(e,t){return(t.isPlanar()?bn:xn)(e,t)}function bn(e,t){return en(e,t,!1)}function xn(e,t){return en(e,t,!0)}var _n=Object.freeze({__proto__:null,calcPolsbyPopperCompactness:function(e,t){return t<=0?0:Math.abs(e)*Math.PI*4/(t*t)},calcSchwartzbergCompactness:function(e,t){return t<=0?0:2*Math.PI*Math.sqrt(Math.abs(e)/Math.PI)/t},getPathWinding:function(e,t){var n=hn(e,t);return(n>0?1:n<0&&-1)||0},getShapeArea:function(e,t){return(e||[]).reduce((function(e,n){return e+hn(n,t)}),0)},getPlanarShapeArea:function(e,t){return(e||[]).reduce((function(e,n){return e+yn(n,t)}),0)},getSphericalShapeArea:function(e,t,n){return t.isPlanar()&&lt("[getSphericalShapeArea()] Function requires decimal degree coordinates"),(e||[]).reduce((function(e,r){return e+gn(r,t,n)}),0)},testPointInPolygon:fn,testPointInRing:ln,testRayIntersection:dn,getRayIntersection:pn,getPathArea:hn,getSphericalPathArea:gn,getSphericalPathArea2:mn,getPlanarPathArea2:function(e){for(var t,n,r,i,a,o,s,u=0,c=0,f=e.length;c<f;c++)s=e[c],0===c?(t=0,n=0,a=-s[0],o=-s[1]):u+=(t=s[0]+a)*i-r*(n=s[1]+o),r=t,i=n;return u/2},getPlanarPathArea:yn,getPathPerimeter:vn,getShapePerimeter:function(e,t){return(e||[]).reduce((function(e,n){return e+vn(n,t)}),0)},getSphericalShapePerimeter:function(e,t){return t.isPlanar()&&lt("[getSphericalShapePerimeter()] Function requires decimal degree coordinates"),(e||[]).reduce((function(e,n){return e+xn(n,t)}),0)},getPlanarPathPerimeter:bn,getSphericalPathPerimeter:xn});function wn(e){return 1e-14*Math.max.apply(null,e.map(Math.abs))}function Sn(e,n){var r=Rn(e),i=.0025*r;n>0&&(i=n,ht(t.format("Applying snapping threshold of %s -- %.6f times avg. segment length",n,n/r)));var a=An(e,i);a>0&&e.dedupCoords(),ht(t.format("Snapped %s point%s",a,t.pluralSuffix(a)))}function An(e,t){return t>0==0?0:Mn(Pn(e),e,t)}function In(e,t){return t>0==0?0:Mn(En(e),e,t)}function Mn(e,t,n){var r=0,i=e.length,a=t.getVertexData();jn(a.xx,e,0,i-1);for(var o=0;o<i;o++)r+=s(o,n,e,a.xx,a.yy);return r;function s(e,t,n,r,i){for(var a,o,s,u=e,c=n.length,f=r[n[e]],l=i[n[e]],d=0;++u<c&&!((o=r[a=n[u]]-f)>t);)s=i[a]-l,0===o&&0===s||o*o+s*s>t*t||(r[a]=f,i[a]=l,d++);return d}}function Pn(e){for(var t=e.getVertexData().xx.length,n=new Uint32Array(t),r=0;r<t;r++)n[r]=r;return n}function En(e){var t=0,n=[];return e.getVertexData().nn.forEach((function(e){e>0!=0&&(n.push(t,t+e-1),t+=e)})),n}function jn(e,t,n,r){if(r-n>24){for(var i,a=e[t[n+r>>1]],o=n,s=r;o<=s;){for(;e[t[o]]<a;)o++;for(;e[t[s]]>a;)s--;o<=s&&(i=t[o],t[o]=t[s],t[s]=i,o++,s--)}s>n&&jn(e,t,n,s),o<r&&jn(e,t,o,r)}else!function(e,t,n,r){var i,a,o;for(o=n+1;o<=r;o++){for(i=t[o],a=o-1;a>=n&&e[i]<e[t[a]];a--)t[a+1]=t[a];t[a+1]=i}}(e,t,n,r)}var On=Object.freeze({__proto__:null,getHighPrecisionSnapInterval:wn,snapCoords:Sn,snapCoordsByInterval:An,snapEndpointsByInterval:In,getCoordinateIds:Pn,getEndpointIds:En});function Fn(e,t,n,r,i,a,o,s){if(!(Kt(n,r,i,a,o,s)>t)){var u=Gt(i,a,n,r),c=Gt(o,s,n,r);u<=t||c<=t||e.push(n,r)}}function kn(e,t,n,r,i,a){var o=Vt(n,r,i,a);return o<t&&(t=o,e[0]=i,e[1]=a),t}function Nn(e,t,n){var r;return function(e,t,n){return t<n?e<t||e>n:t>n?e>t||e<n:e!=t}(e,t,n)&&(r=Math.abs(e-t)<Math.abs(e-n)?t:n,Math.abs(e-r)>1e-15&&vt("[clampToCloseRange()] large clamping interval",e,t,n),e=r),e}function Cn(e,t,n,r){return e*r-t*n}function zn(e,t,n,r,i,a){return Cn(e-i,t-a,n-i,r-a)}function Tn(e,t,n,r,i,a,o,s){return zn(e,t,n,r,i,a)*zn(e,t,n,r,o,s)<=0&&zn(i,a,o,s,e,t)*zn(i,a,o,s,n,r)<=0}function Ln(e,t,n,r){var i=e[0],a=e[1],o=t[0],s=t[1],u=o-n[0],c=s-n[1],f=zn(i,a,o,s,r[0]+u,r[1]+c);return f?f<0?1:-1:0}var Bn=Object.freeze({__proto__:null,segmentIntersection:function(e,t,n,r,i,a,o,s,u){var c,f,l=u>=0?u:wn([e,t,n,r,i,a,o,s]),d=l*l;return c=function(e,t,n,r,i,a,o,s,u){var c=[];return Fn(c,e,t,n,a,o,s,u),Fn(c,e,r,i,a,o,s,u),Fn(c,e,a,o,t,n,r,i),Fn(c,e,s,u,t,n,r,i),0===c.length?null:(c.length>4&&vt("Intersection detection error"),c)}(d,e,t,n,r,i,a,o,s),!c&&function(e,t,n,r,i,a,o,s,u){return Gt(t,n,a,o)<=e||Gt(t,n,s,u)<=e||Gt(r,i,a,o)<=e||Gt(r,i,s,u)<=e}(d,e,t,n,r,i,a,o,s)?null:(f=function(e,t,n,r,i,a,o,s,u){if(!Tn(e,t,n,r,i,a,o,s))return null;var c=Cn(n-e,r-t,o-i,s-a),f=zn(i,a,o,s,e,t)/c,l=[e+f*(n-e),t+f*(r-t)];return Math.abs(c)<1e-18?null:(u>0&&function(e,t,n,r,i,a,o,s,u,c){var f=e[0],l=e[1],d=c;d=kn(e,d,f,l,t,n),d=kn(e,d,f,l,r,i),d=kn(e,d,f,l,a,o),d=kn(e,d,f,l,s,u)}(l,e,t,n,r,i,a,o,s,u),function(e,t,n,r,i,a,o,s,u){var c=e[0],f=e[1];c=Nn(c,t,r),c=Nn(c,a,s),f=Nn(f,n,i),f=Nn(f,o,u),e[0]=c,e[1]=f}(l,e,t,n,r,i,a,o,s),l)}(e,t,n,r,i,a,o,s,l),c||f||null)},findClosestPointOnSeg:function(e,t,n,r,i,a){var o=i-n,s=a-r,u=o*o+s*s,c=0===u?-1:((e-n)*o+(t-r)*s)/u;return c<=.1?[n,r]:c>=.9?[i,a]:[n+c*o,r+c*s]},orient2D:zn,segmentHit:Tn,segmentTurn:Ln}),Dn=Object.assign({},tn,_n,sn,Bn,cn);function Rn(e){var t=0,n=e.forEachSegment((function(e,n,r,i){var a=r[e]-r[n],o=i[e]-i[n];t+=Math.sqrt(a*a+o*o)}));return t/n||0}function Un(e){var t=0,n=0,r=e.forEachSegment((function(e,r,i,a){t+=Math.abs(i[e]-i[r]),n+=Math.abs(a[e]-a[r])}));return[t/r||0,n/r||0]}function qn(e,t){var n=new Uint8Array(t.size());return Gn(e,n),function(e){return e<0&&(e=~e),n[e]>0}}function Gn(e,t){Qn(e,null,(function(e){for(var n,r=e.arcs,i=0;i<r.length;i++)(n=r[i])<0&&(n=~n),t[n]++}))}function Vn(e,t){var n=new jt;return Wn(e,(function(e){t.mergeArcBounds(e,n)})),n}function $n(e){e.reverse();for(var t=0,n=e.length;t<n;t++)e[t]=~e[t];return e}function Jn(e,t){return t<=0?e=1/0:t>=1&&(e=0),e}function Yn(e,t,n,r){var i,a,o=0,s=-1;n>r&&(i=n,n=r,r=i);for(var u=n+1;u<r;u++)(a=e[u])<t&&a>o&&(s=u,o=a);return s}function Wn(e,n){for(var r,i=0;i<e.length;i++)if((r=e[i])instanceof Array)Wn(r,n);else if(t.isInteger(r)){var a=n(r);void 0!==a&&(e[i]=a)}else r&&lt("Non-integer arc id in:",e)}function Hn(e,t,n){for(var r=0,i=e?e.length:0;r<i;r++)Xn(e[r],t,n)}function Xn(e,t,n){for(var r=0,i=e.length;r<i;r++)t.forEachArcSegment(e[r],n)}function Qn(e,t,n,r){var i=0;e.forEach((function(e,a){if(e&&0!==e.length){var o,s;r&&r(a);for(var u=0,c=e.length;u<c;u++)if(o=e[u],n&&n({i:u,shapeId:a,shape:e,arcs:o}),t)for(var f=0,l=o.length;f<l;f++,i++)s=o[f],t({i:f,shapeId:a,partId:u,arcId:s,segId:i})}}))}function Zn(e,t){var n,r,i=t.getArcIter(e);if(i.hasNext())for(n=i.x,r=i.y;i.hasNext();)if(i.x!=n||i.y!=r)return!0;return!1}function Kn(e,t){if(!e)return null;var n=[];return e.forEach((function(e){for(var r=[],i=0;i<e.length;i++)Zn(e[i],t)&&r.push(e[i]);r.length>0&&n.push(r)})),n.length>0?n:null}function er(e,t,n){for(var r,i=[],a=0,o=e&&e.length;a<o;a++)r=e[a],i.push({ids:r,area:"polygon"==n?Dn.getPlanarPathArea(r,t):0,bounds:t.getSimpleShapeBounds(r)});return i}var tr=Object.freeze({__proto__:null,getAvgSegment:Rn,getAvgSegment2:Un,getDirectedArcPresenceTest:function(e,t){var n=new Uint8Array(t);return Wn(e,(function(e){var r=zt(e);r<t==0&&lt("index error"),n[r]|=e<0?2:1})),function(e){var t=zt(e);return e<0?2==(2&n[t]):1==(1&n[t])}},getArcPresenceTest:qn,countArcsInShapes:Gn,getPathBounds:Vn,findShapesByArcId:function(e,t,n){var r=n?new Uint8Array(n):[],i=[];return t.forEach((function(e){r[zt(e)]=1})),e.forEach((function(e,t){var n=!1;Wn(e||[],(function(e){n=n||1==r[zt(e)]})),n&&i.push(t)})),i},reversePath:$n,clampIntervalByPct:Jn,findNextRemovableVertex:Yn,forEachArcId:Wn,forEachSegmentInShape:Hn,forEachSegmentInPath:Xn,traversePaths:Qn,filterEmptyArcs:Kn,getPathMetadata:er,quantizeArcs:function(e,t){var n=e.getBounds(),r=new jt(0,0,t-1,t-1),i=n.getTransform(r),a=i.invert();e.transformPoints((function(e,t){var n=i.transform(e,t);return a.transform(Math.round(n[0]),Math.round(n[1]))}))}});function nr(e){return e?e.map((function(e){return e.concat()})):null}function rr(e){return t.isArray(e)?e.map(nr):null}function ir(e,t){or(e,t)}function ar(e,t){for(var n=0,r=e.length;n<r;n++)e[n]=or(e[n],t)}function or(e,n){if(!e)return null;t.isArray(e)||lt("Expected an array, received:",e);for(var r,i=0,a=e.length,o=0;o<a;o++)null===(r=n(e[o],o,e))?(i++,e[o]=null):t.isArray(r)&&(e[o]=r);return i==a?null:i>0?e.filter((function(e){return!!e})):e}function sr(e){for(var t,n=0,r=0,i=e.length;r<i;r++)(t=e[r])&&t.length>n&&(n=t.length);return n}var ur,cr,fr=Object.freeze({__proto__:null,cloneShape:nr,cloneShapes:rr,forEachShapePart:ir,editShapes:ar,editShapeParts:or,findMaxPartCount:sr}),lr=void 0,dr=lr("iconv-lite"),pr=(cr=null,"utf8"!=(ur=xr(ur="utf8"))?null:("undefined"!=typeof TextEncoder&&(cr=new TextEncoder(ur)),function(e){return cr?u.from(cr.encode(e).buffer):t.createBuffer(e,ur)})),hr=function(e){var t=null;return"utf8"!=(e=xr(e))?null:("undefined"!=typeof TextDecoder&&(t=new TextDecoder(e)),function(n){return t?t.decode(n):n.toString(e)})}("utf8");function gr(){return dr.encodingExists("ascii"),Object.keys(dr.encodings)}function mr(e){return Ar(e)||dt("Unknown encoding:",e,"\nRun the -encodings command see a list of supported encodings"),e}function yr(e){for(var t=0,n=e.length;t<n;t++)if(e.charCodeAt(t)>=128)return!1;return!0}function vr(e){return!e||/^utf-?8$/i.test(String(e))}function br(e){return!(e=xr(e))||/^(win|latin|utf8|ascii|iso88|gb)/.test(e)}function xr(e){return(e||"").toLowerCase().replace(/[_-]/g,"")}function _r(e,t,n,r){return n>=0&&(e=e.slice(n,r)),Sr(e,t)}function wr(e,t){return vr(t)?pr(e):dr.encode(e,t)}function Sr(e,t){return vr(t)?hr(e):dr.decode(e,t)}function Ar(e){var t=xr(e);return gr().includes(t)}function Ir(e){return 65279==e.charCodeAt(0)&&(e=e.substr(1)),e}function Mr(){var e=gr().filter((function(e){return!/^(_|cs|internal|ibm|isoir|singlebyte|table|[0-9]|l[0-9]|windows)/.test(e)}));e.sort(),mt("Supported encodings:\n"+St(e))}var Pr=Object.freeze({__proto__:null,getEncodings:gr,validateEncoding:mr,stringsAreAscii:function(e){return yr(e.join(""))},stringIsAscii:yr,encodingIsUtf8:vr,encodingIsAsciiCompat:br,standardizeEncodingName:xr,bufferToString:_r,encodeString:wr,decodeString:Sr,encodingIsSupported:Ar,trimBOM:Ir,printEncodings:Mr});function Er(e){var n,r,i={};if(!e)return null;for(n in e)e.hasOwnProperty(n)&&((r=e[n])==e&&delete(r=t.extend({},r))[n],i[n]=r&&r.constructor===Object?Er(r):r);return i}function jr(e){var n=null;return t.isString(e)?n="string":t.isNumber(e)?n="number":t.isBoolean(e)?n="boolean":t.isDate(e)?n="date":t.isObject(e)&&(n="object"),n}function Or(e){var t=function(e){var t,n,r,i={};for(t=0;t<e.length;t++)for(r=Object.keys(e[t]||{}),n=0;n<r.length;n++)i[r[n]]=1+(0|i[r[n]]);return Object.keys(i).filter((function(t){return i[t]<e.length}))}(e);!function(e,t){var n,r,i,a;for(r=0;r<e.length;r++)for(n=e[r]||(e[r]={}),i=0;i<t.length;i++)(a=t[i])in n==0&&(n[a]=void 0)}(e,t)}function Fr(e,n){return e.indexOf("*")>-1||0===t.difference(n,e).length}function kr(e,t){for(var n,r=null,i=0,a=t.length;i<a&&!(r=(n=t[i])?jr(n[e]):null);i++);return r}function Nr(e,t){e.getFields().forEach((function(n){t(n)&&e.deleteField(n)}))}function Cr(e){return/^\s*$/.test(e)}function zr(e,n,r){var i={};return e.map((function(a){var o,s=0;do{o=r&&"ascii"!=r?Dr(a,n,s,r):Br(a,n,s),s++}while(o in i||a!=o&&t.contains(e,o));return i[o]=!0,o}))}function Tr(e,t){return e.map((function(e){return e?e[t]:void 0}))}function Lr(e,t){var n={},r=[];return e.forEach((function(e){var i=e[t];i in n==0&&(n[i]=!0,r.push(i))})),r}function Br(e,t,n){var r,i;return t=t||256,n?(1==(i=String(n)).length&&(i="_"+i),r=e.substr(0,t-i.length)+i):r=e.substr(0,t),r}function Dr(e,t,n,r){var i=e+(n?String(n):"");return wr(i,r).length>(t||256)?Dr(e=e.substr(0,e.length-1),t,n,r):i}function Rr(e,t){return"ascending"==t&&e.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1})),e}function Ur(e){for(var t=0,n=e?e.length:0;t<n;t++)if(e[t])return e[t];return null}function qr(e,t){var n=Ur(e);return Rr(n?Object.keys(n):[],t)}var Gr=Object.freeze({__proto__:null,copyRecord:Er,getValueType:jr,fixInconsistentFields:Or,fieldListContainsAll:Fr,getColumnType:kr,deleteFields:Nr,isInvalidFieldName:Cr,getUniqFieldNames:zr,getFieldValues:Tr,getUniqFieldValues:Lr,applyFieldOrder:Rr,getFirstNonEmptyRecord:Ur,findFieldNames:qr});function Vr(e){var n;if(t.isArray(e))n=e;else if(n=[],t.isInteger(e))for(var r=0;r<e;r++)n.push({});else e&&lt("Invalid DataTable constructor argument:",e);this.getRecords=function(){return n},this.getReadOnlyRecordAt=function(e){return Er(n[e])}}function $r(e,t,n){for(var r,i,a=Kr(e)||n.length,o=(e.data=e.data||new Vr(a)).getRecords(),s=0,u=o.length;s<u;s++)r=o[s],i=n[s],r||(r=o[s]={}),r[t]=void 0===i?null:i}function Jr(e){var t=e.data;return t||(t=e.data=new Vr(e.shapes?e.shapes.length:0)),t}function Yr(e){return!(!e.data||!Ur(e.data.getRecords()))}function Wr(e){return Hr(e)||Xr(e)}function Hr(e){return("polygon"==e.geometry_type||"polyline"==e.geometry_type)&&Qr(e)}function Xr(e){return"point"==e.geometry_type&&Qr(e)}function Qr(e){return t.some(e.shapes||[],(function(e){return!!e}))}function Zr(e,t){Xr(e)&&Nt(e.shapes,(function(e){var n=t(e[0],e[1]);e[0]=n[0],e[1]=n[1]}))}function Kr(e){var t=0;return e.data?t=e.data.size():e.shapes&&(t=e.shapes.length),t}function ei(e){return 0==Kr(e)}function ti(e,t,n){var r=e.fieldExists?e:e.data;t||dt("Missing a field parameter"),r&&r.fieldExists(t)||dt(n||"Missing a field named:",t)}function ni(e,n){if(n&&n.length){e||dt("Missing attribute data");var r=e.getFields(),i=t.difference(n,r);i.length>0&&dt("Table is missing one or more fields:\n",i,"\nExisting fields:","\n"+St(r))}}function ri(e,n,r){var i;return r&&t.isString(r)?i=r:(i=n+", ",e&&e.geometry_type?i+="received a "+e.geometry_type+" layer":i+="received a layer with no geometry"),i}function ii(e,t){e&&"point"===e.geometry_type||dt(ri(e,"Expected a point layer",t))}function ai(e,t){ii(e),hi(e)>0&&dt(t||"This command requires single points; layer contains multi-point features.")}function oi(e,t){e&&"polyline"===e.geometry_type||dt(ri(e,"Expected a polyline layer",t))}function si(e,t){e&&"polygon"===e.geometry_type||dt(ri(e,"Expected a polygon layer",t))}function ui(e,t){var n=t.info&&t.info.input_files;return n&&n[0]||""}function ci(e,n,r){return t.uniq(r).map((function(t){for(var i,a=[],o=[],s=0,u=0,c=e.length;u<c;u++)r[u]==t&&(t&&o.push(e[u]),i=n[u],a.push(i),i||s++);return{geometry_type:t,shapes:o,data:s<a.length?new Vr(a):null}}))}function fi(e,t){return t&&t.no_replace?{geometry_type:e.geometry_type}:e}function li(e,t,n,r){(r=r||{}).name?e.name=r.name:r.no_replace?e.name=n||void 0:e.name=t&&t.name||n||void 0}function di(e){var t=pi(e);return t.data&&(t.data=t.data.clone()),t}function pi(e){var n=t.extend({},e);return e.shapes&&(n.shapes=rr(e.shapes)),n}function hi(e){for(var t=0,n=0,r=e.length;n<r;n++)e[n]&&e[n].length>1&&t++;return t}function gi(e,t){var n=mi(e,t);return function(e){return n[zt(e)]>0}}function mi(e,t){var n=new Uint32Array(t.size());return e.filter(Hr).forEach((function(e){Gn(e.shapes,n)})),n}function yi(e,t){var n=null;return"point"==e.geometry_type?n=Ot(e.shapes):"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type||(n=Vn(e.shapes,t)),n}function vi(e){e.data=new Vr(Kr(e))}Vr.prototype={fieldExists:function(e){return t.contains(this.getFields(),e)},toString:function(){return JSON.stringify(this)},toJSON:function(){return this.getRecords()},addField:function(e,n){var r=t.isFunction(n);t.isNumber(n)||t.isString(n)||r||lt("DataTable#addField() requires a string, number or function for initialization"),this.fieldExists(e)&&lt("DataTable#addField() tried to add a field that already exists:",e),this.getRecords().forEach((function(t,i){t[e]=r?n(t,i):n}))},getRecordAt:function(e){return this.getRecords()[e]},addIdField:function(){this.addField("FID",(function(e,t){return t}))},deleteField:function(e){this.getRecords().forEach((function(t){delete t[e]}))},getFields:function(){return qr(this.getRecords())},isEmpty:function(){return 0===this.getFields().length||0===this.size()},update:function(e){for(var t=this.getRecords(),n=0,r=t.length;n<r;n++)t[n]=e(t[n],n)},clone:function(){return new Vr(this.getRecords().map(Er))},size:function(){return this.getRecords().length}};var bi=Object.freeze({__proto__:null,insertFieldValues:$r,getLayerDataTable:Jr,layerHasNonNullData:Yr,layerHasGeometry:Wr,layerHasPaths:Hr,layerHasPoints:Xr,layerHasNonNullShapes:Qr,deleteFeatureById:function(e,t){e.shapes&&e.shapes.splice(t,1),e.data&&e.data.getRecords().splice(t,1)},transformPointsInLayer:Zr,getFeatureCount:Kr,layerIsEmpty:ei,requireDataField:ti,requireDataFields:ni,layerTypeMessage:ri,requirePointLayer:ii,requireSinglePointLayer:ai,requirePolylineLayer:oi,requirePolygonLayer:si,requirePathLayer:function(e,t){e&&Hr(e)||dt(ri(e,"Expected a polygon or polyline layer",t))},getLayerSourceFile:ui,divideFeaturesByType:ci,getOutputLayer:fi,setOutputLayerName:li,copyLayer:di,filterPathLayerByArcIds:function(e,n){var r=n.reduce((function(e,t){return e[t]=!0,e}),{}),i=rr(e.shapes);return ar(i,(function(e){for(var t=0;t<e.length;t++)if(zt(e[t])in r)return null;return e})),t.defaults({shapes:i},e)},copyLayerShapes:pi,countMultiPartFeatures:hi,getArcPresenceTest2:gi,countArcsInLayers:mi,getLayerBounds:yi,isolateLayer:function(e,n){return t.defaults({layers:n.layers.filter((function(t){return t==e}))},n)},initDataTable:vi});function xi(){this.a=1,this.c=0,this.tx=0,this.b=0,this.d=1,this.ty=0}xi.prototype.transformXY=function(e,t,n){return(n=n||{}).x=e*this.a+t*this.c+this.tx,n.y=e*this.b+t*this.d+this.ty,n},xi.prototype.translate=function(e,t){this.tx+=e,this.ty+=t},xi.prototype.rotate=function(e,t,n){var r=Math.cos(e),i=Math.sin(e);t=t||0,n=n||0,this.a=r,this.c=-i,this.b=i,this.d=r,this.tx+=t-t*r+n*i,this.ty+=n-t*i-n*r},xi.prototype.scale=function(e,t,n,r){n=n||0,r=r||0,this.a*=e,this.c*=e,this.b*=t,this.d*=t,this.tx-=n*(e-1),this.ty-=r*(t-1)};var _i=lr("mproj");function wi(e,n){var r=s(e),i=r.crs,a=[r],o=function(e){return e.internal.pj_list.mixed||e.pj_add((function(e){e.a=1}),"mixed","Mapshaper Mixed Projection"),e.pj_init("+proj=mixed")}(_i);function s(e){return{bounds:new jt(u(e.bbox)),crs:_i.pj_init(e.proj)}}function u(e){var t=Math.PI/180;return e.map((function(e){return e*t}))}return i.__mixed_crs=o,i.addFrame=function(e){var r,i,o,u=function(e,n){var r=n[e.name];return t.defaults(e,{scale:1,dx:0,dy:0,rotation:0}),r?(Object.keys(r).forEach((function(t){var n=r[t];t in e?e[t]=r[t]:e.proj=function(e,t,n){var r="+"+t+"=";return e.split(" ").map((function(e){return 0===e.indexOf(r)&&(e=e.substr(0,r.length)+n),e})).join(" ")}(e.proj,t,n)})),e):e}(e,n),c=s(u),f=new xi,l=u.origin?(r=u.origin,i=c.crs,[(o=_i.pj_fwd_deg({lam:r[0],phi:r[1]},i)).x,o.y]):[0,0],d=u.placement||[0,0],p=d[0]-l[0]+(+u.dx||0),h=d[1]-l[1]+(+u.dy||0);return u.rotation&&f.rotate(u.rotation*Math.PI/180,l[0],l[1]),u.scale&&f.scale(u.scale,u.scale,l[0],l[1]),f.translate(p,h),c.matrix=f,a.push(c),this},o.fwd=function(e,t){for(var n,r,i=0,o=a.length;i<o;i++)if((n=a[i]).bounds.containsPoint(e.lam,e.phi)){r=_i.pj_fwd(e,n.crs),n.matrix&&n.matrix.transformXY(r.x,r.y,r);break}t.x=r?r.x:1/0,t.y=r?r.y:1/0},i}function Si(e){var t=e.trim().split(/ +/),n=[],r=t.filter((function(e){return!/^\+/.test(e)||(n.push(e.substr(1)),!1)})),i=r[0],a=Ii(n);return 1!=r.length?null:function(e,t){return"albersusa"==e?new Ai(t):null}(i,a)}function Ai(e){var t=e||{},n=new wi({proj:"+proj=aea +lon_0=-96 +lat_0=37.5 +lat_1=29.5 +lat_2=45.5",bbox:[-129,23,-62,52]},t).addFrame({name:"AK",proj:"+proj=aea +lat_1=55 +lat_2=70 +lat_0=65 +lon_0=-148 +x_0=0 +y_0=0",bbox:[-172.26,50.89,-127,73.21],origin:[-152,63],placement:[-1882782,-969242],scale:.37}).addFrame({name:"HI",proj:"+proj=aea +lat_1=19 +lat_2=24 +lat_0=20.9 +lon_0=-156.5 +x_0=0 +y_0=0",bbox:[-160.5,18.72,-154.57,22.58],origin:[-157,21],placement:[-1050326,-1055362]});return t.PR&&n.addFrame({name:"PR",proj:"+proj=aea +lat_1=18 +lat_2=18.43 +lat_0=17.83 +lon_0=-66.43 +x_0=0 +y_0=0",bbox:[-68.092,17.824,-65.151,18.787],origin:[-66.431,18.228],placement:[1993101,-1254517]}),t.VI&&n.addFrame({name:"VI",proj:"+proj=aea +lat_1=18 +lat_2=18.43 +lat_0=17.83 +lon_0=-66.43 +x_0=0 +y_0=0",bbox:[-65.104,17.665,-64.454,18.505],origin:[-66.431,18.228],placement:[1993101,-1254517]}),n}function Ii(e){var n={};return e.forEach((function(e){!function(e,n){var r=e.split("="),i=r[0].split("."),a=i.pop(),o=i.reduce((function(e,n){if(n in e==0)e[n]={};else if(!t.isObject(e[n]))return{};return e[n]}),n);r.length>1?o[a]=function(e){var n;return e.indexOf(",")>0?e.split(",").map(parseFloat):(null===(n=t.parseNumber(e))&&(n=e),n)}(r[1]):a in o!=0||i.length||(o[a]={})}(e,n)})),n}var Mi=Object.freeze({__proto__:null,parseCustomProjection:Si,AlbersUSA:Ai,parseCustomParams:Ii});function Pi(e){return[-180+(e=t.isFiniteNumber(e)?e:1e-10),-90+e,180-e,90-e]}function Ei(e){var t=Pi(-1),n=e instanceof jt?e.toArray():e;return Dn.containsBounds(t,n)}function ji(e){var t=e instanceof jt?e.toArray():e;return(new jt).setBounds(Math.max(t[0],-180),Math.max(t[1],-90),Math.min(t[2],180),Math.min(t[3],90))}function Oi(e){for(var t=e-180;t<=-180;)t+=360;return t}var Fi=Object.freeze({__proto__:null,getWorldBounds:Pi,probablyDecimalDegreeBounds:Ei,clampToWorldBounds:ji,getAntimeridian:Oi}),ki=lr("mproj"),Ni=null,Ci={robinson:"+proj=robin +datum=WGS84",webmercator:"+proj=merc +a=6378137 +b=6378137",wgs84:"+proj=longlat +datum=WGS84",albersusa:Ai};function zi(e,t){if(!Ni)return t();Ni(e,t)}function Ti(e,t){var n=Qi(e);return t=t.__mixed_crs||t,function(r,i){var a;return n&&(r<-180?r=-180:r>180&&(r=180)),a=[r,i],ki.pj_transform_point(e,t,a),a}}function Li(e,t){var n=[0],r=[0],i=e.is_latlong?ki.internal.DEG_TO_RAD:1,a=t.is_latlong?ki.internal.RAD_TO_DEG:1,o=Qi(e);return function(s,u){var c;o&&(s<-180?s=-180:s>180&&(s=180)),n[0]=s*i,r[0]=u*i;try{t=t.__mixed_crs||t,ki.pj_transform(e,t,n,r),c=n[0]==1/0}catch(e){c=!0}return c?null:[n[0]*a,r[0]*a]}}function Bi(e){var t,n;try{(t=Wi(e))&&(n=Di(t))}catch(e){}return n||"[unknown]"}function Di(e){return ki.internal.get_proj_defn(e)}function Ri(e){var t;try{t=ki.internal.wkt_from_proj4(e)}catch(e){}return t}function Ui(e,t){var n=Di(e);return!!n&&n==Di(t)}function qi(e){return e in Ci}function Gi(e){var n;return e=e.replace(/(^| )([\w]+)($| )/,(function(e,t,n,r){return n in ki.internal.pj_list?t+"+proj="+n+r:e})),Vi(e)?n=e:qi(e)?(n=Ci[e],t.isFunction(n)&&(n=n())):n=function(e){return/^(esri|epsg|nad83|nad27):[0-9]+$/i.test(String(e))}(e)?"+init="+e.toLowerCase():e in(a("defs")||{})?a("defs")[e]:Si(e),n||dt("Unknown projection definition:",e),n}function Vi(e){return/^(\+[^ ]+ *)+$/.test(e)}function $i(e){var n,r=Gi(e);if(t.isString(r))try{n=ki.pj_init(r)}catch(e){dt("Unable to use projection",r,"("+e.message+")")}else n=r;return n||null}function Ji(e){Qi(Wi(e))&&dt("Command requires a target with projected coordinates (not lat-long)")}function Yi(e,t){e.info=e.info||{},e.info.crs=t.crs,e.info.prj=t.prj}function Wi(e){var t=e.info||{},n=t.crs;return!n&&t.prj&&(n=$i(ea(t.prj))),!n&&Ei(Ba(e))&&(n=$i("wgs84")),n}function Hi(e){e.reduce((function(e,t){var n=Wi(t);return e&&n&&Qi(e)!=Qi(n)&&dt("Unable to combine projected and unprojected datasets"),n||e}),null)}function Xi(e,t,n){var r=ki.pj_inv_deg({x:e,y:t},n),i=ki.pj_inv_deg({x:e+1,y:t},n);return 1/Dn.greatCircleDistance(r.lam,r.phi,i.lam,i.phi)}function Qi(e){return e&&e.is_latlong||!1}function Zi(e){return Qi(Wi(e))}function Ki(){var e=ki.internal.pj_list,n="Proj4 projections\n";Object.keys(e).sort().forEach((function(r){n+="  "+t.rpad(r,7," ")+"  "+e[r].name+"\n"})),n+="\nAliases",Object.keys(Ci).sort().forEach((function(e){n+="\n  "+e})),mt(n)}function ea(e){var t;try{t=ki.internal.wkt_to_proj4(e)}catch(e){dt("Unusable .prj file ("+e.message+")")}return t}function ta(e){return $i(ea(e))}var na=Object.freeze({__proto__:null,initProjLibrary:zi,setProjectionLoader:function(e){Ni=e},findProjLibs:function(e){var n=e.match(/\b(esri|epsg|nad83|nad27)(?=:[0-9]+\b)/gi)||[];return t.uniq(n.map((function(e){return e.toLowerCase()})))},getProjTransform:Ti,getProjTransform2:Li,toLngLat:function(e,t){return Qi(t)?e.concat():Ti(t,$i("wgs84"))(e[0],e[1])},getProjInfo:Bi,crsToProj4:Di,crsToPrj:Ri,crsAreEqual:Ui,isProjAlias:qi,getProjDefn:Gi,looksLikeProj4String:Vi,getCRS:$i,requireProjectedDataset:Ji,setDatasetCRS:Yi,getDatasetCRS:Wi,requireDatasetsHaveCompatibleCRS:Hi,getScaleFactorAtXY:Xi,isProjectedCRS:function(e){return!Qi(e)},isInvertibleCRS:function(e){return!(!e||!e.inv)},isLatLngCRS:Qi,isWGS84:function(e){return!!Qi(e)&&Di(e).toLowerCase().includes("84")},isWebMercator:function(e){if(!e)return!1;var t=Di(e);return t.includes("+proj=merc")&&t.includes("+a=6378137")&&t.includes("+b=6378137")},isLatLngDataset:Zi,printProjections:Ki,translatePrj:ea,parsePrj:ta});function ra(e){var t=e.length,n=0,r={x:0,y:0,hasNext:function(){return!(n>=t||(r.x=e[n][0],r.y=e[n][1],n++,0))}};return r}function ia(e,t){this._i=0,this._n=0,this._inc=1,this._xx=e,this._yy=t,this.i=0,this.x=0,this.y=0}function aa(e,t,n){var r=0,i=0,a=1,o=0;this.init=function(e,t,n,s){return r=s||0,n?(i=e,a=1,o=e+t):(i=e+t-1,a=-1,o=e-1),this},this.hasNext=function(){var s=n,u=i,c=u,f=r,l=o,d=a;if(u==l)return!1;do{c+=d}while(c!=l&&s[c]<f);return i=c,this.x=e[u],this.y=t[u],this.i=u,!0}}function oa(e){this._arcs=e,this._i=0,this._n=0,this.x=0,this.y=0}ia.prototype.init=function(e,t,n){return n?(this._i=e,this._inc=1):(this._i=e+t-1,this._inc=-1),this._n=t,this},ia.prototype.hasNext=function(){var e=this._i;return this._n>0&&(this._i=e+this._inc,this.x=this._xx[e],this.y=this._yy[e],this.i=e,this._n--,!0)},oa.prototype.hasNext=function(){var e=this._arc;return this._i<this._n!=0&&(e.hasNext()?(this.x=e.x,this.y=e.y,!0):(this.nextArc(),this.hasNext()))},oa.prototype.init=function(e){return this._ids=e,this._n=e.length,this.reset(),this},oa.prototype.nextArc=function(){var e=this._i+1;e<this._n&&(this._arc=this._arcs.getArcIter(this._ids[e]),e>0&&this._arc.hasNext()),this._i=e},oa.prototype.reset=function(){this._i=-1,this.nextArc()};var sa=Object.freeze({__proto__:null,PointIter:ra,ArcIter:ia,FilteredArcIter:aa,MultiShapeIter:function(e){new oa(e)},ShapeIter:oa});function ua(e){var n=e.getPointCount(),r=Math.ceil(n/5e5),i=e.getRemovableThresholds(r);return t.quicksort(i,!0),function(e){var t=i.length,n=ca(e,i.length);return n<1?0:n>t?1/0:i[n-1]}}function ca(e,t){return 0===t||e>=1?0:e<=0?t+1:Math.floor((1-e)*(t+2))}function fa(e,n,r){var i=n.getRemovableThresholds(r),a=ca(e,i.length);return a<1?0:a>i.length?1/0:t.findValueByRank(i,a)}var la=Object.freeze({__proto__:null,getThresholdFunction:ua,getThresholdByPct:fa});function da(){var e,n,r,i,a,o,s,u,c,f=0;function l(e){var t=[],n=[];d(e.map((function(e){for(var r=e?e.length:0,i=0;i<r;i++)t.push(e[i][0]),n.push(e[i][1]);return r})),t,n)}function d(t,o,s){var l=t.length;t instanceof Array&&(t=new Uint32Array(t)),o instanceof Array&&(o=new Float64Array(o)),s instanceof Array&&(s=new Float64Array(s)),e=o,n=s,i=t,a=null,f=0,c=null,r=new Uint32Array(l);for(var d=0,p=0;p<l;p++)r[p]=d,d+=t[p];return d==e.length&&e.length==n.length||lt("ArcCollection#initXYData() Counting error"),h(),u=new ia(e,n),this}function p(t){t?(t.length!=e.length&&lt("ArcCollection#initZData() mismatched arrays"),t instanceof Array&&(t=new Float64Array(t)),c=new aa(e,n,a=t)):(a=null,f=0,c=null)}function h(){var t=g(e,n,i);o=t.bb,s=t.bounds}function g(e,t,n){for(var r,i,a,o=n.length,s=new Float64Array(4*o),u=new jt,c=0,f=0;f<o;f++)(r=n[f])>0&&(i=4*f,a=Tt(e,t,c,r),s[i++]=a[0],s[i++]=a[1],s[i++]=a[2],s[i]=a[3],c+=r,u.mergeBounds(a));return{bb:s,bounds:u}}function m(){var e=a,t=f;if(!e||!t)return this.getPointCount();for(var n=0,r=0,i=e.length;r<i;r++)e[r]>=t&&n++;return n}function y(){for(var t,r=m(),o=i.length,s=new Float64Array(r),u=new Float64Array(r),c=new Float64Array(r),l=new Int32Array(o),d=0,p=0,h=0;h<o;h++){t=0;for(var g=d+i[h];d<g;d++)a[d]>=f&&(s[p]=e[d],u[p]=n[d],c[p]=a[d],p++,t++);1==t&&lt("Collapsed arc"),l[h]=t}return{xx:s,yy:u,zz:c,nn:l}}function v(o){for(var s,u,c=0,f=0,l=t.copyElements,h=0,g=o.length;h<g;h++)s=o[h],u=i[h],s>-1&&(l(e,r[h],e,c,u),l(n,r[h],n,c,u),a&&l(a,r[h],a,c,u),i[s]=u,c+=u,f++);d(i.subarray(0,f),e.subarray(0,c),n.subarray(0,c)),a&&p(a.subarray(0,c))}function b(e,t){var n=new Float64Array(t),r=0;return e.forEach((function(e){for(var t=0,i=e.length;t<i;r++,t++)n[r]=e[t]})),r!=t&&lt("Mismatched thresholds"),n}1==arguments.length?l(arguments[0]):3==arguments.length?d.apply(this,arguments):lt("ArcCollection() Invalid arguments"),this.updateVertexData=function(e,t,n,r){d(e,t,n),p(r||null)},this.getVertexData=function(){return{xx:e,yy:n,zz:a,bb:o,nn:i,ii:r}},this.getCopy=function(){var t=new da(new Int32Array(i),new Float64Array(e),new Float64Array(n));return a&&(t.setThresholds(new Float64Array(a)),t.setRetainedInterval(f)),t},this.getFilteredCopy=function(){if(!a||0===f)return this.getCopy();var e=y(),t=new da(e.nn,e.xx,e.yy);return t.setThresholds(e.zz),t},this.toArray=function(){var e=[];return this.forEach((function(t){for(var n=[];t.hasNext();)n.push([t.x,t.y]);e.push(n)})),e},this.toJSON=function(){return this.toArray()},this.forEachArcSegment=function(t,o){for(var s=t>=0,u=s?t:~t,c=this.getRetainedInterval(),f=i[u],l=s?1:-1,d=s?r[u]:r[u]+f-1,p=d,h=e,g=n,m=a,y=0,v=1;v<f;v++)p+=l,(0===c||m[p]>=c)&&(o(d,p,h,g),d=p,y++);return y},this.forEachSegment=function(e){for(var t=0,n=0,r=this.size();n<r;n++)t+=this.forEachArcSegment(n,e);return t},this.transformPoints=function(t){for(var r,a=e,o=n,s=-1,u=0,c=0,f=a.length;c<f;c++,u--){for(;0===u;)u=i[++s];(r=t(a[c],o[c],s))&&(a[c]=r[0],o[c]=r[1])}h()},this.forEach=function(e){for(var t=0,n=this.size();t<n;t++)e(this.getArcIter(t),t)},this.forEach2=function(t){for(var o=0,s=this.size();o<s;o++)t(r[o],i[o],e,n,a,o)},this.forEach3=function(t){for(var o,s,u,c,f,l=0,d=this.size();l<d;l++)s=(o=r[l])+i[l],u=e.subarray(o,s),c=n.subarray(o,s),a&&(f=a.subarray(o,s)),t(u,c,f,l)},this.filter=function(e){var t=function(t){return e(this.getArcIter(t),t)}.bind(this);return this.deleteArcs(t)},this.deleteArcs=function(e){for(var t=this.size(),n=new Int32Array(t),r=0,a=0;a<t;a++)e(a)?(n[a]=r++,i[a]):n[a]=-1;return r<t&&v(n),n},this.dedupCoords=function(){for(var t,r,o=0,s=0,u=0,c=this.size(),f=a;o<c;)r=pa(s,u,t=i[o],e,n,f),i[o]=r,s+=t,u+=r,o++;return s>u&&(d(i,e.subarray(0,u),n.subarray(0,u)),f&&p(f.subarray(0,u))),s-u},this.getVertex=function(t,r){var i=this.indexOfVertex(t,r);return{x:e[i],y:n[i]}},this.getVertex2=function(t){return[e[t],n[t]]},this.indexOfVertex=function(e,t){var n=e<0?~e:e,a=i[n];return t<0&&(t=a+t),n!=e&&(t=a-t-1),(t<0||t>=a)&&lt("[ArcCollection] out-of-range vertex id"),r[n]+t},this.arcIsClosed=function(t){var r=this.indexOfVertex(t,0),i=this.indexOfVertex(t,-1);return r!=i&&e[r]==e[i]&&n[r]==n[i]},this.arcIsLollipop=function(t){var r,i;return!(this.getArcLength(t)<=2||!this.arcIsClosed(t))&&(r=this.indexOfVertex(t,1),i=this.indexOfVertex(t,-2),e[r]==e[i]&&n[r]==n[i])},this.arcIsDegenerate=function(e){for(var t,n,r=this.getArcIter(e),i=0;r.hasNext();){if(i>0&&(t!=r.x||n!=r.y))return!1;t=r.x,n=r.y,i++}return!0},this.getArcLength=function(e){return i[zt(e)]},this.getArcIter=function(e){var t=e>=0,n=t?e:~e,o=a&&f?c:u;return n>=i.length&&lt("#getArcId() out-of-range arc id:",e),o.init(r[n],i[n],t,f)},this.getShapeIter=function(e){return new oa(this).init(e)},this.setThresholds=function(e){var t=this.getPointCount(),n=null;return e&&(e.length==t?n=e:e.length==this.size()?n=b(e,t):lt("Invalid threshold data")),p(n),this},this.flatten=function(){if(f>0){var e=y();this.updateVertexData(e.nn,e.xx,e.yy),f=0}else a=null},this.isFlat=function(){return!a},this.getRetainedInterval=function(){return f},this.setRetainedInterval=function(e){return f=e,this},this.getRetainedPct=function(){return this.getPctByThreshold(f)},this.setRetainedPct=function(e){return f=e>=1?0:Jn(f=this.getThresholdByPct(e),e),this},this.getRemovableThresholds=function(e){a||lt("[arcs] Missing simplification data.");for(var t,n=1|e,r=new Float64Array(Math.ceil(a.length/n)),i=0,o=0,s=this.getPointCount();i<s;i+=n)(t=a[i])!=1/0&&(r[o++]=t);return r.subarray(0,o)},this.getArcThresholds=function(e){e>=0&&e<this.size()||lt("[arcs] Invalid arc id:",e);var t=r[e],n=t+i[e];return a.subarray(t,n)},this.getPctByThreshold=function(e,n){var r,i,a;return e>0?(r=this.getRemovableThresholds(n),i=t.findRankByValue(r,e),a=r.length>0?1-(i-1)/r.length:1):a=1,a},this.getThresholdByPct=function(e,t){return fa(e,this,t)},this.arcIntersectsBBox=function(e,t){var n=o,r=4*e;return n[r]<=t[2]&&n[r+2]>=t[0]&&n[r+3]>=t[1]&&n[r+1]<=t[3]},this.arcIsContained=function(e,t){var n=o,r=4*e;return n[r]>=t[0]&&n[r+2]<=t[2]&&n[r+1]>=t[1]&&n[r+3]<=t[3]},this.arcIsSmaller=function(e,t){var n=o,r=4*e;return n[r+2]-n[r]<t&&n[r+3]-n[r+1]<t},this.isPlanar=function(){return!Ei(this.getBounds())},this.size=function(){return r&&r.length||0},this.getPointCount=function(){return e&&e.length||0},this.getFilteredPointCount=m,this.getBounds=function(){return s.clone()},this.getSimpleShapeBounds=function(e,t){t=t||new jt;for(var n=0,r=e.length;n<r;n++)this.mergeArcBounds(e[n],t);return t},this.getSimpleShapeBounds2=function(e,t){var n=t||[],r=o,i=4*zt(e[0]);n[0]=r[i],n[1]=r[++i],n[2]=r[++i],n[3]=r[++i];for(var a=1,s=e.length;a<s;a++)r[i=4*zt(e[a])]<n[0]&&(n[0]=r[i]),r[++i]<n[1]&&(n[1]=r[i]),r[++i]>n[2]&&(n[2]=r[i]),r[++i]>n[3]&&(n[3]=r[i]);return n},this.getMultiShapeBounds=function(e,t){if(t=t||new jt,e)for(var n=0,r=e.length;n<r;n++)this.getSimpleShapeBounds(e[n],t);return t},this.mergeArcBounds=function(e,t){e<0&&(e=~e);var n=4*e;t.mergeBounds(o[n],o[n+1],o[n+2],o[n+3])}}function pa(e,t,n,r,i,a){for(var o,s,u,c,f,l=0,d=0;l<n;)o=r[c=e+l],s=i[c],(f=o==o&&s==s&&(0===d||o!=r[c-1]||s!=i[c-1]))&&(r[u=t+d]=o,i[u]=s,d++),a&&d>0&&(f||a[c]>a[u])&&(a[u]=a[c]),l++;return d>1?d:0}function ha(e){var t=new ArrayBuffer(16),n=new Float64Array(t),r=new Uint32Array(t),i=0|e;if(i>0==0)throw new Error("Invalid size param: "+e);return function(e,t){var a,o=r;return n[0]=e,n[1]=t,(2147483647&(a=(a=o[0]^o[1])<<5^a>>7^o[2]^o[3]))%i}}function ga(e){var n=Math.floor(.25*e+1),r=ha(n),i=new Int32Array(n),a=[],o=[],s=0;function u(e,t,n,s,u){for(var c,f,l,d=u(n),p=r(e[n],t[n]),h=i[p];-1!=h;){if(c=o[h][0],f=o[h][1],l=c.length,c[0]===e[s]&&c[l-1]===e[n]&&c[l-2]===e[d]&&f[0]===t[s]&&f[l-1]===t[n]&&f[l-2]===t[d])return h;h=a[h]}return null}t.initializeArray(i,-1),this.addArc=function(e,t){var n=e.length-1,u=r(e[n],t[n]),c=i[u],f=o.length;return i[u]=f,o.push([e,t]),s+=e.length,a.push(c),f},this.findDuplicateArc=function(e,t,n,r,i,a){var o=u(e,t,n,r,i);return null===o?u(e,t,r,n,a):~o},this.getVertexData=function(){for(var e,n,r=new Float64Array(s),i=new Float64Array(s),a=new Uint32Array(o.length),u=0,c=0,f=o.length;c<f;c++)n=(e=o[c])[0].length,t.copyElements(e[0],0,r,u,n),t.copyElements(e[1],0,i,u,n),a[c]=n,u+=n;return{xx:r,yy:i,nn:a}}}function ma(e,t){for(var n,r,i,a,o=function(e,t){var n,r,i,a,o,s=e.length,u=Math.floor(1.3*s)||1,c=ha(u),f=new Int32Array(u),l=new Int32Array(s);for(i=0;i<s;i++)a=e[i],o=t[i],a!=a||o!=o?r=-1:(r=f[n=c(a,o)]-1,f[n]=i+1),l[i]=r>=0?r:i;return l}(e,t),s=e.length-1;s>=0;s--)if(!((r=o[s])>=s)){i=s,a=-1;do{r=o[n=r],t[n]==t[s]&&e[n]==e[s]?(o[n]=i,i=n):(a>-1&&(o[a]=n),a=n)}while(r<n);a>-1&&(o[a]=a),o[s]=i}return o}function ya(e){if(e.arcs){var t=e.arcs.getVertexData(),n=va(t.nn,t.xx,t.yy);e.arcs.updateVertexData(n.nn,n.xx,n.yy),e.layers.forEach((function(e){var t,r;"polyline"!=e.geometry_type&&"polygon"!=e.geometry_type||(e.shapes=(t=e.shapes,r=n.paths,t.map((function(e){return function(e,t){return e?e.map((function(e){return function(e,t){return e.reduce((function(e,n){var r=zt(n),i=t[r];if(i){n<0&&$n(i=i.concat());for(var a=0,o=i.length;a<o;a++)e.push(i[a])}return e}),[])}(e,t)})):null}(e,r)}))))}))}}function va(e,t,n){var r,i,a=t.length,o=ma(t,n),s=function(e,t){for(var n=new Int32Array(e),r=0,i=0,a=t.length;i<a;i++)for(var o=0,s=t[i];o<s;o++,r++)n[r]=i;return n}(a,e),u=new ga(a),c=f()?t.subarray:Array.prototype.slice;return r=function(e){for(var t,n=[],r=0,i=0,a=e.length;i<a;i++)t=e[i],n.push(t<2?null:h(r,r+t-1)),r+=t;return n}(e),(i=u.getVertexData()).paths=r,i;function f(){return!(!t.subarray||!n.subarray)}function l(t){var n=s[t],r=t+1;if(r<a&&s[r]===n)return t+1;var i=e[n];return p(t,t-i+1)?t-i+2:-1}function d(t){var n=s[t],r=t-1;if(r>=0&&s[r]===n)return t-1;var i=e[n];return p(t,t+i-1)?t+i-2:-1}function p(e,r){return t[e]==t[r]&&n[e]==n[r]}function h(r,i){for(var a,c=[],f=-1,p=r;p<i;p++)g(p)&&(f>-1?c.push(y(a,p)):f=p,a=p);return-1==f?c.push(function(r,i){for(var a,c=o[r],f=s[r];c!=r&&!(s[c]<f);)c=o[c];if(c==r)return y(r,i);for(var p=r;p<i;p++)if(null!==(a=u.findDuplicateArc(t,n,p,p,l,d)))return a;lt("Unmatched ring; id:",f,"len:",e[f])}(r,i)):f==r?(g(i)||lt("Topology error"),c.push(y(a,p))):c.push((h=a,v=i,b=r+1,x=f,null===(_=u.findDuplicateArc(t,n,h,x,l,d))&&(_=u.addArc(m(t,h,v,b,x),m(n,h,v,b,x))),_)),c;var h,v,b,x,_}function g(e){var r,i,a,s,u,c,f,p,h,g,m,y,v,b,x=o[e],_=d(e),w=l(e);if(-1==_||-1==w)return!0;for(;e!=x;){if(r=d(x),i=l(x),-1==r||-1==i||(s=w,u=r,c=i,f=void 0,p=void 0,h=void 0,g=void 0,m=void 0,y=void 0,v=void 0,b=void 0,f=t[a=_],p=t[s],h=t[u],g=t[c],m=n[a],y=n[s],v=n[u],b=n[c],!(f==g&&p==h&&m==b&&y==v||f==h&&p==g&&m==v&&y==b)))return!0;x=o[x]}return!1}function m(e,t,n,r,i){var a,o=n-t+i-r+2,s=new(f()?Float64Array:Array)(o),u=0;for(a=t;a<=n;a++)s[u++]=e[a];for(a=r;a<=i;a++)s[u++]=e[a];return s}function y(e,r){var i=u.findDuplicateArc(t,n,e,r,l,d);return null===i&&(i=u.addArc(c.call(t,e,r+1),c.call(n,e,r+1))),i}}var ba=Object.freeze({__proto__:null,buildTopology:ya,buildPathTopology:va});function xa(e,t){var n=Sa([e].concat(t)),r=t.reduce((function(e,t){return e.concat(t.layers)}),[]);return e.arcs=n.arcs,r}function _a(e){return Sa(e.map((function(e){return t.defaults({layers:e.layers.map(pi)},e)})))}function wa(e,t){var n,r=[],i=[],a=0;return e.forEach((function(e){r=r.concat(e.layers),i=i.concat(e.dataset),e.dataset.arcs&&e.dataset.arcs.size()>0&&a++})),n=Sa(i),a>1&&ya(n),i.forEach(t.removeDataset),t.addDataset(n),t.setDefaultTarget(r,n),[{layers:r,dataset:n}]}function Sa(e){var n,r=[],i=0,a=[],o={};return Hi(e),e.forEach((function(e){var n=e.arcs?e.arcs.size():0;n>0&&r.push(e.arcs),function(e,n){var r=n.info||{};e.input_files=t.uniq((e.input_files||[]).concat(r.input_files||[])),e.input_formats=t.uniq((e.input_formats||[]).concat(r.input_formats||[])),t.defaults(e,r)}(o,e),e.layers.forEach((function(e){"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type||Wn(e.shapes,(function(e){return e<0?e-i:e+i})),a.push(e)})),i+=n})),r.length>0&&(n=Aa(r)).size()!=i&&lt("[mergeDatasets()] Arc indexing error"),{info:o,arcs:n,layers:a}}function Aa(e){var n=e.map((function(e){return e.getRetainedInterval()>0&&(yt("Baking-in simplification setting."),e.flatten()),e.getVertexData()})),r=Ia(t.pluck(n,"xx"),Float64Array),i=Ia(t.pluck(n,"yy"),Float64Array);return new da(Ia(t.pluck(n,"nn"),Int32Array),r,i)}function Ia(e,t){var n=function(e){return e.reduce((function(e,t){return e+(t.length||0)}),0)}(e),r=new(t||Array)(n),i=0;return e.forEach((function(e){for(var t=e.length,n=0;n<t;n++)r[n+i]=e[n];i+=t})),r}var Ma=Object.freeze({__proto__:null,mergeDatasetsIntoDataset:xa,mergeDatasetsForExport:_a,mergeCommandTargets:wa,mergeDatasets:Sa,mergeArcs:Aa});function Pa(e,t){var n=new Uint8Array(t.size());function r(e){ir(e,i)}function i(e){a(~e[0]),a(e[e.length-1])}function a(e){var t=zt(e),r=t==e;n[t]|=r?1:2}return e.forEach((function(e){Hr(e)&&e.shapes.forEach(r)})),function(e){var t=zt(e),r=t==e,i=n[t];return r?1==(1&i):2==(2&i)}}var Ea=Object.freeze({__proto__:null,getPathEndpointTest:Pa});function ja(e,n){Array.isArray(e)&&(e=new da(e));var r,i=e.getVertexData(),a=i.nn,o=i.xx,s=i.yy;function u(e){return c(e)?null:[r.xx[e],r.yy[e]]}function c(e){return isNaN(r.xx[e])}function f(e){var t=d(e),n=p(),i=n[t],a=function(e){for(var t=p(),n=e,r=t[e];r!=e;)n=r,(r=t[r])==n&&lt("Node indexing error");return n}(t);r.xx[t]=NaN,r.yy[t]=NaN,n[t]=t,n[a]=i}function l(e){var t=e>>1;return!0&e?t:~t}function d(e){return e>=0?2*e+1:2*~e}function p(){return r||(r=function(e,t){var n=2*e.size(),r=new Float64Array(n),i=new Float64Array(n),a=new Int32Array(n);e.forEach2((function(e,n,o,s,u,c){var f=e,l=e+n-1,d=2*c,p=d+1,h=o[f],g=s[f],m=o[l],y=s[l];t&&!t(c)&&(h=g=m=y=NaN),r[d]=h,i[d]=g,a[d]=c,r[p]=m,i[p]=y,a[p]=c}));var o=ma(r,i);return{xx:r,yy:i,ids:a,chains:o}}(e,n),2*a.length!=r.chains.length&&lt("[NodeCollection] count error")),r.chains}function h(e,t){var n=t>=0?t:~t,r=a[e>=0?e:~e];return!(r<2||r!=a[n]||!(g(e,t,-1)&&g(e,t,1)&&g(e,t,-2)))}function g(t,n,r){var i=e.indexOfVertex(t,r),a=e.indexOfVertex(n,r);return o[i]==o[a]&&s[i]==s[a]}function m(e){var t=d(e),n=p(),r=n[t];return r>=0&&r<n.length||lt("out-of-range chain id"),l(r)}Object.defineProperty(this,"arcs",{value:e}),this.toArray=function(){var e=p(),n=new Uint8Array(e.length),r=[];return t.forEach(e,(function(t,i){var a,o;if(1!=n[i]&&(o=u(i)))for(a={coordinates:o,arcs:[]},r.push(a);1!=n[i];)a.arcs.push(l(i)),n[i]=1,i=e[i]})),r},this.size=function(){return this.toArray().length},this.findDanglingEndpoints=function(){for(var e,t=p(),n=[],r=0,i=t.length;r<i;r++)t[r]==r&&(e=u(r))&&n.push({point:e,arc:l(r)});return n},this.detachAcyclicArcs=function(){for(var e,t,n=p(),r=0,i=0,a=n.length;i<a;i+=2)e=i==n[i],t=i+1==n[i+1],!e&&!t||c(i)||(this.detachArc(l(i)),r++);return r>0&&(r+=this.detachAcyclicArcs()),r},this.detachArc=function(e){f(e),f(~e)},this.forEachConnectedArc=function(e,t){for(var n=m(e),r=0;n!=e;)t(n,r++),n=m(n)},this.getConnectedArcs=function(e,t){var n=[],r=!!t,i=m(e);for(r&&t(e);i!=e;)r&&!t(i)||n.push(i),i=m(i);return n},this.findDuplicateArc=function(e){for(var t=m(e),n=e;t!=e;)h(e,t)&&zt(t)<zt(n)&&(n=t),t=m(t);return n},this.internal={testArcMatch:h,testVertexMatch:g}}function Oa(e){var n=e.arcs,r=e.layers.filter(Hr);if(n&&r.length){var i=Fa(r,n),a=[],o=0,s=new Int32Array(n.size()),u=new Uint8Array(n.size());r.forEach((function(e){e.shapes=e.shapes.map((function(e){return or(e&&e.concat(),c)}))})),e.arcs=function(e,n,r){var i=new Uint32Array(n.length),a=new Float64Array(r),o=new Float64Array(r),s=e.getVertexData(),u=s.zz?new Float64Array(r):null,c=e.getRetainedInterval(),f=0;return n.forEach((function(e,n){e.forEach((function(e,r){!function(e,n){var r=zt(e),c=e<0,l=s.nn[r],d=s.ii[r],p=i[n];l>0&&(p>0&&(l--,c||d++),t.copyElements(s.xx,d,a,f,l,c),t.copyElements(s.yy,d,o,f,l,c),u&&t.copyElements(s.zz,d,u,f,l,c),i[n]+=l,f+=l)}(e,n)}))})),new da(i,a,o).setThresholds(u).setRetainedInterval(c)}(n,a,o)}else e.arcs=null;function c(e){for(var t,r,c,f,l,d,p=0,h=[],g=0,m=e.length;g<m;g++)l=(r=e[g])===(c=zt(r)),n.arcIsDegenerate(r)||(0!==u[c]?t=null:(f=n.getArcLength(r),t&&i(e[g-1],r)?(f>0&&f--,t.push(r),u[c]=1):(t=[r],s[c]=a.length,a.push(t),u[c]=l?2:3),p+=f)),u[c]>1&&(d=s[c],(l&&3==u[c]||!l&&2==u[c])&&(d=~d),h.push(d));return o+=p,h}}function Fa(e,t){var n,r,i=new ja(t,gi(e,t)),a=Pa(e.filter((function(e){return"polyline"==e.geometry_type})),t);return function(e,t){return e==t||e==~t?(yt("Unexpected arc sequence:",e,t),!1):(n=0,i.forEachConnectedArc(e,o),1==n&&r==~t&&!a(e)&&!a(~t))};function o(e,t){n++,r=e}}var ka=Object.freeze({__proto__:null,dissolveArcs:Oa,getArcDissolveTest:Fa});function Na(e){return e.layers.map((function(n){var r={arcs:e.arcs,layers:[n],info:t.extend({},e.info)};return Oa(r),r}))}function Ca(e,n){var r=[];return e.layers=e.layers.filter((function(i){if(!n.includes(i))return!0;var a={arcs:e.arcs,layers:[i],info:t.extend({},e.info)};return Oa(a),r.push(a),!1})),e.layers.length&&(Oa(e),r.push(e)),r}function za(e){var n=t.extend({},e);return n.layers=n.layers.map(di),n.arcs&&(n.arcs=n.arcs.getFilteredCopy()),n}function Ta(e){var n=t.extend({},e);return n.layers=n.layers.map(pi),n.arcs&&(n.arcs=n.arcs.getFilteredCopy()),n}function La(e){return t.defaults({layers:e.layers.map((function(e){return t.extend({},e)}))},e)}function Ba(e){var t=new jt;return e.layers.forEach((function(n){var r=yi(n,e.arcs);r&&t.mergeBounds(r)})),t}function Da(e){return t.some(e.layers,(function(e){return Wr(e)}))}function Ra(e){return t.some(e.layers,(function(e){return Hr(e)}))}function Ua(e){if(e.arcs&&!t.some(e.layers,Hr))return e.arcs=null,!0}function qa(e){Ua(e),e.arcs&&Oa(e)}function Ga(e,n,r){var i=e.layers.concat();t.repeat(Math.max(n.length,r.length),(function(e){var t=n[e],a=r[e],o=t?i.indexOf(t):i.length;t&&i.splice(o,1),a&&i.splice(o,0,a)})),e.layers=i}function Va(e,t,n){Hr($a(e,t,n,{}))&&ya(t)}function $a(e,t,n,r){n&&1==n.layers.length||lt("Invalid source dataset"),!1===t.layers.includes(e)&&lt("Invalid target layer");var i=xa(t,[n])[0];return!i.data&&e.data&&Kr(i)==e.data.size()&&(i.data=r.no_replace?e.data.clone():e.data),r.no_replace||(i=Object.assign(e,{data:null,shapes:null},i),Hr(e)&&Oa(t)),i.name=r.name||i.name,i}function Ja(e,t){e.arcs&&e.arcs.transformPoints(t),e.layers.forEach((function(e){Xr(e)&&Zr(e,t)}))}var Ya=Object.freeze({__proto__:null,splitDataset:Na,splitApartLayers:Ca,copyDataset:za,copyDatasetForExport:Ta,copyDatasetForRenaming:La,getDatasetBounds:Ba,datasetHasGeometry:Da,datasetHasPaths:Ra,cleanupArcs:Ua,pruneArcs:qa,replaceLayers:Ga,replaceLayerContents:Va,mergeOutputLayerIntoDataset:$a,transformPoints:Ja});function Wa(){return"undefined"!=typeof window&&void 0!==window.document}var Ha=Object.freeze({__proto__:null,runningInBrowser:Wa});function Xa(e){var t={filename:"",directory:"",basename:"",extension:""},n=function(e){return-1==e.indexOf("/")&&-1!=e.indexOf("\\")?"\\":"/"}(e),r=e.split(n),i=r.pop(),a=/\.([a-z][a-z0-9]*)$/i,o=a.test(i)?a.exec(i)[0]:"";return o||i.includes("*")?(t.filename=i,t.extension=o?o.slice(1):"",t.basename=i.slice(0,i.length-o.length),t.directory=r.join(n)):t.directory=i?e:r.join(n),t}function Qa(e){return Xa(e).basename}function Za(e){return Xa(e).extension}function Ka(e){var t=Xa(e);return t.extension?e.slice(0,e.length-t.extension.length-1):e}function eo(e,t){return Ka(e)+"."+t}function to(e){return e.reduce((function(e,n,r){return 0===r?Qa(n):t.mergeNames(e,n)}),"")}function no(e){var t=e.info&&e.info.input_files;return t&&to(t)||"output"}var ro=Object.freeze({__proto__:null,parseLocalPath:Xa,getFileBase:Qa,getFileExtension:Za,getPathBase:Ka,replaceFileExtension:eo,getCommonFileBase:to,getOutputFileBase:no}),io={};function ao(e,t,n){return oo(e,t,n=n||function(){})}io.isFile=function(e,t){if(t&&e in t)return!0;if(Wa())return!1;var n=io.statSync(e);return n&&n.isFile()||!1},io.isDirectory=function(e){if(Wa())return!1;var t=io.statSync(e);return t&&t.isDirectory()||!1},io.readFile=function(e,t,n){var r;return n&&e in n?(r=n[e],delete n[e]):"/dev/stdin"==e?r=lr("rw").readFileSync(e):((a("input_files")||[]).push(e),r=lr("fs").readFileSync(e)),t&&u.isBuffer(r)&&(r=Ir(Sr(r,t))),r},io.createDirIfNeeded=function(e){var t=Xa(e).directory;if(t&&!io.isDirectory(t)&&"/dev/stdout"!=e)try{lr("fs").mkdirSync(t,{recursive:!0}),ht("Created output directory:",t)}catch(e){dt("Unable to create output directory:",t)}},io.writeFile=function(e,t,n){var r=lr("rw");io.createDirIfNeeded(e),n?r.writeFile(e,t,n):r.writeFileSync(e,t)},io.convertArrayBuffer=function(e){for(var n=new Uint8Array(e),r=t.createBuffer(n.length),i=0,a=n.length;i<a;i++)r[i]=n[i];return r},io.expandFileName=function(e){var n=Xa(e),r=t.wildcardToRegExp(n.filename),i=n.directory||".",a=[];try{lr("fs").readdirSync(i).forEach((function(e){var t=lr("path").join(i,e);r.test(e)&&io.isFile(t)&&a.push(t)}))}catch(e){}return 0===a.length&&dt("No files matched ("+e+")"),a},io.expandInputFiles=function(e){return e.reduce((function(e,t){return t.indexOf("*")>-1?e=e.concat(io.expandFileName(t)):e.push(t),e}),[])},io.validateOutputDir=function(e){io.isDirectory(e)||Wa()||lt("Output directory not found:",e)},io.checkFileExists=function(e,t){io.isFile(e,t)||"/dev/stdin"==e||dt("File not found ("+e+")")},io.statSync=function(e){var t=null;try{t=lr("fs").statSync(e)}catch(e){}return t};var oo=function(e,n,r){if(e.length>0==0)ht("No files to save");else if(n.dry_run);else{if(n.stdout)return io.writeFile("/dev/stdout",e[0].content,r);var i=so(t.pluck(e,"filename"),n),o=a("input_files");e.forEach((function(e,t){var r=i[t];e.content instanceof ArrayBuffer&&(e.content=io.convertArrayBuffer(e.content)),n.output?n.output.push({filename:r,content:e.content}):(!n.force&&o.indexOf(r)>-1&&dt('Need to use the "-o force" option to overwrite input files.'),io.writeFile(r,e.content),ht("Wrote "+r))}))}r&&r(null)};function so(e,t){var n=t.directory;return n&&(e=e.map((function(e){return lr("path").join(n,e)}))),e}var uo=Object.freeze({__proto__:null,writeFiles:ao,replaceWriteFiles:function(e){oo=e},getOutputPaths:so});function co(e){var t,n;if(!e.length)return function(){return[]};function r(t){return e[t]}return n=lr("flatbush"),t=new n(e.length),e.forEach((function(e){var n=e.bounds;t.add(n.xmin,n.ymin,n.xmax,n.ymax)})),t.finish(),function(e,n,i,a){return t.search(e,n,i,a).map(r)}}function fo(e,t){!function(e,t,n){function r(e,n){var r=t[e];t[e]=t[n],t[n]=r}for(var i=0,a=t.length;i<a;i+=2)e[t[i]]>e[t[i+1]]&&r(i,i+1)}(e,t),po(e,t,0,t.length-2)}function lo(e,t,n,r){for(var i,a,o=n+2;o<=r;o+=2){i=t[o],a=t[o+1];for(var s=o-2;s>=n&&e[i]<e[t[s]];s-=2)t[s+2]=t[s],t[s+3]=t[s+1];t[s+2]=i,t[s+3]=a}}function po(e,t,n,r){for(var i,a,o=n,s=r;o<r;){for(i=e[t[n+r>>2<<1]];o<=s;){for(;e[t[o]]<i;)o+=2;for(;e[t[s]]>i;)s-=2;o<=s&&(a=t[o],t[o]=t[s],t[s]=a,a=t[o+1],t[o+1]=t[s+1],t[s+1]=a,o+=2,s-=2)}if(s-n<40?lo(e,t,n,s):po(e,t,n,s),r-o<40)return void lo(e,t,o,r);n=o,s=r}}function ho(e,t,n){var r,i,a,o,s,u,c=t.getVertexData(),f=t.getMultiShapeBounds(e);function l(e,t,n){var r,u,f,l=s[n],d=0,p=c.xx,h=c.yy;r=n==o?i.length-l:s[n+1]-l;for(var g=0;g<r;g++)u=i[g+l],f=a[g+l],d+=Dn.testRayIntersection(e,t,p[u],h[u],p[f],h[f]);return d}function d(e){var t=Math.floor((e-r)/u);return t<0&&(t=0),t>=o&&(t=o-1),t}!function(){var n,f,l,p,h,g,m,y,v,b,x=c.xx,_=0,w=0,S=-1;for(Hn(e,t,(function(){_++})),f=new Uint32Array(2*_),m=0,Hn(e,t,(function(e,t,n,r){f[m++]=e,f[m++]=t})),fo(x,f),i=new Uint32Array(_),a=new Uint32Array(_),o=function(e){var t=Math.pow(e,.75)/10;return Math.ceil(t)}(_),s=new Uint32Array(o+1),r=x[f[0]],u=(x[f[f.length-2]]-r)/o,l=0,p=_-1;w<_;){for(h=f[y=2*w],g=f[y+1],v=x[h],b=x[g],n=S,S=d(v);S>n;)n++,s[n]=l;b-v>=0==0&&lt("Invalid segment"),d(b)-S>1?(i[p]=h,a[p]=g,p--):(i[l]=h,a[l]=g,l++),w++}s[o]=l,l!=p+1&&lt("Segment indexing error")}(),this.pointInPolygon=function(e,t){if(!f.containsPoint(e,t))return!1;var n=d(e),r=l(e,t,n);return n>0&&(r+=l(e,t,n-1)),r+=l(e,t,o),isNaN(r)?-1:r%2==1?1:0}}function go(e,n){var r=co(function(e,t){var n=[];return e.forEach((function(e,r){for(var i=e?e.length:0,a=0;a<i;a++)n.push({ids:e[a],id:r,bounds:t.getSimpleShapeBounds(e[a])})})),n}(e,n)),i=Vn(e,n).area();function a(e,t){return!!t.bounds.containsPoint(e[0],e[1])&&(!t.index&&t.bounds.area()>.01*i&&(t.index=new ho([t.ids],n)),t.index?t.index.pointInPolygon(e[0],e[1]):Dn.testPointInRing(e[0],e[1],t.ids,n))}function o(e,t){var n=!1,r=!1;return t.forEach((function(t){var i=a(e,t);-1==i?n=!0:1==i&&(r=!r)})),n||r}function s(e){var t,n,r=[];if(e.length>0){e.sort((function(e,t){return e.id-t.id}));for(var i=0;i<e.length;i++)n=e[i],0!==i&&n.id==e[i-1].id||r.push(t=[]),t.push(n)}return r}function u(e,t){var n=t>0?t:0;return e[0],e[1],r(e[0]-n,e[1]-n,e[0]+n,e[1]+n)}function c(e){var t=e[0],r=n.getVertex(t,0),i=n.getVertex(t,1);return[(r.x+i.x)/2,(r.y+i.y)/2]}this.findEnclosingShapes=function(e){var t=[];return s(u(e)).forEach((function(n){o(e,n)&&t.push(n[0].id)})),t},this.findEnclosingShape=function(e){var t=-1;return s(u(e)).forEach((function(n){o(e,n)&&(t=n[0].id)})),t},this.findShapesEnclosingArc=function(e){var t=c([e]);return this.findEnclosingShapes(t)},this.findPointEnclosureCandidates=function(e,n){var r=u(e,n);return t.pluck(r,"id")},this.pointIsEnclosed=function(e){return o(e,u(e))},this.findSmallestEnclosingPolygon=function(e){var t,r=n.getSimpleShapeBounds(e),i=c(e);return u(i).forEach((function(e){!e.bounds.contains(r)||e.bounds.sameBounds(r)||t&&t.bounds.area()<e.bounds.area()||a(i,e)&&(t=e)})),t?t.id:-1},this.arcIsEnclosed=function(e){return this.pointIsEnclosed(c([e]))},this.pathIsEnclosed=function(e){return this.pointIsEnclosed(c(e))},this.findEnclosedPaths=function(e){var t,i=n.getSimpleShapeBounds(e),a=r(i.xmin,i.ymin,i.xmax,i.ymax),o=[];return a.length>6&&(t=new ho([e],n)),a.forEach((function(r){var a=c(r.ids);i.containsPoint(a[0],a[1])&&(t?t.pointInPolygon(a[0],a[1]):Dn.testPointInRing(a[0],a[1],e,n))&&o.push(r.ids)})),o.length>0?o:null},this.findPathsInsideShape=function(e){var t=[];return e.forEach((function(e){var n=this.findEnclosedPaths(e);n&&(t=function(e,t){var n,r=[];for(n=0;n<e.length;n++)-1==t.indexOf(e[n])&&r.push(e[n]);for(n=0;n<t.length;n++)-1==e.indexOf(t[n])&&r.push(t[n]);return r}(t,n))}),this),t.length>0?t:null}}function mo(e,t){e.shapes=e.shapes.map((function(e){return e?function(e,t){var n=er(e,t,"polygon");return n.sort((function(e,t){return Math.abs(t.area)-Math.abs(e.area)})),n.forEach((function(e,r){for(var i,a,o,s=!0,u=r;--u>=0;)if(yo(e,i=n[u],t)){s=!(i.area>0);break}o=s,(a=e).area>0!=o&&(a.area=-a.area,$n(a.ids))})),n.map((function(e){return e.ids}))}(e,t):null}))}function yo(e,t,n){if(!1===t.bounds.contains(e.bounds))return!1;var r=function(e,t){var n=t.getVertex(e,0),r=t.getVertex(e,1);return{x:(n.x+r.x)/2,y:(n.y+r.y)/2}}(e.ids[0],n);return 1==Dn.testPointInRing(r.x,r.y,t.ids,n)}function vo(e,t,n){var r,i=[],a=[],o=n?-1:1;return(e||[]).forEach((function(e){e.area*o>0?a.push([e]):e.area*o<0&&i.push(e)})),0===i.length||(r=co(a.map((function(e,t){return{bounds:e[0].bounds,idx:t}}))),i.forEach((function(e){for(var n,i,s,u,c=-1,f=0,l=e.area*-o,d=e.bounds,p=r(d.xmin,d.ymin,d.xmax,d.ymax),h=0,g=p.length;h<g;h++)i=p[h].idx,s=(n=a[i][0]).area*o,(u=n.bounds.contains(e.bounds)&&s>l)&&p.length>1&&!yo(e,n,t)||u&&(0===f||s<f)&&(f=s,c=i);-1==c?vt("[groupPolygonRings()] polygon hole is missing a containing ring, dropping."):a[c].push(e)}))),a}function bo(e){var t;return e&&0!==e.length?{bounds:(t={points:e,pointCount:e.length,bounds:Dn.getPathBounds(e)}).bounds,pathData:[t],partCount:1,pointCount:t.pointCount}:{partCount:0,pointCount:0}}function xo(e,t,n){if("point"==n)return bo(e);var r=0,i=new jt,a=[];return!e||"polyline"!=n&&"polygon"!=n||e.forEach((function(e,o){var s=function(e){for(var t,n,r,i,a=[],o=0;e.hasNext();)t=e.x,n=e.y,0!==o&&r==t&&i==n||(a.push([t,n]),o++),r=t,i=n;return{points:a,pointCount:a.length}}(t.getShapeIter(e)),u=!0;s.ids=e,"polygon"==n?(s.area=Dn.getPlanarPathArea2(s.points),u=s.pointCount>3&&0!==s.area):"polyline"==n&&(u=s.pointCount>1),u?(r+=s.pointCount,s.bounds=Dn.getPathBounds(s.points),i.mergeBounds(s.bounds),a.push(s)):yt("Skipping a collapsed",n,"path")})),{pointCount:r,pathData:a,pathCount:a.length,bounds:i}}var _o=Object.freeze({__proto__:null,exportPointData:bo,exportPathData:xo});function wo(e){return JSON.stringify(e).replace(/\n/g,"\n").replace(/\r/g,"\r")}function So(e){var n=t.arrayToIndex(e),r=new RegExp('"က⿕̐|က⿕̐"',"g");function i(e,r){if(e in n&&t.isArray(r)){var i=JSON.stringify(r);if(i.indexOf(!1))return"က⿕̐"+i.replace(/,/g,", ")+"က⿕̐"}return r}return function(e){return JSON.stringify(e,i,"  ").replace(r,"")}}var Ao=Object.freeze({__proto__:null,stringifyAsNDJSON:wo,getFormattedStringify:So});function Io(e,t,n){var r=t.getConnectedArcs(e);return n&&(r=r.filter(n)),0===r.length?e:function(e,t,n){var r,i,a,o,s=n.getVertexData(),u=s.xx,c=s.yy,f=n.indexOfVertex(e,-1),l=u[f],d=c[f],p=n.indexOfVertex(e,-2),h=u[p],g=c[p],m=e;for(t.length>0&&(m=t[0],r=n.indexOfVertex(m,-2)),o=1;o<t.length;o++)i=t[o],a=n.indexOfVertex(i,-2),2==Mo(h,g,l,d,u[r],c[r],u[a],c[a])&&(m=i,r=a);return m==e&&lt("Pathfinder error"),m}(e,r,t.arcs)}function Mo(e,t,n,r,i,a,o,s){var u,c=Dn.signedAngle(e,t,n,r,i,a),f=Dn.signedAngle(e,t,n,r,o,s);return c<=0||f<=0?(vt("[chooseRighthandPath()] 0 angle(s):",c,f),c<=0&&vt("  A orient2D:",Dn.orient2D(e,t,n,r,i,a)),f<=0&&vt("  B orient2D:",Dn.orient2D(e,t,n,r,o,s)),u=c>0?1:f>0?2:0):c<f?u=1:f<c?u=2:isNaN(c)||isNaN(f)?lt("Invalid node geometry"):vt("[chooseRighthandPath()] equal angles:",c,"fallback test:",u=Po(i-n,a-r,o-n,s-r)),u}function Po(e,t,n,r){var i=Dn.orient2D(e,t,0,0,n,r);return i>0?2:i<0?1:0}var Eo=Object.freeze({__proto__:null,getRightmostArc:Io,chooseRighthandVector:Po});function jo(e,t,n){return e&~n|t&n}function Oo(e,t,n){var r,i=zt(t);i==t?r=-4:(r=-49,e<<=4),n[i]&=e|r}function Fo(e,t){var n=zt(e),r=t[n];return n!=e&&(r>>=4),7&r}function ko(e,t,n,r,i,a,o){Wn(e,(function(e){var s=e<0,u=s?~e:e,c=n[u],f=s?i:r,l=s?r:i,d=c;t.arcIsLollipop(e)?(vt("lollipop"),d=0):(f&&(d|=3),l&&(d|=48),o>0&&(d|=o),a&&34==(34&d)&&(d&=-18)),n[u]=d}))}function No(e,t,n,r,i,a){Wn(e,(function(e){var t=e<0,o=t?~e:e,s=n[o],u=255;(t?i:r)&&(a&&(u&=-2),u^=2),(t?r:i)&&(a&&(u&=-17),u^=32),n[o]=s&u}))}function Co(e,t,n){var r=null;return n&&(r=function(e){return n(~e)}),function(n){var i,a=[],o=n;do{if(!t(o))return null;if(a.push(o),(o=~Io(i=o,e,r))==~i)return vt("Pathfinder warning: dead-end path"),null}while(o!=n);return 0===a.length?null:a}}function zo(e,t){var n=e.arcs,r=Co(e,(function(e){var n=!1;return 3==Fo(e,t)&&(n=!0,Oo(1,e,t)),n}),(function(e){return 1==(1&Fo(e,t))}));return t=t||new Uint8Array(n.size()),function(e,i){var a,o="dissolve"==i,s="flatten"==i;return e.length>0?(a=[],ko(e,n,t,!0,s,o),ir(e,(function(e){for(var t,n=0,i=e.length;n<i;n++)(t=r(e[n]))&&a.push(t)})),No(e,0,t,!0,s,!0)):a=e,a}}var To=Object.freeze({__proto__:null,setBits:jo,andBits:function(e,t,n){return e&(~n|t)},setRouteBits:Oo,getRouteBits:Fo,openArcRoutes:ko,closeArcRoutes:No,getPathFinder:Co,getRingIntersector:zo});function Lo(e,t){return+e.toPrecision(t)}function Bo(e,t){return+e.toFixed(t)}function Do(e,t){var n=1;if(!e&&0!==e)return e;for(t|=0;t-- >0;)n*=10;return Math.round(e*n)/n}function Ro(e){return Math.round(10*e)/10}function Uo(e){t.isNumber(e)&&0!==e||lt("Rounding increment must be a non-zero number.");var n=1/e;return n>1&&(n=Math.round(n)),function(e){return Math.round(e*n)/n}}function qo(e){for(var t=Math.abs(e[2]-e[0]),n=Math.abs(e[3]-e[1]),r=Math.min(t,n)+1e-8,i=0;r<2e3;)r*=10,i++;return i}function Go(e,t){return e.map((function(e){return e.toFixed(t)})).join(",")}function Vo(e,t){var n=Uo(t);return Ja(e,(function(e,t){return[n(e),n(t)]})),e}var $o=Object.freeze({__proto__:null,roundToSignificantDigits:Lo,roundToDigits:Bo,roundToDigits2:Do,roundToTenths:Ro,getRoundingFunction:Uo,getBoundsPrecisionForDisplay:qo,getRoundedCoordString:Go,getRoundedCoords:function(e,t){return Go(e,t).split(",").map(parseFloat)},roundPoints:function(e,t){Nt(e.shapes,(function(e){e[0]=t(e[0]),e[1]=t(e[1])}))},setCoordinatePrecision:Vo}),Jo={m:"meters",meter:"meters",meters:"meters",mi:"miles",mile:"miles",miles:"miles",km:"kilometers",ft:"feet",feet:"feet"},Yo={meters:1,kilometers:1e3,feet:.3048,miles:1609.344};function Wo(e,t){var n,r=0,i=0;return t&&(t.is_latlong?i=1:t.to_meter>0?i=t.to_meter:lt("Invalid CRS")),e&&((r=Yo[e])||lt("Unknown units:",e)),r&&i?n=r/i:r||i?r&&!i?dt("Unable to convert",e,"to unknown coordinates"):!r&&i&&(n=1/i):n=1,n}function Ho(e){var t=Xo(e);return isNaN(t.value)&&dt("Invalid parameter:",e),t}function Xo(e){var n=t.isString(e)?e:"",r=/(sq|)([a-z]+)(2|)$/i.exec(n),i={};return t.isNumber(e)?i.value=e:""===n?i.value=NaN:r?(i.units=Jo[r[2].toLowerCase()],i.areal=!(!r[1]&&!r[3]),i.value=Number(n.substring(0,n.length-r[0].length)),i.units||isNaN(i.value)||dt("Unknown units: "+r[0])):i.value=Number(n),i}function Qo(e,t){var n=Ho(e),r=Wo(n.units,t);return n.value*r*r}function Zo(e,t){var n=Ho(e),r=Wo(n.units,t);return n.areal&&dt("Expected a distance, received an area:",e),n.value*r}function Ko(e,t){var n=Ho(e),r=Wo(n.units,t);return n.units&&t&&t.is_latlong&&dt("Parameter does not support distance units with latlong datasets"),n.areal&&dt("Expected a distance, received an area:",e),n.value*r}function es(e,t){var n,r;return Array.isArray(e)&&2==e.length||dt("Expected two distance parameters, received",e),n=Ho(e[0]),r=Ho(e[1]),(n.units&&!r.units||r.units&&!n.units)&&dt("Both parameters should have units:",e),[Ko(e[0],t),Ko(e[1],t)]}function ts(e,t,n){var r=e.split(",");return 1==r.length?r=[r[0],r[0],r[0],r[0]]:4!=r.length&&dt("Expected a distance parameter or a list of four params"),r.map((function(r,i){return r.indexOf("%")>0?(parseFloat(r)/100||0)*(1==i||3==i?n.height():n.width()):Ko(e,t)}))}function ns(e,t){var n=t&&t.to_meter?e*t.to_meter*t.to_meter:e,r=n/1e6;return r<.01?Math.round(n)+" sqm":r+" sqkm"}var rs=Object.freeze({__proto__:null,getIntervalConversionFactor:Wo,parseMeasure:Ho,parseMeasure2:Xo,convertAreaParam:Qo,convertDistanceParam:Zo,convertIntervalParam:Ko,convertIntervalPair:es,convertFourSides:ts,getAreaLabel:ns});function is(e,t,n){var r=n.min_gap_area||n.min_area||n.gap_fill_area;if(0==+r)return{filter:function(){return!1},threshold:0};var i,a,o=n.sliver_control>=0?n.sliver_control:0,s=Wi(t),u=r?Qo(r,s):ss(e,t.arcs),c=o>0?as(t.arcs,u,o):function(e,t){var n=t.arcs.isPlanar()?Dn.getPlanarPathArea:Dn.getSphericalPathArea;return function(r){var i=n(r,t.arcs);return Math.abs(i)<e}}(u,t);return{threshold:u,filter:c,label:(i=ns(u,s),a=o>0,a&&(i=i.replace(" ","+ ")+" variable"),i+" threshold")}}function as(e,t,n){n>=0==0&&(n=1),(n>1||t>=0==0)&&lt("Invalid parameter");var r=os(e,n);return function(e){return Math.abs(r(e))<t}}function os(e,t){var n=Math.sqrt(t);return function(t){var r=Dn.getPathArea(t,e),i=Dn.getPathPerimeter(t,e),a=Dn.calcPolsbyPopperCompactness(r,i);return r*(n*a+1-n)}}function ss(e,t){var n=0,r=t.isPlanar()?Dn.distance2D:Dn.greatCircleDistance,i=0,a=0,o=function(e,t,n,o){var s=r(n[e],o[e],n[t],o[t]);a++,i+=(s-i)/a};ar(e.shapes,(function(e){n++,Xn(e,t,o)}));var s=a/n||0,u=Math.pow(s,.75),c=i*i/50*u;return Lo(c,2)}var us=Object.freeze({__proto__:null,getSliverFilter:is,getSliverTest:as,getSliverAreaFunction:os,getDefaultSliverThreshold:ss,calcMaxSliverArea:function(e){var t=e.getBounds().width()/2,n=e.getBounds().height()/2,r=0,i=0;return e.forEachSegment((function(e,a,o,s){var u=Math.abs(o[e]-o[a]),c=Math.abs(s[e]-s[a]);u<t&&c<n&&(i+=(Math.sqrt(u*u+c*c)-i)/++r)})),i*i}}),cs={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},fs=/^rgba?\(([^)]+)\)/,ls=/^#([a-f0-9]{3,8})/i;function ds(e){e=e?String(e):"";var t,n,r=ls.test(e)?e:cs[e.toLowerCase().replace(/[ -]+/g,"")],i=null;return r?i=function(e){var t=ls.exec(e)[1];return 3!=t.length&&4!=t.length||(t=t.split("").map((function(e){return e+e}))),6!=t.length&&8!=t.length?null:{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8==t.length?parseInt(t.substr(7,2),16)/255:1}}(r):fs.test(e)&&(i=function(e){var t=fs.exec(e)[1].split(",").map((function(e){return parseFloat(e)}));return{r:t[0],g:t[1],b:t[2],a:t[3]>=0?t[3]:1}}(e)),!i||(t=i)&&hs(t.r)&&hs(t.g)&&hs(t.b)&&(n=t.a)>=0&&n<=1||(i=null),i}function ps(e){return ds(e)||dt("Unsupported color:",e),!0}function hs(e){return e>=0&&e<256}function gs(e){return e.a<1?function(e){var n,r=ms(e.r)+","+ms(e.g)+","+ms(e.b);return e.a<1?"rgba("+r+","+(n=+(n=e.a)||0,n=Math.round(1e3*n)/1e3,t.clamp(n,0,1)+")"):"rgb("+r+")"}(e):function(e){return"#"+ys(e.r)+ys(e.g)+ys(e.b)}(e)}function ms(e){return Math.round(t.clamp(+e||0,0,255))}function ys(e){return ms(e).toString(16).padStart(2,"0")}function vs(e,t){var n,r,i;if(Array.isArray(e))n=e,r=t;else{n=[],r=[],i=Array.from(arguments);for(var a=0;a<i.length;a+=2)n.push(i[a]),r.push(i[a+1])}if(!(r=bs(r)))return"#eee";var o=n.reduce((function(e,t,n){var i=ps(t)&&ds(t),a=+r[n]||0;return e.r+=i.r*a,e.g+=i.g*a,e.b+=i.b*a,e}),{r:0,g:0,b:0});return gs(o)}function bs(e){var n=t.sum(e);return n>0==0?null:e.map((function(e){return e/n}))}function xs(e){return e.replace(/\\\n/g," ")}function _s(e,n){if(!e||!n||e.length!=n.length-1)return null;for(var r,i,a,o=t.sum(e),s=Math.floor(o/2),u=0,c=1;c<n.length;c++){if(i=n[c-1],a=n[c],s<=(r=u+e[c-1]))return i+(s-u)/(r-u)*(a-i);u=r}return null}function ws(e,t){Object.keys(t).forEach((function(n){var r=t[n],i="function"==typeof r?{get:r}:{value:r,writable:!1};Object.defineProperty(e,n,i)}))}function Ss(e,t,n){if(!e||!n)return null;var r=[],i=[],a=[],o=[];return e.forEach((function(e){for(var s=As(e,t,n,r,i);s<4&&s>0;)r.pop(),i.pop(),s--;s>0&&(o.push([a.length]),a.push(s))})),{shape:o.length>0?o:null,arcs:new da(a,r,i)}}function As(e,t,n,r,i){for(var a,o,s,u,c=t.getShapeIter(e),f=0;c.hasNext();)s=c.x,u=c.y,(0===f||Dn.distance2D(s,u,a,o)>n)&&(r.push(s),i.push(u),a=s,o=u,f++);return s==a&&u==o||(r.push(s),i.push(u),f++),f}var Is=Object.freeze({__proto__:null,simplifyArcsFast:function(e,t){for(var n,r=[],i=[],a=[],o=0,s=e.size();o<s;o++)1==(n=As([o],e,t,r,i))&&(n=0,r.pop(),i.pop()),a.push(n);return new da(a,r,i)},simplifyPolygonFast:Ss});function Ms(e,t){var n,r=e&&Dn.getMaxPath(e,t),i=r&&t.getSimpleShapeBounds(r);return i&&i.hasBounds()&&0!==i.area()&&(n=Ss(e,t,.01*Math.sqrt(i.area()))).shape?function(e,t){var n,r,i,a,o,s,u,c=Dn.getMaxPath(e,t),f=t.getSimpleShapeBounds(c),l=Dn.getPathCentroid(c,t),d=function(e,t){var n=Math.max(t.width(),t.height())/2;return function(t,r){var i=Dn.distance2D(e.x,e.y,t,r);return 1-Math.min(.6*i/n,.25)}}(l,f),p=Dn.getPlanarPathArea(c,t);return 1==e.length&&1.2*p>f.area()?(a=5,i=.2):1==e.length&&1.7*p>f.area()?(a=7,i=.4):(a=11,i=.5),o=(n=f.width()*i)/a,(s=Ps(e,t,r=l.x-n/2,r+n,a,d))?(u=Ps(e,t,s.x-o/2,s.x+o/2,2,d)).distance>s.distance&&(s=u):(yt("[points inner] failed, falling back to centroid"),s=l),s}(n.shape,n.arcs):null}function Ps(e,n,r,i,a,o){var s,u,c,f=function(e,t,n){for(var r=(t-e)/(n+1),i=[],a=1;a<=n;a++)i.push(e+r*a);return i}(r,i,a),l=(i-r)/a,d=function(e,n,r){var i=n.getBounds().ymin-1;return r.reduce((function(r,a){var o=function(e,n,r,i){var a,o,s,u=function(e,t,n,r){return n?n.reduce((function(n,i){var a=function(e,t,n,r){var i=[];return Xn(n,r,(function(n,r,a,o){var s=Dn.getRayIntersection(e,t,a[n],o[n],a[r],o[r]);s>-1/0&&i.push(s)})),i.length%2==1&&(i=[]),i}(e,t,i,r);return n.concat(a)}),[]):[]}(e,n,r,i),c=[];t.genericSort(u);for(var f=0;f<u.length;f+=2)a=u[f],(s=((o=u[f+1])-a)/2)>0&&c.push({y:(a+o)/2,x:e,interval:s});return c}(a,i,e,n);return r.concat(o)}),[])}(e,n,f);d.forEach((function(e){e.interval*=o(e.x,e.y)})),d.sort((function(e,t){return t.interval-e.interval}));for(var p=0;p<d.length&&(c=d[p],!(s&&s.distance>c.interval));p++)u=Es(c.x,c.y,e,n,l,o),(!s||u.distance>s.distance)&&(s=u);return s}function Es(e,t,n,r,i,a){var o={x:e,y:t,distance:Dn.getPointToShapeDistance(e,t,n,r)*a(e,t)};return js(o,n,r,i,a),js(o,n,r,-i,a),o}function js(e,t,n,r,i){for(var a,o=e.x,s=e.y,u=e.distance;s+=r,(a=Dn.getPointToShapeDistance(o,s,t,n)*i(o,s))>.9*u&&Dn.testPointInPolygon(o,s,t,n);)a>u&&(e.distance=u=a,e.y=s)}var Os=Object.freeze({__proto__:null,findAnchorPoint:Ms});function Fs(e,t){var n=new Uint8Array(e.size());Wn(t,(function(e){e<0?n[~e]|=2:n[e]|=1})),this.isInnerArc=function(e){var t=zt(e);return 3==n[t]}}function ks(e){return e.reduce((function(e,t){return t.layers.forEach((function(n){e.push({layer:n,dataset:t.dataset})})),e}),[])}function Ns(e,t,n){var r=zs(e,t,!0);return n&&(r=r.filter((function(e){return e.layer.geometry_type==n}))),e.forEach((function(e){e.layer.target_id=-1})),r.forEach((function(e,t){e.layer.target_id=t})),Cs(r)}function Cs(e){var t=[],n=[];return e.forEach((function(e){var r=t.indexOf(e.dataset);-1==r?(t.push(e.dataset),n.push({layers:[e.layer],dataset:e.dataset})):n[r].layers.push(e.layer)})),n}function zs(e,n,r){var i=[],a=[],o={};return n.split(",").forEach((function(t,n){var r=Ts(t),s=!1;e.forEach((function(e,t){t in o?s=!0:r(e.layer,t+1)&&(i.push(e),o[t]=!0,s=!0)})),0==s&&a.push(t)})),r&&a.length&&dt(t.format("Missing layer%s: %s",1==a.length?"":"s",a.join(","))),i}function Ts(e){var n=t.isInteger(Number(e)),r=n?null:t.wildcardToRegExp(e);return function(t,i){return n?String(i)==e:r.test(t.name||"")}}function Ls(e){return e.reduce((function(e,t){return e+t.layers.length}),0)}var Bs=Object.freeze({__proto__:null,expandCommandTargets:ks,findCommandTargets:Ns,groupLayersByDataset:Cs,findMatchingLayers:zs,getLayerMatch:Ts,countTargetLayers:Ls,getLayerTargetId:function(e,t){var n,r=0;return t.name,e.getLayers().forEach((function(e,i){t.name&&e.layer.name==t.name&&r++,t==e.layer&&(n=String(i+1))})),n||lt("Layer not found"),1==r?t.name:n}});function Ds(e,t){var n={},r=e.data?e.data.getRecords():null;return ws(n,{name:e.name,data:r,type:e.geometry_type,size:Kr(e),empty:0===Kr(e),bbox:Us(0,e,t)}),n.field_exists=function(t){return!(!e.data||!e.data.fieldExists(t))},n.field_type=function(t){return e.data&&kr(t,e.data.getRecords())||null},n.field_includes=function(t,n){return!!e.data&&e.data.getRecords().some((function(e){return e&&e[t]===n}))},n}function Rs(e,t,n){var r;return ws(e,{layer_name:t.name||"",layer:function(){return r||(r=Ds(t,n)),r}}),e}function Us(e,t,n){var r;return function(){return r||(r=function(e,t){var n=yi(e,t);if(!n)return null;var r=n.toArray();return Object.assign(r,{cx:n.centerX(),cy:n.centerY(),height:n.height(),width:n.width(),left:n.xmin,bottom:n.ymin,top:n.ymax,right:n.xmax}),r}(t,n)),r}}function qs(e,n,r){var i,a,o,s,u,c,f,l=r||{},d=Xr(e),p=n&&Hr(e),h=e.data?e.data.getRecords():null,g=p&&n.isPlanar(),m={};function y(){var t=e.shapes[f];u||(u=t&&t[0]||null)}function v(){return o=o||Dn.getShapeCentroid(c,n)}function b(){return s=s||Ms(c,n)}function x(){return a||(a=n.getMultiShapeBounds(c)),a}return ws(m,{id:function(){return f}}),Rs(m,e,n),l.geojson_editor&&Object.defineProperty(m,"geojson",{set:function(e){l.geojson_editor.set(e,f)},get:function(){return l.geojson_editor.get(f)}}),h&&Object.defineProperty(m,"properties",{set:function(e){t.isObject(e)?h[f]=e:dt("Can't assign non-object to $.properties")},get:function(){var e=h[f];return e||(e=h[f]={}),e}}),p?(ws(m,{partCount:function(){return c?c.length:0},isNull:function(){return 0===m.partCount},bounds:function(){return x().toArray()},height:function(){return x().height()},width:function(){return x().width()}}),"polyline"==e.geometry_type&&ws(m,{length:function(){return Dn.getShapePerimeter(c,n)}}),"polygon"==e.geometry_type&&ws(m,{area:function(){return g?m.planarArea:Dn.getSphericalShapeArea(c,n)},perimeter:function(){return Dn.getShapePerimeter(c,n)},compactness:function(){return Dn.calcPolsbyPopperCompactness(m.area,m.perimeter)},planarArea:function(){return Dn.getPlanarShapeArea(c,n)},innerPct:function(){return i||(i=function(e,t){var n,r,i,a=e.isPlanar()?Dn.distance2D:Dn.greatCircleDistance,o=new Fs(e,t);return function(e){return n=0,r=0,e&&e.forEach(s),r>0?r/(r+n):0};function s(e){e.forEach(u)}function u(t){i=0,e.forEachArcSegment(t,c),o.isInnerArc(t)?r+=i:n+=i}function c(e,t,n,r){i+=a(n[e],r[e],n[t],r[t])}}(n,e.shapes)),i(c)},originalArea:function(){var e,t=n.getRetainedInterval();return n.setRetainedInterval(0),e=m.area,n.setRetainedInterval(t),e},centroidX:function(){var e=v();return e?e.x:null},centroidY:function(){var e=v();return e?e.y:null},innerX:function(){var e=b();return e?e.x:null},innerY:function(){var e=b();return e?e.y:null}})):d&&(Object.defineProperty(m,"coordinates",{set:function(n){!n||t.isArray(n)?e.shapes[f]=n||null:dt("Can't assign non-array to $.coordinates")},get:function(){return e.shapes[f]||null}}),Object.defineProperty(m,"x",{get:function(){return y(),u?u[0]:null},set:function(e){y(),u&&(u[0]=Number(e))}}),Object.defineProperty(m,"y",{get:function(){return y(),u?u[1]:null},set:function(e){y(),u&&(u[1]=Number(e))}})),function(t){return f=t,p&&(a=null,o=null,s=null,c=e.shapes[t]),d&&(u=null),m}}function Gs(e,t,n,r){return(r=r||{}).returns=!0,Js(e,t,n,r)}function Vs(e,t,n){var r=$s(e,t,n);return function(e,t){var n=r(e,t);return!0!==n&&!1!==n&&dt("where expression must return true or false"),n}}function $s(e,t,n){var r,i=xs(e),a=Xs({}),o=f(t,n),s=f(t,n),u=Ys(i),c="with($$env){with($$record){return "+i+"}}";try{r=new Function("$$record,$$env",c)}catch(e){console.error(e),dt(e.name,"in expression ["+i+"]")}function f(e,t){var n=e.data?e.data.getRecords():[],r=qs(e,t);function i(){}return function(e){var t;return-1==e?null:(i.prototype=n[e]||{},(t=new i).$=r(e),t)}}return Hs(u,a),function(e,t,n){var c;a.A=o(e),a.B=s(t),n&&Hs(u,n);try{c=r.call(a,n||{},a)}catch(e){dt(e.name,"in expression ["+i+"]:",e.message)}return c}}function Js(e,n,r,i){var a,o,s=t.extend({},i),u=xs(e||""),c=!s.no_assign,f=Ys(u);return c&&f.length>0&&!n.data&&vi(n),c||(s.context=s.context||{},Hs(f,s.context)),o=n.data?n.data.getRecords():[],a=function(e,t,n,r){var i=qs(t,n,r),a=Rs({},t,n),o=Xs(t,r.context,r),s=Ws(e,r);return function(t,n){var r;o.$=n>=0?i(n):a,o._=o,o.d=t||null;try{r=s.call(o.$,t,o)}catch(t){dt(t.name,"in expression ["+e+"]:",t.message)}return r}}(u,n,r,s),function(e,t){var n;return n=t||o[e]||(o[e]={}),c&&Hs(f,n),a(n,e)}}function Ys(e,n){var r=e.match(/[a-z_$][.a-z0-9_$]*(?= *=[^>=])/gi)||[];return t.uniq(r.filter((function(e){var t=e.indexOf(".");return n?t>-1:-1==t})))}function Ws(e,t){var n,r;n="with($$env){with($$record){ "+(n=t.returns?"var $$retn = "+e+"; return $$retn;":e)+"}}";try{r=new Function("$$record,$$env",n)}catch(t){dt(t.name,"in expression ["+e+"]")}return r}function Hs(e,t){for(var n=0;n<e.length;n++)e[n]in t==0&&(t[e[n]]=null)}function Xs(e,n,r){var i=a("defs"),o=Qs(),s={},u=e.data?e.data.getFields():[];return r=r||{},function(e){Object.assign(e,{round:Do,int_median:_s,sprintf:t.format,blend:vs})}(o),u.length>0&&Hs(u,o),n=t.defaults(n||{},i),o.global=i,Object.keys(n).forEach((function(e){var t=Object.getOwnPropertyDescriptor(n,e);t.get?Object.defineProperty(s,e,{get:t.get}):Object.defineProperty(s,e,{value:n[e]})})),Object.keys(o).reduce((function(e,t){return t in e?r.no_warn||("function"==typeof e[t]&&u.indexOf(t)>-1?ht("Warning: "+t+"() function is hiding a data field with the same name"):ht('Warning: "'+t+'" has multiple definitions')):Object.defineProperty(e,t,{value:o[t]}),e}),s)}function Qs(){var e={globalThis:void 0};return function(){for(var t in this)e[t]=void 0}(),e.console=console,e}var Zs=Object.freeze({__proto__:null,compileValueExpression:Gs,compileFeaturePairFilterExpression:Vs,compileFeaturePairExpression:$s,compileFeatureExpression:Js,getAssignedVars:Ys,getAssignmentObjects:function(e){var n=Ys(e,!0),r=[];return n.forEach((function(e){var t=/^([^.]+)\.[^.]+$/.exec(e),n=t?t[1]:null;n&&"this"!=n&&r.push(n)})),t.uniq(r)},compileExpressionToFunction:Ws,getBaseContext:Qs});function Ks(e){return eu(e).modes[0]}function eu(e,t){var n=function(e){var t,n,r=[],i={},a=[];for(t=0;t<e.length;t++)(n=e[t])in i==0?(i[n]=r.length,r.push(n),a.push(1)):a[i[n]]++;return{values:r,counts:a}}(e),r=function(e){var t,n,r=e.counts,i=e.values,a=r.length>0?function(e){var t,n=-1/0;for(t=0;t<e.length;t++)e[t]>n&&(n=e[t]);return n}(r):0,o=0,s=[];for(t=0;t<r.length;t++)(n=r[t])===a?s.push(i[t]):n>o&&(o=n);return{modes:s,margin:s.length>1?0:a-o,count:a}}(n);return t&&(r.counts=n.counts,r.values=n.values),r}var tu=Object.freeze({__proto__:null,getMode:Ks,getModeData:eu}),nu={};function ru(e,n,r){var i=t.extend({},e),a={expression:r.where,invert:!!r.invert,verbose:!1,no_replace:r.no_replace};return nu.filterFeatures(i,n,a)}function iu(e,t,n){return au(e,t,n)()}function au(e,n,r){var i,a,o,s=0,u=0,c=[],f={count:y,sum:m,sums:v,average:m,mean:m,median:m,quantile:m,iqr:m,quartile1:m,quartile2:m,quartile3:m,min:m,max:m,mode:v,collect:v,first:function(e){return 0===s&&(c[u]=e),u++,e},every:function(e){e=!!e,c[u]=(0===s||c[u])&&e,u++},some:function(e){e=!!e,c[u]=c[u]||e,u++},last:y},l={count:h((function(){return s}),0),sum:h(t.sum,0),sums:h((function(e){var n=e&&e.length?e[0].length:0,r=t.initializeArray(Array(n),0);return e.forEach((function(e){if(e&&e.length)for(var t=0;t<n;t++)r[t]+=+e[t]||0})),r})),median:h(t.findMedian),quantile:(o=t.findQuantile,function(e,t){var n=u++;return s>0?o(c[n],t):null}),iqr:h((function(e){return t.findQuantile(e,.75)-t.findQuantile(e,.25)})),quartile1:h((function(e){return t.findQuantile(e,.25)})),quartile2:h(t.findMedian),quartile3:h((function(e){return t.findQuantile(e,.75)})),min:h((function(e){return t.getArrayBounds(e).min})),max:h((function(e){return t.getArrayBounds(e).max})),average:h(t.mean),mean:h(t.mean),mode:h(Ks),collect:h(p),first:h(p),every:h(p,!1),some:h(p,!1),last:h(p)},d=Kr(e);return e.geometry_type&&(f.width=f.height=function(){},l.width=function(){return yi(e,n).width()},l.height=function(){return yi(e,n).height()}),i=Js(r,e,n,{context:f,no_assign:!0,no_warn:!0}),a=Js(r,e,n,{returns:!0,context:l,no_warn:!0}),function(e,t){var n;return e?function(e){e.forEach(g)}(e):function(){for(var e=0;e<d;e++)g(e)}(),n=a(void 0,t),s=0,u=0,c=[],n};function p(e){return e}function h(e,t){var n=arguments.length>1?t:null;return function(){var t=u++;return s>0?e(c[t]):n}}function g(e){(e<0||e>=d)&&lt("Invalid record index"),i(e),s++,u=0}function m(e){return isNaN(e)&&e&&dt("Expected a number, received:",e),v(e)}function y(e){return c[u++]=e,e}function v(e){var t;return 0===s&&(c[u]=[]),(t=c[u]).length!=s&&dt("Evaluation failed"),t.push(e),u++,e}}nu.calc=function(e,t,n){var r,i,o=n.expression;return n.where&&(e=ru(e,t,n),o+=" where "+n.where),i=a("defs"),ht(o+":  "+(r=au(e,t,n.expression)(null,i))),r};var ou=Object.freeze({__proto__:null,evalCalcExpression:iu,compileCalcExpression:au});function su(e,t){var n=au({data:e},null,t);return function(e,t){e||(e=[]),n(e,t)}}var uu=Object.freeze({__proto__:null,getJoinCalc:su});function cu(e,t){if(!e||0===e.length)return function(){return 0};e.forEach((function(e){ti(t,e)}));var n={},r=0,i=t.getRecords(),a=fu(e);return function(e){var t=a(i[e]);return t in n==0&&(n[t]=r++),n[t]}}function fu(e){return e.reduce((function(e,t){var n=function(e){return String(e[t])};return e?function(t){return e(t)+"~~"+n(t)}:n}),null)}function lu(e,t,n){return pu(e,function(e,t){for(var n,r=[],i=0;i<t;i++)(n=e(i))in r?r[n].push(i):r[n]=[i];return r}(t,e.length),n)}function du(e,t,n,r){for(var i=[],a=0;a<n;a++)i.push(t(a));return pu(e,i,r)}function pu(e,t,n){var r,i=n.sum_fields||[],a=n.copy_fields||[];function o(t,n){for(var r,i=0,a=0;a<n.length;a++)i+=(r=e[n[a]])&&r[t]||0;return i}return n.fields&&(a=a.concat(n.fields)),n.calc&&(r=su(new Vr(e),n.calc)),t.map((function(t){var n,s,u={};for(s=e[(t=t||[])[0]],n=0;n<i.length;n++)u[i[n]]=o(i[n],t);for(n=0;n<a.length;n++)u[a[n]]=s?s[a[n]]:null;return r&&r(t,u),u}))}var hu=Object.freeze({__proto__:null,getCategoryClassifier:cu,getMultiFieldKeyFunction:fu,aggregateDataRecords:lu,recombineDataRecords:du});function gu(e,t,n,r){var i=[];return e.forEach((function(e){for(var a,o=[],s=e;n(s)&&(o.push(s),a=n(s)?t.getConnectedArcs(s,n):[],r(s),a.length>0);)s=~a[0];o.length>0&&i.push(o)})),i}function mu(e,n){var r=function(e,n){var r=[],i=[],a=[],o=e.map((function(e,t){return n(t)}));return Qn(e,(function(e){var t=e.arcId,n=t<0?~t:t,o=a.length,s=r[n];s||(s=[],r[n]=s),s.push(o),e.group=s,a.push(e),3==s.length&&i.push(s)})),i.forEach((function e(n){var r=s(n,f)||s(n,l)||s(n,d);r&&(p(n=n.filter((function(e){return!t.contains(r,e)}))),p(r),n.length>2&&e(n))})),a;function s(e,t){for(var n,r,i=0;i<e.length-1;i++){n=a[e[i]];for(var o=i+1;o<e.length;o++)if(t(n,r=a[e[o]]))return[n.segId,r.segId]}return null}function u(t,n){return yu(t,a,e).arcId===~yu(n,a,e).arcId}function c(t,n){return vu(t,a,e).arcId===~vu(n,a,e).arcId}function f(e,t){return d(e,t)&&u(e,t)&&c(e,t)}function l(e,t){return d(e,t)&&(u(e,t)||c(e,t))}function d(e,t){return e.arcId===~t.arcId&&o[e.shapeId]===o[t.shapeId]}function p(e){e.forEach((function(t){a[t].group=e}))}}(e,n);return function(e,n,r){var i=[];return e.forEach((function(e){e.used||o(e)||function(e){var t=[e.arcId],n=a(e);for(e.used=!0;n&&n!=e;)t.push(n.arcId),n.used=!0,(n=a(n))&&n!=e&&n.used&&lt("buildRing() topology error");n||lt("buildRing() traversal error"),e.used=!0,o=t,s=r(e.shapeId),s in i==0&&(i[s]=[]),i[s].push(o);var o,s}(e)})),i;function a(t,r){var i,s=yu(t,e,n);return r=r||0,s!=t&&(i=o(s))&&(r>100&&lt("deep recursion -- unhandled topology problem"),s=1==n[i.shapeId][i.partId].length?a(s,r+1):a(i,r+1)),s}function o(n){var i,a=r(n.shapeId);return null===(i=t.find(n.group,(function(t){var i=n,o=e[t];return i!=o&&!o.used&&r(o.shapeId)===a&&i.arcId==~o.arcId})))?null:e[i]}}(r,e,n)}function yu(e,t,n){return bu(e,t,n,1)}function vu(e,t,n){return bu(e,t,n,-1)}function bu(e,t,n,r){var i,a=n[e.shapeId][e.partId].length,o=(e.i+r)%a;return o<0&&(o+=a),(i=t[e.segId-e.i+o])&&i.shapeId==e.shapeId||lt("index error"),i}var xu=Object.freeze({__proto__:null,dissolvePolygonGeometry:mu});function _u(e,n,r,i){var a,o,s,u,c=null;if(e.data)for(var f=0,l=(c=lu(e.data.getRecords(),r,i)).length;f<l;f++)n&&!n[f]&&(n[f]=null);return a={name:i.no_replace?null:e.name,shapes:n,data:c?new Vr(c):null,geometry_type:e.geometry_type},i.silent||(o=a,s=Kr(e),u=Kr(o),ht(t.format("Dissolved %,d feature%s into %,d feature%s",s,t.pluralSuffix(s),u,t.pluralSuffix(u)))),a}function wu(e,n){var r=new Int32Array(e.length);t.initializeArray(r,-1);var i=[],a=[];function o(e,t,o){var u=r[t];if(-1!=u&&n.flat){if(!(o&&o(e)>o(u)))return;s(t,u),r[t]=u,u=-1}-1==u?r[t]=e:-2==u?i[t].push(e):(i[t]=[u,e],r[t]=-2),a[e].push(t)}function s(e,t){for(var n=a[t],r=0;r<n.length;r++)if(n[r]===e){n[r]=-1;break}}this.getTileIdsByShapeId=function(e){var t=a[e];return t?t.filter((function(e){return e>=0})):[]},this.getShapeIdByTileId=function(e){var t=r[e];return t>=0?t:-1},this.getShapeIdsByTileId=function(e){var t=r[e];return t>=0?[t]:-1==t?[]:i[e]},this.indexTileIdsByShapeId=function(e,t,n){a[e]=[];for(var r=0;r<t.length;r++)o(e,t[r],n)},this.flatten=function(){i.forEach((function(e,t){!function(e){var t,n=i[e],a=n[0];r[e]=a;for(var o=0;o<n.length;o++)(t=n[o])!=a&&s(e,t)}(t)})),i=[]},this.getUnusedTileIds=function(){for(var e=[],t=0,n=r.length;t<n;t++)-1==r[t]&&e.push(t);return e},this.addTileToShape=function(e,t){e in a!=0&&-1==r[t]||lt("Internal error"),r[t]=e,a[e].push(t)}}function Su(e){var t=new Uint8Array(e),n=[];this.setId=function(e){this.hasId(e)||n.push(e),e<0?t[~e]|=2:t[e]|=1},this.clear=function(){var e=this;n.forEach((function(t){e.clearId(t)})),n=[]},this.hasId=function(e){return e<0?2==(2&t[~e]):1==(1&t[e])},this.clearId=function(e){e<0?t[~e]&=1:t[e]&=2},this.getIds=function(){return n},this.setIds=function(e){for(var t=0;t<e.length;t++)this.setId(e[t])}}function Au(e,t,n){for(var r=0,i=e.length;r<i;r++)e[r]=Iu(e[r],t,n)}function Iu(e,t,n){return or(e,(function(e){var r=function(e,t){for(var n=0,r=0,i=e.length;r<i;r++)t.arcIsDegenerate(e[r])&&(n++,e[r]=null);return n>0?e.filter((function(e){return null!==e})):e}(e,t);return"polygon"==n&&r&&(Mu(r),0===Dn.getPlanarPathArea(r,t)&&(r=null)),r}))}function Mu(e){var t=e.length;if(t>=2){if(e[0]==~e[t-1])e.pop(),e.shift();else for(var n=1;n<t;n++)if(e[n-1]==~e[n]){e.splice(n-1,2);break}e.length<t&&Mu(e)}}function Pu(e){var t=new Su(e.arcs.size(),!0),n=function(e){return t.hasId(~e)};return function(e){t.setIds(e);var n=r(e);return t.clear(),n};function r(e){for(var t=null,n=0,r=e.length;n<r-1;n++)if(null!==(t=i(e,e[n])))return t;return Mu(e),e.length>0?[e]:[]}function i(r,i){var s,u,c,f=e.getConnectedArcs(i,n);if(f.length<2)return null;s=[];for(var l=0;l<f.length;l++)(c=o(r,u=~f[l]))>-1&&(t.clearId(u),s.push(c));return s.length<2?null:Eu(r,s).reduce(a,null)}function a(e,t){var n=r(t);return null===e?n:(e.push.apply(e,n),e)}function o(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}}function Eu(e,n){var r=[];t.genericSort(n,!0),n[0]>0&&r.push(e.slice(0,n[0]));for(var i=0,a=n.length;i<a;i++)i<a-1?r.push(e.slice(n[i],n[i+1])):r.push(e.slice(n[i]));return r.length>n.length&&t.merge(r[0],r.pop()),r}nu.dissolve=function(e,n,r){var i,a;return(r=t.extend({},r)).where?function(e,n,r,i){i&&i.where||lt('Missing required "where" parameter');var a=e(ru(n,r,i),r,t.defaults({where:null},i)),o=ru(n,r,t.defaults({invert:!0},i));return nu.mergeLayers([o,a],{verbose:!1,force:!0})[0]}(nu.dissolve,e,n,r):(r.field&&(r.fields=[r.field]),a=cu(r.fields,e.data),r.multipart||r.group_points?i=function(e,t){e.shapes&&e.geometry_type||dt("Layer is missing geometry"),rr(e.shapes);var n=[];return e.shapes.forEach((function(e,r){var i=t(r);e&&(n[i]?n[i].push.apply(n[i],e):n[i]=e)})),n}(e,a):"polygon"==e.geometry_type?i=mu(e.shapes,a):"polyline"==e.geometry_type?i=function(e,t,n,r){var i=function(e,t){var n=[];return Qn(e,(function(e){var r=t(e.shapeId);r in n==0&&(n[r]=[]),n[r].push(e.arcId)})),n}(e.shapes,t),a=function(e){var t=new Uint8Array(e.size()),n=function(e){return t[zt(e)]>0},r=function(e){t[zt(e)]=0},i=new ja(e);return function(e){e.forEach((function(e){t[zt(e)]=1}));var a=function(e,t,n){var r=[];return e.forEach((function(e){0===t.getConnectedArcs(e,n).length&&r.push(~e),0===t.getConnectedArcs(~e,n).length&&r.push(e)})),r}(e,i,n),o=gu(a,i,n,r),s=gu(e,i,n,r),u=o.concat(s);return e.forEach((function(e){t[zt(e)]=0})),u}}(n);return i.map(a)}(e,a,n):"point"==e.geometry_type&&(i=function(e,t,n){var r=!n.planar&&Ei(yi(e)),i=n.weight?Gs(n.weight,e):null,a=[];return 0!==hi(e.shapes)&&dt("Dissolving multi-part points is not supported"),e.shapes.forEach((function(e,n){var o,s=t(n),u=i?i(n):1,c=e&&e[0];c&&(r&&(o=[],Dn.lngLatToXYZ(c[0],c[1],o),c=o),a[s]=function(e,t,n){var r,i,a=t[0],o=t[1];return a==a&&o==o&&n>0&&(e?(r=e.sum+n,i=e.sum/r,e.centroid[0]=i*e.centroid[0]+n*a/r,e.centroid[1]=i*e.centroid[1]+n*o/r,3==t.length&&(e.centroid[2]=i*e.centroid[2]+n*t[2]/r),e.sum=r):e={sum:n,centroid:t.concat()}),e}(a[s],c,u))})),a.map((function(e){var t,n;return e?(r?(t=e.centroid,n=[],Dn.xyzToLngLat(t[0],t[1],t[2],n)):n=e.centroid,e?[n]:null):null}))}(e,a,r)),_u(e,i,a,r))};var ju=Object.freeze({__proto__:null,cleanShapes:Au,removeSpikesInPath:Mu,getSelfIntersectionSplitter:Pu,splitPathByIds:Eu});function Ou(e,t){ar(e.shapes,(function(e){if(Dn.getPathArea(e,t)<=0)return null}))}function Fu(e,t){var n=Pu(e);return function(r,i,a){var o=t?Dn.getSphericalPathArea:Dn.getPlanarPathArea;ir(r,(function(t){var r=n(t);0===r.length&&vt("[getRingDivider()] Defective path:",t),r.forEach((function(t,n){var r=o(t,e.arcs);r>0?i.push(t):r<0&&a.push(t)}))}))}}var ku,Nu=Object.freeze({__proto__:null,deleteHoles:Ou,getHoleDivider:Fu});function Cu(e,n){var r,i,a=t.extend({},n),o=e.getBounds(),s=(!e.isPlanar()&&Dn.containsBounds(Pi(),o.toArray()),o.ymin),u=o.ymax-s,c=a.stripes||Du(e),f=new Uint32Array(c),l=c>1&&u>0?function(e){return Math.floor((c-1)*(e-s)/u)}:function(e){return 0};a.tolerance>=0==0&&(a.tolerance=wn(o.toArray())),e.forEachSegment((function(e,t,n,r){for(var i=l(r[e]),a=l(r[t]);f[i]=f[i]+2,i!=a;)i+=a>i?1:-1}));var d,p,h=(p=4*(d=t.sum(f)),(!ku||ku.byteLength<p)&&(ku=new ArrayBuffer(p)),new Uint32Array(ku,0,d)),g=0,m=[];t.forEach(f,(function(e){var t=g;g+=e,m.push(h.subarray(t,g))})),t.initializeArray(f,0),e.forEachSegment((function(e,t,n,r){for(var i,a,o=l(r[e]),s=l(r[t]);i=f[o],f[o]=i+2,(a=m[o])[i]=e,a[i+1]=t,o!=s;)o+=s>o?1:-1}));var y,v=e.getVertexData(),b=[];for(r=0;r<c;r++)for(y=Ru(m[r],v.xx,v.yy,a),i=0;i<y.length;i++)b.push(y[i]);return zu(b,a.unique?Lu:null)}function zu(e,t){var n={},r=t||Tu;return e.filter((function(e){var t=r(e);return!(t in n)&&(n[t]=!0,!0)}))}function Tu(e){return e.a.join(",")+";"+e.b.join(",")}function Lu(e){return e.x+","+e.y}function Bu(e){var t=e.getFilteredPointCount()-e.size(),n=2*Math.pow(t,.4);return Math.ceil(n)||1}function Du(e){var t=e.getFilteredPointCount()-e.size(),n=Math.ceil(Math.pow(10*t,.6)/40);return n>0?n:1}function Ru(e,t,n,r){var i,a,o,s,u,c,f,l,d,p,h,g,m,y,v,b,x,_=e.length-2,w=[],S=(r||{}).tolerance;for(fo(t,e),b=0;b<_;){for(i=e[b],a=e[b+1],u=t[i],c=t[a],d=n[i],p=n[a],x=b;x<_&&!(c<(f=t[o=e[x+=2]]));){if(h=n[o],l=t[s=e[x+1]],g=n[s],d>=h){if(d>g&&p>h&&p>g)continue}else if(d<g&&p<h&&p<g)continue;i!=o&&i!=s&&a!=o&&a!=s&&(m=Dn.segmentIntersection(u,d,c,p,f,h,l,g,S))&&(y=[i,a],v=[o,s],w.push(Uu(m,y,v,t,n)),4==m.length&&w.push(Uu(m.slice(2),y,v,t,n)))}b+=2}return w}function Uu(e,t,n,r,i){var a,o=e[0],s=e[1];return t=qu(o,s,t[0],t[1],r,i),n=qu(o,s,n[0],n[1],r,i),{x:o,y:s,a:a=t[0]<n[0]?t:n,b:a==t?n:t}}function qu(e,t,n,r,i,a){return i[n]==e&&a[n]==t?[n,n]:i[r]==e&&a[r]==t?[r,r]:n<r?[n,r]:[r,n]}var Gu=Object.freeze({__proto__:null,getIntersectionPoints:function(e){return e.map((function(e){return[e.x,e.y]}))},findSegmentIntersections:Cu,sortIntersections:function(e){e.sort((function(e,t){return e.x-t.x||e.y-t.y}))},dedupIntersections:zu,calcSegmentIntersectionStripeCount2:Bu,calcSegmentIntersectionStripeCount:Du,intersectSegments:Ru,formatIntersection:Uu,formatIntersectingSegment:qu});function Vu(e,t){var n,r,i=t||{},a=e.arcs,o=a&&a.getBounds();if(!o||!o.hasBounds())return new ja([]);vt("addIntersectionCuts() snap dist:",n=i.snap_interval?Ko(i.snap_interval,Wi(e)):!i.no_snap&&o.hasBounds()?wn(o.toArray()):0),a.flatten();var s=function(e,t){var n,r,i,a=e.arcs,o=t>0?{}:{tolerance:0},s=!1;return n=An(a,t),r=a.dedupCoords(),((i=Yu(e,o))>0||n>0||r>0)&&(s=!0),i>0&&(i=0,n=An(a,t),a.dedupCoords(),n>0&&(i=Yu(e,o)),i>0&&(a.dedupCoords(),vt("Second-pass vertices added:",i,"consider third pass?"))),s}(e,n);return(s||i.rebuild_topology)&&ya(e),e.layers.forEach((function(e){Hr(e)&&Au(e.shapes,a,e.geometry_type)})),r=function(e){var t,n=new ja(e.arcs),r=function(e){for(var t,n=new Int32Array(e.arcs.size()),r=0,i=0,a=e.arcs.size();i<a;i++)t=e.findDuplicateArc(i),n[i]=t,i!=t&&r++;return r>0?n:null}(n);return r&&$u(e,r),t=function(e){var t=gi(e.layers,e.arcs),n=e.arcs.size(),r=e.arcs.deleteArcs(t),i=n-e.arcs.size();return i>0&&$u(e,r),i}(e),t>0&&(n=new ja(e.arcs)),n}(e),r}function $u(e,t){var n=function(e){for(var n,r,i,a=0;a<e.length;a++)r=zt(n=e[a]),i=t[r],e[a]=n==r?i:~i;return e};e.layers.forEach((function(e){Hr(e)&&ar(e.shapes,n)}))}function Ju(e,t){return Hu(Ku(e,t),e)}function Yu(e,t){var n=e.arcs.getPointCount(),r=Ju(e.arcs,t),i=e.arcs.getPointCount();return Wu(e,r),i-n}function Wu(e,t){var n=function(e,t){return function(e){for(var t=[],r=0;r<e.length;r++)n(e[r],t);return t};function n(n,r){var i,a=n<0,o=a?~n:n,s=e[o],u=(o>=e.length-1?t:e[o+1])-1;do{a?(i=~u,u--):(i=s,s++),r.push(i)}while(u-s>=0)}}(t,e.arcs.size());e.layers.forEach((function(e){Hr(e)&&ar(e.shapes,n)}))}function Hu(e,t){var n,r,i,a,o=t.getVertexData(),s=o.xx,u=o.yy,c=o.nn,f=0,l=0,d=[],p=t.size(),h=new Uint32Array(p),g=Zu(Qu(e,s,u),t),m=t.getPointCount()+2*g.length,y=new Float64Array(m),v=new Float64Array(m);g.reverse(),a=g.pop();for(var b=0,x=0;b<p;b++){for(i=c[b],h[b]=x,n=0,r=0;n<i;){for(y[l]=s[f],v[l]=u[f],l++,r++;a&&a.i==f;)y[l]=a.x,v[l]=a.y,l++,r++,d[x++]=r,r=0,y[l]=a.x,v[l]=a.y,l++,r++,a=g.pop();n++,f++}d[x++]=r}return l!=m&&lt("[insertCutPoints()] Counting error"),t.updateVertexData(d,y,v,null),h}function Xu(e,t,n,r,i,a){return(r<n||r>n+1)&&lt("Out-of-sequence arc ids:",n,r),{x:e,y:t,i:n}}function Qu(e,t,n){return e.sort((function(e,r){return e.i!=r.i?e.i-r.i:Dn.distanceSq(t[e.i],n[e.i],e.x,e.y)-Dn.distanceSq(t[r.i],n[r.i],r.x,r.y)})),e}function Zu(e,t){var n=[],r=0;return t.forEach2((function(t,i,a,o){for(var s,u,c=t+i-1,f=a[t],l=o[t],d=a[c],p=o[c];r<e.length&&e[r].i<=c;)s=e[r],u=n[n.length-1],s.x==f&&s.y==l||s.x==d&&s.y==p||u&&u.x==s.x&&u.y==s.y&&u.i==s.i||n.push(s),r++})),n}function Ku(e,t){var n=Cu(e,t),r=e.getVertexData();return function(e,t,n){for(var r,i,a,o=[],s=0,u=e.length;s<u;s++)i=Xu((r=e[s]).x,r.y,r.a[0],r.a[1]),a=Xu(r.x,r.y,r.b[0],r.b[1]),i&&o.push(i),a&&o.push(a);return o}(n,r.xx,r.yy)}var ec=Object.freeze({__proto__:null,addIntersectionCuts:Vu,divideArcs:Ju,cutPathsAtIntersections:Yu,remapDividedArcs:Wu,insertCutPoints:Hu,getCutPoint:Xu,sortCutPoints:Qu,filterSortedCutPoints:Zu,findClippingPoints:Ku}),tc={stack:[],start:function(){tc.stack.push(Date.now())},stop:function(){return Date.now()-tc.stack.pop()+"ms"}};function nc(e){tc.start(),e.detachAcyclicArcs();var n=function(e){for(var t=e.arcs,n=[],r=[],i=[],a=[],o=new Uint8Array(t.size()),s=Co(e,(function(e){return l(e,!0)})),u=0,c=o.length;u<c;u++)f(u),f(~u);return{cw:n,ccw:r,empty:i,lostArcs:a};function f(e){var o,u;if(l(e)){if(!(o=s(e)))return a.push(e),void vt("Dead-end arc:",e);(u=Dn.getPlanarPathArea(o,t))>0?n.push(o):u<0?r.push(o):i.push(o)}}function l(e,t){var n=zt(e),r=n==e?1:2,i=0==(o[n]&r);return t&&i&&(o[n]|=r),i}}(e),r=n.cw.map((function(e){return[e]}));vt("Find mosaic rings",tc.stop()),tc.start();var i=[],a=new go(r,e.arcs);return n.ccw.forEach((function(e){var t=a.findSmallestEnclosingPolygon(e);t>-1?r[t].push(e):($n(e),i.push([e]))})),vt(t.format("Detect holes (holes: %d, enclosures: %d)",n.ccw.length-i.length,i.length),tc.stop()),{mosaic:r,enclosures:i,lostArcs:n.lostArcs}}var rc=Object.freeze({__proto__:null,mosaic:function(e,t){var n,r,i,a,o,s,u,c,f=[];return e.arcs||dt("Dataset is missing path data"),r=nc(n=Vu(e,t)),f.push({name:"mosaic",shapes:r.mosaic,geometry_type:"polygon"}),t.debug&&(f.push({geometry_type:"polygon",name:"mosaic-enclosure",shapes:r.enclosures}),r.lostArcs.length>0&&(f=f.concat((i=r.lostArcs,a=n.arcs,o={geometry_type:"polyline",name:"lost-arcs",shapes:[]},s={geometry_type:"point",name:"lost-arc-endpoints",shapes:[]},u=[],c=[],i.forEach((function(e){var t=a.getVertex(e,0),n=a.getVertex(e,-1);u.push({ARCID:e}),o.shapes.push([[e]]),c.push({ARCID:e},{ARCID:e}),s.shapes.push([[t.x,t.y]],[[n.x,n.y]])})),o.data=new Vr(u),s.data=new Vr(c),[o,s])))),f},buildPolygonMosaic:nc});function ic(e,n){var r=new Int32Array(e),i=new Int32Array(e),a=this,o=[];t.initializeArray(r,-1),t.initializeArray(i,-1),this.setId=function(e,t){n&&!a.hasId(e)&&o.push(e),e<0?i[~e]=t:r[e]=t},this.clear=function(){n||lt("Index is not clearable"),o.forEach((function(e){a.setId(e,-1)})),o=[]},this.clearId=function(e){a.hasId(e)||lt("Tried to clear an unset id"),a.setId(e,-1)},this.hasId=function(e){return a.getId(e)>-1},this.getId=function(t){var n=t<0?~t:t;return n>=e?-1:t<0?i[n]:r[n]}}function ac(e,t,n,r){var i,a,o,s=n.arcs,u=new Su(e.length,!0),c=Fu(n),f=new Su(s.size(),!0),l=new Su(s.size(),!0);function d(e){i=i?i.concat(e):e}function p(t){a=s.getSimpleShapeBounds2(t),f.setIds(t),function(t){for(var n,r=t.concat();r.length>0;)(n=g(r.pop()))>=0&&h(r,e[n])}(t),f.clear(),u.clear()}function h(e,t){for(var n,r,i,a,o=0,s=t.length;o<s;o++)for(var u=0,c=(r=t[o]).length;u<c;u++)void 0,a=~(i=n=r[u]),!(f.hasId(i)||f.hasId(a)||l.hasId(i)||l.hasId(a))&&e.push(~n)}function g(e){var n=t.getShapeIdByArcId(e);return-1==n||u.hasId(n)?-1:!1===s.arcIsContained(zt(e),a)?(vt("Out-of-bounds ring arc",e),-1):(u.setId(n),o.push(n),n)}this.getTilesInShape=function(e,t){var n,a=[],s=[];return o=[],i=[],r.no_holes?c(e,a,s):(c(e,a,s),s.forEach(d),l.setIds(i)),a.forEach(p),n=o,o=null,l.clear(),i=null,n}}var oc=Object.freeze({__proto__:null,PolygonTiler:ac});function sc(e,t,n){var r=n||{},i=e.shapes,a=(Fu(t),nc(t).mosaic),o=new uc(a,t.arcs),s=new Su(a.length,!0),u=new wu(a,r),c=new ac(a,o,t,r),f=null;function l(e,t,n){var r=[],i=n?-1:1;return function(n){var a;return n in r?a=r[n]:(a=i*Math.abs(Dn.getShapeArea(e[n],t)),r[n]=a),a}}function d(e,t){return a[e]}function p(e){for(var n,r,i,s,c=a[e][0],f=t.arcs,l=-1,d=0,p=0;p<c.length;p++)n=c[p],(i=o.getShapeIdByArcId(~n))<0||(r=u.getShapeIdByTileId(i))<0||(s=Dn.getPathPerimeter([n],f))>d&&(l=r,d=s);l>-1&&u.addTileToShape(l,e)}!r.simple&&r.flat&&(f=function(e,t,n){var r;return n&&"max-area"!=n?"min-area"==n?r=l(e,t,!0):"max-id"==n?r=function(e){return e}:"min-id"==n?r=function(e){return-e}:dt("Unknown overlap rule:",n):r=l(e,t,!1),r}(e.shapes,t.arcs,r.overlap_rule)),this.mosaic=a,this.nodes=t,this.getSourceIdsByTileId=u.getShapeIdsByTileId,this.getTileIdsByShapeId=u.getTileIdsByShapeId,i.forEach((function(e,t){var n=c.getTilesInShape(e,t);u.indexTileIdsByShapeId(t,n,f)})),r.flat&&u.flatten(),this.removeGaps=function(e){r.flat||lt("MosaicIndex#removeGaps() should only be called with a flat mosaic");var t=u.getUnusedTileIds(),n=t.filter((function(t){var n=a[t];return e(n[0])}));return n.forEach(p),{removed:n.length,remaining:t.length-n.length}},this.getUnusedTiles=function(){return u.getUnusedTileIds().map(d)},this.getTilesByShapeIds=function(e){return function(e){var t,n,r,i,a=[];for(r=0;r<e.length;r++)for(n=u.getTileIdsByShapeId(e[r]),i=0;i<n.length;i++)t=n[i],s.hasId(t)||(s.setId(t),a.push(t));return s.clear(),a}(e).map(d)}}function uc(e,t){var n,r=new ic(t.size());function i(e){for(var t,i=0,a=e.length;i<a;i++)t=e[i],r.setId(t,n)}e.forEach((function(e,t){n=t,e.forEach(i)})),this.getShapeIdByArcId=function(e){return r.getId(e)}}var cc=Object.freeze({__proto__:null,MosaicIndex:sc,ShapeArcIndex:uc});function fc(e,n,r){(r=t.extend({},r)).field&&(r.fields=[r.field]);var i=cu(r.fields,e.data),a=function(e,t){return e.shapes.reduce((function(e,n,r){var i=t(r);return i in e==0&&(e[i]=[]),e[i].push(r),e}),[])}(e,i);return _u(e,dc(a,e,n,r),i,r)}function lc(e,n){var r=n.map((function(e,t){return{tile_id:t}}));return t.defaults({shapes:n,data:new Vr(r)},e)}function dc(e,n,r,i){var a,o,s=qn(n.shapes,r.arcs),u=new sc(n,new ja(r.arcs,s),{flat:!i.allow_overlaps,simple:1==e.length,overlap_rule:i.overlap_rule}),c=!i.allow_overlaps;c&&(o=is(n,r,t.extend({sliver_control:1},i)),a=u.removeGaps(o.filter));var f,l,d,p=zo(u.nodes),h=e.map((function(e){var t=u.getTilesByShapeIds(e);return i.tiles?t.reduce((function(e,t){return e.concat(t)}),[]):function(e,t){for(var n,r,i=[],a=[],o=0,s=e.length;o<s;o++)r=e[o],i.push(r[0]),r.length>1&&(a=a.concat(r.slice(1)));return(n=t(i.concat(a),"dissolve")).length,n.length>0?n:null}(t,p)}));if(h=function(e,t){var n=function(e,n){$n(n);var r=t([n],"flatten");return r.length>1?(r.forEach($n),e=e.concat(r)):e.push($n(n)),e};return e.map((function(e){return e?e.reduce(n,[]):null}))}(h,p),c&&!i.quiet){var g=(f=a.removed,l=a.remaining,d=o.label,f>0==0?"":t.format("Removed %,d / %,d sliver%s using %s",f,f+l,t.pluralSuffix(f),d));g&&ht(g)}return h}var pc=Object.freeze({__proto__:null,dissolvePolygonLayer2:fc,composeMosaicLayer:lc,dissolvePolygonGroups2:dc});function hc(e,n,r){var i,a=r||{},o=!a.only_arcs,s=t.some(e,Hr);a.debug?Vu(n,a):(e.forEach((function(e){Wr(e)&&("polygon"==e.geometry_type&&a.rewind&&mo(e,n.arcs),o&&(i||(i=Vu(n,a)),"polygon"==e.geometry_type?function(e,t,n){var r=e.shapes.map((function(e,t){return[t]}));e.shapes=dc(r,e,t,n)}(e,n,a):"polyline"==e.geometry_type?function(e,t,n){var r=t.arcs,i=new ja(r,qn(e.shapes,r)),a=new ic(r.size(),!0);e.shapes=e.shapes.map((function(e,t){return e?(e=function(e,t){var n=[];return ir(e,(function(e){for(var r,i=e.length,a=[],o=0;o<i;o++)r=e[o],a.push(r),o<i-1&&t.getConnectedArcs(r).length>1&&(n.push(a),a=[]);a.length>0&&n.push(a)})),n}(e,i),a.clear(),e=function(e,t){var n=e.reduce((function(e,n){return function(e,t,n){for(var r,i=[],a=0;a<t.length;a++)r=t[a],n.hasId(r)?i.length>0&&(e.push(i),i=[]):i.push(r),n.setId(r,a),n.setId(~r,a);i.length>0&&e.push(i)}(e,n,t),e}),[]);return n.length>0?n:null}(e,a),a.clear(),e=function(e,t,n){return!e||e.length<2?e:(e.forEach((function(e,t){var i=~e[0],a=e[e.length-1];(n.hasId(i)||n.hasId(a))&&lt("Indexing error"),n.setId(i,t),n.setId(a,t),r(i,t),r(a,t)})),e.filter((function(e){return!!e})));function r(r,i){var a,o=0,s=-1,u=n.getId(r);if(t.forEachConnectedArc(r,(function(e){n.hasId(e)&&(s=n.getId(e),a=e),o++})),1==o&&s>-1&&s<i){!function(e,t,n,r,i){var a,o,s,u,c=e[t],f=e[r];~n==c[0]?a=!0:n==c[c.length-1]?a=!1:lt("Index error"),~i==f[0]?o=!0:i==f[f.length-1]?o=!1:lt("Index error 2"),o||(f=$n(f.concat())),a?function(e,t){t=$n(t.concat());var n=[0,0].concat(t);e.splice.apply(e,n)}(c,f):(u=f,(s=c).push.apply(s,u))}(e,s,a,u,r),n.setId(r,s);var c=function(e,t){var n=~e[0],r=e[e.length-1];return t==n?r:t==r?n:void lt("Indexing error")}(e[u],r);n.setId(c,s),u!=s&&(e[u]=null)}}}(e,i,a),e):null}))}(e,n):"point"==e.geometry_type&&function(e,t,n){var r,i;function a(e){var t=e.join("~");t in r||(r[t]=!0,i.push(e))}e.shapes=e.shapes.map((function(e,t){return e&&e.length>0!=0?1==e.length?e:(r={},i=[],e.forEach(a),0===i.length?null:i):null}))}(e)),a.allow_empty||nu.filterFeatures(e,n.arcs,{remove_empty:!0,verbose:a.verbose}))})),!a.no_arc_dissolve&&s&&n.arcs&&Oa(n))}function gc(e){return e.reduce((function(e,n){return null===e?e=n.name||null:e&&n.name&&(e=t.mergeNames(e,n.name)),e}),null)||""}nu.cleanLayers=hc,nu.mergeAndFlattenLayers=function(e,t,n){if(!n.flatten)return nu.mergeLayers(e,n);e.forEach((function(e){si(e,"the flatten option requires polygon layers")}));var r=nu.mergeLayers(e,n);return Ga(t,e,r),hc(r,t,{overlap_rule:"max-id"}),Ga(t,r,e),r},nu.mergeLayers=function(e,n){var r=e.filter(Kr),i={};return n=n||{},r.length?1==r.length?(ht("Use the target= option to specify multiple layers for merging"),r.concat()):(i.data=function(e,n){var r=t.uniq(e.reduce((function(e,t){return e.concat(t.data?t.data.getFields():[])}),[]));if(0===r.length)return null;var i=e.reduce((function(e,t){var n=t.data?t.data.getRecords():new Vr(Kr(t)).getRecords();return e.concat(n)}),[]),a=function(e,n){return t.uniq(n.reduce((function(n,r){return n.concat(t.difference(e,r.data?r.data.getFields():[]))}),[]))}(r,e);return function(e,t){var n;e.length>0&&(n="["+e.join(", ")+"]",n=(1==e.length?"Field "+n+" is missing":"Fields "+n+" are missing")+" from one or more layers",t.force?!1!==t.verbose&&ht("Warning: "+n):dt(n))}(a,n),function(e,t){e.forEach((function(e){var n=function(e,t){return t.reduce((function(t,n){var r=n.data?kr(e,n.data.getRecords()):null;return r&&-1==t.indexOf(r)&&t.push(r),t}),[])}(e,t);n.length>1&&dt('Inconsistent data types in "'+e+'" field:',n.join(", "))}))}(r,e),a.length>0&&Or(i),new Vr(i)}(r,n),i.name=gc(r),i.geometry_type=function(e){var n=t.uniq(t.pluck(e,"geometry_type")).filter((function(e){return!!e}));return n.length>1&&dt("Incompatible geometry types:",n.join(", ")),n[0]||null}(r),i.geometry_type&&(i.shapes=function(e){return e.reduce((function(e,t){for(var n=t.shapes||[],r=Kr(t),i=-1;++i<r;)e.push(n[i]||null);return e}),[])}(r)),i.shapes&&i.data&&i.shapes.length!=i.data.size()&&lt("Mismatch between geometry and attribute data"),[i]):null};var mc={};function yc(e,n){return(n=t.extend({},n)).v2=!n.gj2008,vc(e,n)}function vc(e,n){var r,i=(n=n||{}).extension||"json";return(n.precision||n.rfc7946)&&Vo(e=Ta(e),n.precision||1e-6),(n.v2||n.rfc7946)&&(r=xc(e))&&ht(r),n.file&&(i=Za(n.file)),(n.combine_layers?[e.layers]:e.layers.map((function(e){return[e]}))).map((function(r){var a=gc(r)||"output";return{content:wc(t.defaults({layers:r},e),n,"buffer"),filename:a+"."+i}}))}function bc(e,t,n,r,i){var a,o=Pc(e.data,n),s=e.shapes,u=jc(e.data,n);return a=n.ndjson?wo:n.prettify?So(["bbox","coordinates"]):JSON.stringify,o&&s&&o.length!==s.length&&lt("Mismatch between number of properties and number of shapes"),(s||o||[]).reduce((function(c,f,l){var d=s?s[l]:null,p=mc.exporters[e.geometry_type],h=d?p(d,t.arcs,n):null,g=null;if(r)g=mc.toFeature(h,o?o[l]:null),u&&(g.id=u[l]);else{if(!h)return c;g=h}return i&&(g=a(g),"buffer"==i&&(g=wr(g,"utf8"))),c.push(g),c}),[])}function xc(e){var t,n=Wi(e);return n&&Qi(n)||(t="RFC 7946 warning: non-WGS84 GeoJSON output.",n&&(t+=' Tip: use "-proj wgs84" to convert.')),t}function _c(e,t){var n,r,i,a,o=Wi(e),s=t&&o&&Qi(o),u=new jt,c=new jt;return e.layers.forEach((function(t){Hr(t)?Qn(t.shapes,null,(function(t){var n=e.arcs.getSimpleShapeBounds(t.arcs);(n.centerX()<0?u:c).mergeBounds(n)})):Xr(t)&&Nt(t.shapes,(function(e){(e[0]<0?u:c).mergePoint(e[0],e[1])}))})),(n=(new jt).mergeBounds(c).mergeBounds(u)).hasBounds()&&(a=n.toArray()),s&&c.hasBounds()&&u.hasBounds()&&(r=c.xmin-u.xmax,i=360+u.xmin-c.xmax,r>0&&r>i&&(a[0]=c.xmin,a[2]=u.xmax)),a||null}function wc(e,t,n){var r,i,a={},o=e.layers,s=Ic(o,t);return a.type=s?"FeatureCollection":"GeometryCollection",t.gj2008&&Ac(e,a),t.bbox&&(i=_c(e,t.rfc7946||t.v2))&&(a.bbox=i),r=o.reduce((function(r,i,a){var o=bc(i,e,t,s,n);return r.length>0?r.concat(o):o}),[]),"Feature"==t.geojson_type&&1==r.length?r[0]:t.ndjson?mc.formatCollectionAsNDJSON(r):n?mc.formatCollection(a,r):(a[Sc(a.type)]=r,a)}function Sc(e){return"FeatureCollection"==e?"features":"GeometryCollection"==e?"geometries":void lt("Invalid collection type:",e)}function Ac(e,t){var n=e.info||{};!n.crs&&"input_geojson_crs"in n&&(t.crs=n.input_geojson_crs)}function Ic(e,n){var r=n.geojson_type||"";return"Feature"==r||"FeatureCollection"==r||"GeometryCollection"!=r&&(r&&dt("Unsupported GeoJSON type:",n.geojson_type),t.some(e,(function(e){var t=e.data?e.data.getFields():[],r=Mc(t,n),i=!!Ec(t,n);return r||i})))}function Mc(e,t){return!(t.drop_table||t.cut_table||0===e.length||1==e.length&&e[0]==mc.ID_FIELD)}function Pc(e,n){var r,i=e?e.getFields():[],a=Ec(i,n);return Mc(i,n)?(r=e.getRecords(),a==mc.ID_FIELD?r.map((function(e){return delete(e=t.extend({},e))[a],e})):r):null}function Ec(e,n){var r=[],i=n.id_field;return t.isString(i)?r.push(i):t.isArray(i)&&(r=i),r.push(mc.ID_FIELD),t.find(r,(function(n){return t.contains(e,n)}))}function jc(e,t){var n=Ec(e?e.getFields():[],t);return n?e.getRecords().map((function(e){return n in e?e[n]:null})):null}mc.ID_FIELD="FID",mc.typeLookup={LineString:"polyline",MultiLineString:"polyline",Polygon:"polygon",MultiPolygon:"polygon",Point:"point",MultiPoint:"point"},mc.translateGeoJSONType=function(e){return mc.typeLookup[e]||null},mc.pathIsRing=function(e){var t=e[0],n=e[e.length-1];return e.length>=4&&t[0]==n[0]&&t[1]==n[1]},mc.toFeature=function(e,t){var n=e?e.type:null;return"Feature"==n?e:n in mc.typeLookup?{type:"Feature",geometry:e,properties:t||null}:{type:"Feature",geometry:null,properties:t||null}},mc.formatCollectionAsNDJSON=function(e){var n=t.createBuffer("\n","utf8"),r=e.reduce((function(e,t,r){return r>0&&e.push(n),e.push(t),e}),[]);return u.concat(r)},mc.formatCollection=function(e,n){var r=JSON.stringify(e).replace(/\}$/,', "'+Sc(e.type)+'": [\n');return t.isString(n[0])?r+n.join(",\n")+"\n]}":mc.joinOutputBuffers(r,"\n]}",n)},mc.joinOutputBuffers=function(e,n,r){var i=t.createBuffer(",\n","utf8"),a=r.reduce((function(e,t,n){return n>0&&e.push(i),e.push(t),e}),[t.createBuffer(e,"utf8")]);return a.push(t.createBuffer(n,"utf8")),u.concat(a)},mc.exportPointGeom=function(e,t){var n=null;return 1==e.length?n={type:"Point",coordinates:e[0]}:e.length>1&&(n={type:"MultiPoint",coordinates:e}),n},mc.exportLineGeom=function(e,t){var n=xo(e,t,"polyline");if(0===n.pointCount)return null;var r=n.pathData.map((function(e){return e.points}));return 1==r.length?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}},mc.exportPolygonGeom=function(e,t,n){var r=xo(e,t,"polygon");if(0===r.pointCount)return null;var i=vo(r.pathData,t,n.invert_y),a=(n.rfc7946||n.v2)&&!n.invert_y,o=i.map((function(e){return e.map((function(e){return a&&e.points.reverse(),e.points}))}));return 1==o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o}},mc.exporters={polygon:mc.exportPolygonGeom,polyline:mc.exportLineGeom,point:mc.exportPointGeom};var Oc=Object.freeze({__proto__:null,default:mc,exportGeoJSON2:yc,exportGeoJSON:vc,exportLayerAsGeoJSON:bc,getRFC7946Warnings:xc,getDatasetBbox:_c,exportDatasetAsGeoJSON:wc,preserveOriginalCRS:Ac,useFeatureCollection:Ic,exportProperties:Pc,getIdField:Ec,exportIds:jc}),Fc={};function kc(e){var t=Nc(e);return!!t&&t in Fc}function Nc(e){var t=e.data&&e.data.getReadOnlyRecordAt(0);return t&&t.type||null}function Cc(e){return e.data&&e.data.getReadOnlyRecordAt(0)}function zc(e,t){var n=Fc[e.type];return n||dt("Missing renderer for",e.type,"element"),n(e,t)||[]}var Tc=Object.freeze({__proto__:null,furnitureRenderers:Fc,layerHasFurniture:kc,isFurnitureLayer:function(e){return!!e.furniture},getFurnitureLayerType:Nc,getFurnitureLayerData:Cc,importFurniture:zc});function Lc(e,t){var n,r=Uc(e);return n=r?Object.assign({},Bc(r)):function(e,t){var n=Ba(e),r=Vc(n,t);return{bbox:n.toArray(),width:Math.round(r.width()),height:Math.round(r.height())||1,type:"frame"}}(e,t),n.crs=Wi(e),n}function Bc(e){return e.data&&e.data.getReadOnlyRecordAt(0)}function Dc(e,t){var n,r,i=e.width()/e.height();return n=(r=t.pixels?Math.sqrt(+t.pixels*i):+t.width)/i,[Math.round(r),Math.round(n)]}function Rc(e){return"frame"==Nc(e)}function Uc(e){return t.find(e.layers,(function(e){return Rc(e)}))}function qc(e){var n=t.find(e.getLayers(),(function(e){return Rc(e.layer)}));return n?n.dataset:null}function Gc(e){var t,n,r=new jt(e.bbox);return e.crs?(t=Xi(r.centerX(),r.centerY(),e.crs),n=e.crs.to_meter):(t=1,n=1),r.width()/t*n/e.width}function Vc(e,t){var n,r,i,a,o,s=0,u=0,c=0,f=0,l=e.width(),d=e.height(),p=$c(t.margin),h=p[0]+p[2],g=p[1]+p[3];return t.fit_bbox?(c=t.fit_bbox[0],f=t.fit_bbox[1],l/d>(n=t.fit_bbox[2]-c)/(r=t.fit_bbox[3]-f)?r=0:n=0,h=g=0):t.svg_scale>0?(n=l/t.svg_scale+h,r=0):+t.pixels?(n=(i=Dc(e,t))[0],r=i[1]):(r=t.height||0,n=t.width||(r>0?0:800)),r>0&&(o=(d||l||1)/(r-g)),n>0&&(a=(l||d||1)/(n-h)),n?r||(o=a,r=d>0?g+d/o:n,t.max_height>0&&r>t.max_height&&(o=a*r/t.max_height,r=t.max_height)):(a=o,n=l>0?h+l/a:r),a>o?u=(o=a)*(r-g)-d:o>a&&(s=(a=o)*(n-h)-l),e.padBounds(p[0]*a+.5*s,p[1]*o+.5*u,p[2]*a+.5*s,p[3]*o+.5*u),n>0&&r>0||lt("Missing valid height and width parameters"),a===o&&a>0||lt("Missing valid margin parameters"),new jt(c,f,n+c,r+f)}function $c(e){var n=(t.isNumber(e)?String(e):e||"").trim().split(/[, ] */);return 1==n.length&&n.push(n[0]),2==n.length&&n.push(n[0],n[1]),3==n.length&&n.push(n[2]),n.map((function(e){var t=parseFloat(e);return isNaN(t)?1:t}))}var Jc=Object.freeze({__proto__:null,getFrameData:Lc,getFrameLayerData:Bc,getFrameSize:Dc,findFrameLayerInDataset:Uc,findFrameDataset:qc,findFrameLayer:function(e){var n=t.find(e.getLayers(),(function(e){return Rc(e.layer)}));return n&&n.layer||null},getFrameLayerBounds:function(e){return new jt(Bc(e).bbox)},getMapFrameMetersPerPixel:Gc,calcOutputSizeInPixels:Vc,parseMarginOption:$c});function Yc(e,t,n,r){var i=e*Math.PI/180,a=t*Math.cos(i),o=-t*Math.sin(i);return function(e,t){return[a*(e-r[0])-o*(t-r[1])+n[0]+r[0],o*(e-r[0])+a*(t-r[1])+n[1]+r[1]]}}nu.affine=function(e,n,r){var i,a,o,s=r.rotate||0,u=r.scale||1,c=r.shift?es(r.shift,Wi(n)):[0,0],f=n.arcs,l=[],d=[],p=[];n.layers.filter(Wr).forEach((function(t){var i,a=[],o=[];-1==e.indexOf(t)?o=t.shapes:r.where?(i=Gs(r.where,t,n.arcs),t.shapes.forEach((function(e,t){(i(t)?a:o).push(e)}))):a=t.shapes,"point"==t.geometry_type?p=p.concat(a):(l=l.concat(a),d=d.concat(o))}));var h=function(e,t){var n;return t.anchor?t.anchor:[(n=Ba(e)).centerX(),n.centerY()]}({arcs:n.arcs,layers:[{geometry_type:"point",shapes:p},{geometry_type:"polyline",shapes:l}]},r);o=Yc(s,u,c,h),l.length>0&&(i=new Uint8Array(f.size()),a=new Uint8Array(f.size()),Gn(l,i),d.length>0&&(Gn(d,a),function(e,t){for(var n=0,r=e.length;n<r;n++)0===t[n]&&(e[n]=0)}(a,i),n.arcs=function(e,n,r){for(var i,a=0,o=0,s=n.getVertexData(),u=[],c=[],f=[],l=[],d=0,p=r.length;d<p;d++)r[d]>0&&(l[d]=n.size()+a,i=s.nn[d],t.copyElements(s.xx,s.ii[d],u,o,i),t.copyElements(s.yy,s.ii[d],c,o,i),f.push(i),o+=i,a++);return Wn(e,(function(e){var t=zt(e);if(r[t]>0)return e<0?~l[t]:l[t]})),Aa([n,new da(f,u,c)])}(d,f,a)),n.arcs.transformPoints((function(e,t,n){if(n<i.length&&i[n]>0)return o(e,t)}))),Nt(p,(function(e){var t=o(e[0],e[1]);e[0]=t[0],e[1]=t[1]}))};var Wc=Uo(.01);function Hc(e){return" "+Wc(e[0])+" "+Wc(e[1])}function Xc(e){return e.length>2&&"C"==e[2]}function Qc(e){for(var t=[],n=0;n<e.length;n++)t.push(Zc(e[n])+" Z");return t.length>0?t.join(" "):""}function Zc(e){if(0===e.length)return"";var t,n,r,i="M",a=!1;for(n=0,r=e.length;n<r;n++)Xc(t=e[n])?(i+=" C"+Hc(t)+Hc(e[++n])+Hc(e[++n]),a=!0):a?(i+=" L"+Hc(t),a=!1):i+=Hc(t);return i}var Kc=Object.freeze({__proto__:null,stringifyPolygonCoords:Qc,stringifyLineStringCoords:Zc});function ef(e){if(!e)return null;var t=function(e){return String(e).trim().split(/[, ]+(?![^(]*\))/)}(e),n=t[0]||"",r=null;return n.startsWith("dot")?(t[0]="dots",r=af(t)):n.startsWith("square")?(t[0]="squares",r=af(t)):n.startsWith("hatch")?(t[0]="hatches",r=nf(t)):n.startsWith("dash")?r=tf(t):isNaN(parseFloat(n))||(t.unshift("hatches"),r=nf(t)),r||ht("Invalid pattern, ignoring:",e),r}function tf(e){e.shift();for(var n,r=[],i=e.pop(),a=parseInt(e.pop());e.length>0;){if(rf(n=e.pop())){e.push(n);break}r.push(n)}var o=parseInt(e.pop()),s=[parseInt(e.pop()),parseInt(e.pop())].reverse(),u=45;return e.length>0&&(u=parseInt(e.pop())),e.length>0||o>0==0?null:{type:"dashes",tileSize:[r.length*(o+a),t.sum(s)],colors:r,width:o,dashes:s,spacing:a,background:i,rotation:u}}function nf(e){e.shift();for(var n=e.length%2==1?parseInt(e.shift()):45,r=[],i=[],a=0;a<e.length;a+=2)i.push(parseInt(e[a])),r.push(e[a+1]);return Math.min.apply(null,i)>0==0?null:{tileSize:[t.sum(i),10],type:"hatches",colors:r,widths:i,rotation:n}}function rf(e){return parseInt(e)>0}function af(e){var t=[],n=e.shift(),r=0;rf(e[1])&&(r=parseInt(e.shift()));for(var i=parseInt(e.shift()),a=e.pop(),o=parseInt(e.pop());e.length>0;)t.push(e.shift());if(i>0==0||o>=0==0)return null;if(0===t.length)return null;var s=t.length*(i+o);return{type:n,tileSize:[s,s],colors:t,size:i,spacing:o,background:a,rotation:r}}function of(e,n){var r,i,a,o=e["fill-pattern"],s=("hash_"+o).replace(/[()# ,_]+/g,"_"),u=t.find(n,(function(e){return e.id==s}));if(delete e["fill-pattern"],!u){if(r=s,!(u=(a=ef(o))?("hatches"==a.type?i=function(e){for(var t=e.tileSize[1],n="",r=0,i=0;r<e.widths.length;r++)n+=`<rect x="${i}" y="0" width="${e.widths[r]}" height="${t}" fill="${e.colors[r]}"></rect>`,i+=e.widths[r];return n}(a):"dots"==a.type||"squares"==a.type?i=function(e){for(var t=e.size,n=e.colors.length,r=t+e.spacing,i=n*n,a="squares"==e.type?cf:uf,o="",s=0,u=0,c=0;s<i;s++)o+=a(u,c,t,e.colors[(s+Math.floor(s/n))%n]),0==(u=(s+1)%n*r)&&(c+=r);return o}(a):"dashes"==a.type&&(i=function(e){for(var t="",n=0,r=0;n<e.colors.length;n++)t+=`<rect x="${r}" y="0" width="${e.width}" height="${e.dashes[0]}" fill="${e.colors[n]}"></rect>`,r+=e.width+e.spacing;return t}(a)),{svg:sf(a,r,i),id:r,href:`url(#${r})`}):null))return;n.push(u)}e.fill=u.href}function sf(e,t,n){var r=e.tileSize[0],i=e.tileSize[1],a=`<pattern id="${t}" patternUnits="userSpaceOnUse" width="${r}" height="${i}" patternTransform="rotate(${e.rotation})">`;return e.background&&(a+=`<rect x="0" y="0" width="${r}" height="${i}" fill="${e.background}"></rect>`),a+n+"</pattern>"}function uf(e,t,n,r){const i=n/2;return`<circle cx="${e+i}" cy="${t+i}" r="${i}" fill="${r}"></circle>`}function cf(e,t,n,r){return`<rect x="${e}" y="${t}" width="${n}" height="${n}" fill="${r}"></rect>`}var ff=Object.freeze({__proto__:null,parsePattern:ef,parseDashes:tf,parseHatches:nf,parseDots:af,convertFillPattern:of}),lf={css:null,class:"classname",dx:"measure",dy:"measure",fill:"color","fill-pattern":"pattern","font-family":null,"font-size":null,"font-style":null,"font-weight":null,"label-text":null,"letter-spacing":"measure","line-height":"measure",opacity:"number",r:"number",stroke:"color","stroke-dasharray":"dasharray","stroke-width":"number","stroke-opacity":"number","stroke-miterlimit":"number","fill-opacity":"number","vector-effect":null,"text-anchor":null},df=t.extend({type:null,length:"number",rotation:"number",radius:"number",radii:null,flipped:"boolean",rotated:"boolean",direction:"number",sides:"number",points:"number",anchor:null,"head-angle":"number","head-width":"number","head-length":"number","stem-width":"number","stem-curve":"number","stem-taper":"number","stem-length":"number","min-stem-ratio":"number","arrow-scaling":"number",effect:null},lf),pf="css,class,opacity,stroke,stroke-width,stroke-dasharray,stroke-opacity,fill-opacity,vector-effect".split(","),hf={polygon:t.arrayToIndex(pf.concat("fill","fill-pattern")),polyline:t.arrayToIndex(pf.concat("stroke-linecap","stroke-linejoin","stroke-miterlimit")),point:t.arrayToIndex(pf.concat("fill","r")),label:t.arrayToIndex(pf.concat("fill,font-family,font-size,text-anchor,font-weight,font-style,letter-spacing,dominant-baseline".split(",")))};function gf(e,t,n,r){for(var i=yf(Object.keys(n||{}),t),a=0,o=i.length;a<o;a++)r&&!r(i[a])||(s=e,u=i[a],c=n[i[a]],s.properties||(s.properties={}),s.properties[u]=c,"stroke-dasharray"==u&&c&&(s.properties["stroke-linecap"]="butt"));var s,u,c}function mf(e){return e in lf}function yf(e,t){var n=hf[t]||{};return e.filter((function(e){return e in n}))}function vf(e,t){var n={},r=[];return e.data&&e.data.getFields(),Object.keys(t).forEach((function(i){var a=i.replace(/_/g,"-");if(a in df){var o=t[i];n[a]=xf(o,a,e),r.push(a)}})),function(e){for(var t,i={},a=0;a<r.length;a++)i[t=r[a]]=n[t](e);return i}}function bf(e,t){return(t=t||[]).indexOf(e.trim())>-1||/[(){}./*?:&|=[+-]/.test(e)}function xf(e,t,n){var r,i=String(e).trim(),a=df[t],o=n.data?n.data.getFields():[],s=null;return a&&-1===o.indexOf(i)&&(s=function(e,t){var n=null;return"number"==t?n=wf(e)?Number(e):null:"color"==t?n=Mf(e)?e:null:"classname"==t?n=_f(e)?e:null:"measure"==t?n=Af(e)?If(e):null:"dasharray"==t?n=/^[0-9]+( [0-9]+)*$/.test(e)?e:null:"pattern"==t?n=ef(e)?e:null:"boolean"==t&&(n=Sf(e)),n}(i,a)),null===s&&bf(i,o)&&(r=function(e,t){var n;try{(n=Gs(e,t,null,{no_warn:!0}))(0)}catch(e){n=null}return n}(i,n)),r||null!==s||a||(s=i),r||(null!==s?function(e){return s}:void dt("Unexpected value for",t+":",i))}function _f(e){return/^( ?[_a-z][-_a-z0-9]*\b)+$/i.test(e)}function wf(e){return t.isFiniteNumber(e)||t.isString(e)&&/^-?[.0-9]+$/.test(e)}function Sf(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&null}function Af(e){return t.isFiniteNumber(e)||t.isString(e)&&/^-?[.0-9]+[a-z]*$/.test(e)}function If(e){return t.isString(e)&&/[a-z]/.test(e)?e:Number(e)}function Mf(e){return/^[a-z]+$/i.test(e)||/^#[0-9a-f]+$/i.test(e)||/^rgba?\([0-9,. ]+\)$/.test(e)}var Pf=Object.freeze({__proto__:null,applyStyleAttributes:gf,isSupportedSvgStyleProperty:mf,findPropertiesBySymbolGeom:yf,getSymbolDataAccessor:vf,mightBeExpression:bf,getSymbolPropertyAccessor:xf,isSvgClassName:_f,isSvgNumber:wf,parseBoolean:Sf,isSvgMeasure:Af,parseSvgMeasure:If,isSvgColor:Mf}),Ef={Point:Of,Polygon:Lf,LineString:Nf,MultiPoint:function(e,t){for(var n,r=[],i=0;i<e.length;i++)(n=Of(e[i],t))&&("g"==n.tag&&n.children?r=r.concat(n.children):r.push(n));return r.length>0?{tag:"g",children:r}:null},MultiLineString:Cf,MultiPolygon:zf};function jf(e,t){return t=t||{},e.map((function(e){var n="Feature"==e.type?e.geometry:e,r=n&&n.type,i=mc.translateGeoJSONType(r),a=e.properties||{},o=null;return r&&n.coordinates&&(o=Ef[r](n.coordinates,a)),o?("polyline"==i||"polygon"==i?gf(o,i,a):"point"==i&&kf(a)&&gf(o,i,a,Ff),"id"in e&&(o.properties||(o.properties={}),o.properties.id=(t.id_prefix||"")+e.id),o):{tag:"g"}}))}function Of(e,t){if(kf(t=t||{}))return{tag:"circle",properties:{cx:e[0],cy:e[1],r:t.r}};var n=Vf(t);return n&&(n.properties.transform=qf(e)),n}function Ff(e){return"r"!=e}function kf(e){return e&&e.r>0&&!e["svg-symbol"]&&!e["label-text"]}function Nf(e){return{tag:"path",properties:{d:Zc(e)}}}function Cf(e){return{tag:"path",properties:{d:e.map(Zc).join(" ")}}}function zf(e){return Lf(Tf(e))}function Tf(e){return e.reduce((function(e,t){return e.concat(t)}),[])}function Lf(e){if(0===e.length)return null;var t={tag:"path",properties:{d:Qc(e)}};return e.length>1&&(t.properties["fill-rule"]="evenodd"),t}var Bf=Object.freeze({__proto__:null,importGeoJSONFeatures:jf,importPoint:Of,importLineString:Nf,importMultiLineString:Cf,importMultiPolygon:zf,flattenMultiPolygonCoords:Tf,importPolygon:Lf});function Df(e){var t=Rf(e);return gf(t,"label",e),t}function Rf(e){var t,n,r,i=(t=e["label-text"])||0===t||!1===t?String(t):"",a=/\n|\\n|<br>/i,o=e.dx||0,s={y:e.dy||0,x:o};return a.test(i)&&(n=i.split(a),i=n.shift()),r={tag:"text",value:i,properties:s},n&&(r.children=[],n.forEach((function(t){var n={tag:"tspan",value:t,properties:{x:o,dy:e["line-height"]||"1.1em"}};r.children.push(n)}))),r}var Uf=Object.freeze({__proto__:null,renderStyledLabel:Df,renderLabel:Rf});function qf(e,t){var n="translate("+Ro(e[0])+" "+Ro(e[1])+")";return t&&1!=t&&(n+=" scale("+t+")"),n}var Gf={line:function(e,t,n){var r;return gf(r=Nf([[t,n],[t+(e.dx||0),n+(e.dy||0)]]),"polyline",e),r},polygon:function(e){var t=Lf(e.coordinates||[]);return gf(t,"polygon",e),t},polyline:function(e){var t=Cf(e.coordinates||[]);return gf(t,"polyline",e),t},circle:Jf,square:function(e,t,n){var r=e.r||0,i={tag:"rect",properties:{x:t-r,y:n-r,width:2*r,height:2*r}};return gf(i,"point",e),i},image:function(e,t,n){var r=e.width||20,i=e.height||20;return{tag:"image",properties:{width:r,height:i,x:(t||0)-r/2,y:(n||0)-i/2,href:e.href||""}}},group:function(e,t,n){var r={tag:"g",children:[]},i=r.children;return(e.parts||[]).forEach((function(e){var r=$f(e,t,n);i.push(r),"line"==e.type&&(t+=e.dx||0,n+=e.dy||0),"offset"==e.type&&(i=r.children,t=n=0)})),1!=r.children.length||r.properties?r:r.children[0]},label:function(e,t,n){var r=Df(e);return(t||n)&&(r.properties.transform=qf([t,n])),r},offset:function(e,t,n){return{tag:"g",properties:{transform:qf([(t||0)+(e.dx||0),(n||0)+(e.dy||0)])},children:[]}}};function Vf(e){var t,n=[];ml(e)&&n.push((t=e)["svg-symbol"]?$f(t["svg-symbol"]):t.r>0?Jf(t):{tag:"g",properties:{},children:[]}),yl(e)&&n.push(Df(e));var r=n.length>1?{tag:"g",children:n}:n[0];return r?(r.properties=r.properties||{},r):null}function $f(e,n,r){if(t.isString(e)&&(e=JSON.parse(e)),e.tag)return e;var i=Gf[e.type];if(!i)return ht(e.type?"Unknown symbol type: "+e.type:"Symbol is missing a type property"),{tag:"g",properties:{},children:[]};var a=i(e,n||0,r||0);return e.opacity&&(a.properties.opacity=e.opacity),a}function Jf(e,t,n){var r={tag:"circle",properties:{cx:t||0,cy:n||0}};return gf(r,"point",e),r}var Yf=Object.freeze({__proto__:null,getTransform:qf,symbolRenderers:Gf,renderPoint:Vf});function Wf(e){var n=t.defaults({type:"scalebar"},e);return{name:e.name||"scalebar",data:new Vr([n])}}function Hf(e,t){var n=function(e){var t={valign:"top",halign:"left",voffs:10,hoffs:10};return+e.left>0&&(t.hoffs=+e.left),+e.top>0&&(t.voffs=+e.top),+e.right>0&&(t.hoffs=+e.right,t.halign="right"),+e.bottom>0&&(t.voffs=+e.bottom,t.valign="bottom"),t}(e),r=Gc(t),i=e.label_text||function(e,t){var n=70*t/1e3;return"1/8 1/5 1/4 1/2 1 2 3 4 5 8 10 15 20 25 30 40 50 75 100 150 200 250 300 350 400 500 750 1,000 1,500 2,000 2,500 3,000 4,000 5,000".split(" ").reduce((function(e,t){if(e)return e;var r=Xf(t);return Qf(r)>n?r:void 0}),null)||""}(t.width,r),a=Qf(i),o=+e.font_size||12,s=Math.round(a/r*1e3),u=Math.round(7+.8*o),c="top"==e.label_position?"top":"bottom",f="left"==n.halign?0:s,l=7,d="right"==n.halign?t.width-s-n.hoffs:n.hoffs,p="bottom"==n.valign?t.height-u-n.voffs:n.voffs;if(!t.crs)return ht("Unable to render a scalebar: unknown CRS."),[];"top"==c&&(l=-4,p+=Math.round(4+.8*o)),s>0==0&&dt("Null scalebar length");var h={tag:"rect",properties:{fill:"black",x:0,y:0,width:s,height:3}},g={"label-text":i,"font-size":o,"text-anchor":"left"==n.halign?"start":"end","dominant-baseline":"top"==c?"auto":"hanging"};return[{tag:"g",children:[h,Gf.label(g,f,l)],properties:{transform:"translate("+d+" "+p+")"}}]}function Xf(e){return e+(Zf(e)>1?" MILES":" MILE")}function Qf(e){var t=function(e){var t=/miles?$/.test(e.toLowerCase()),n=/(km|kilometers?|kilometres?)$/.test(e.toLowerCase());return(t?"mile":n&&"km")||""}(e),n=Zf(e);return t&&n?"mile"==t?1.60934*n:n:NaN}function Zf(e){var t,n,r=/^([0-9]+) ?\/ ?([0-9]+)/;return e=e.replace(/[\s]/g,"").replace(/,/g,""),(n=r.test(e)?+(t=r.exec(e))[1]/+t[2]:parseFloat(e))>0&&n<1/0?n:NaN}nu.scalebar=function(e,t){var n,r=qc(e);r||dt("Missing a map frame"),n=Wf(t),r.layers.push(n)},Fc.scalebar=Hf;var Kf=Object.freeze({__proto__:null,getScalebarLayer:Wf,renderScalebar:Hf,formatDistanceLabelAsMiles:Xf,parseScalebarLabelToKm:Qf});function el(e,t){var n=Lc(e,t);return tl(e,n,t),[n.width,n.height]}function tl(e,t,n){var r=new jt(t.bbox),i=new jt(0,0,t.width,t.height),a=r.getTransform(i,n.invert_y);Ja(e,(function(e,t){return a.transform(e,t)}))}var nl=Object.freeze({__proto__:null,transformDatasetToPixels:el,fitDatasetToFrame:tl});function rl(e){var t,n;return e&&e.tag?(t="<"+e.tag,e.properties&&(t+=sl(e.properties)),e.children||e.value?(t+=">"+(n="text"==e.tag||"tspan"==e.tag?"":"\n"),e.value&&(t+=ol(e.value)),e.children&&(t+=e.children.map(rl).join(n)),t+=n+"</"+e.tag+">"):t+="/>",t):""}var il=/[&<>"']/g,al={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};function ol(e){return String(e).replace(il,(function(t,n){var r=al[t];return"&"==t&&e.substr(n,r.length)==r?"&":r}))}function sl(e){return Object.keys(e).reduce((function(n,r){var i=e[r];return i||0===i?("href"==r&&(r="xlink:href"),"css"==r&&(r="style"),n+" "+r+'="'+ol(t.isString(i)?i:JSON.stringify(i))+'"'):n}),"")}var ul=Object.freeze({__proto__:null,stringify:rl,stringEscape:ol,stringifyProperties:sl}),cl={};function fl(e,n){var r,i,a,o='xmlns="http://www.w3.org/2000/svg"',s=[],u="";n.crisp_paths&&(u="\n<style>\n  path {shape-rendering: crispEdges;}\n</style>"),n.final?e.arcs&&e.arcs.flatten():e=za(e),t.extend(n,{invert_y:!0}),r=Lc(e,n),tl(e,r,n),Vo(e,n.precision||1e-4),n.svg_data&&pl(e.layers,n.svg_data),a=e.layers,n.scalebar&&a.push(Wf({})),i=a.map((function(i){var a;return function(e,n){!function e(r){"path"==r.tag&&r.properties["fill-pattern"]&&of(r.properties,n),"image"==r.tag?/\.svg/.test(r.properties.href||"")&&function(e,n){var r,i=e.properties.href,a=t.find(n,(function(e){return e.href==i}));a||((a={href:i,id:(r=i,function(e){for(var t,n,r,i,a,o,s,u=0,c=0,f=[],l=[t=1732584193,n=4023233417,~t,~n,3285377520],d=[],p=unescape(encodeURI(e)),h=p.length;c<=h;)d[c>>2]|=(p.charCodeAt(c)||128)<<8*(3-c++%4);for(d[s=h+8>>2|15]=h<<3;u<=s;u+=16){for(t=l,c=0;c<80;t=[0|[(o=((p=t[0])<<5|p>>>27)+t[4]+(f[c]=c<16?~~d[u+c]:o<<1|o>>>31)+1518500249)+((n=t[1])&(r=t[2])|~n&(i=t[3])),a=o+(n^r^i)+341275144,o+(n&r|n&i|r&i)+882459459,a+1535694389][0|c++/20],p,n<<30|n>>>2,r,i])o=f[c-3]^f[c-8]^f[c-14]^f[c-16];for(c=5;c;)l[--c]=l[c]+t[c]|0}for(e="";c<40;)e+=(l[c>>3]>>4*(7-c++%8)&15).toString(16);return e}(r).substr(0,12))}).svg=function(e,t){var n="";try{n=function(e,t){return(e=e.replace(/[^]*<svg/,"<svg")).replace(/^<svg[^>]*>/,(function(e){return(e=e.replace(/ id="[^"]*"/,"")).replace(/<svg/,'<svg id="'+t+'"')}))}(function(e){var t;return 0===e.indexOf("http")?t=function(e){if(e in cl)return cl[e];var t=lr("sync-request")("GET",e,{timeout:2e3}).getBody().toString();return cl[e]=t,t}(e):lr("fs").existsSync(e)?t=lr("fs").readFileSync(e,"utf8"):dt("Invalid SVG location:",e),t}(e),t)+"\n",n="\x3c!-- "+e+"--\x3e\n"+n}catch(e){}return n}(i,a.id),n.push(a)),a.svg&&(e.tag="use",e.properties.href="#"+a.id)}(r,n):r.children&&r.children.forEach(e)}(e)}(a=kc(i)?ll(i,r,n):dl(i,e,n),s),rl(a)})).join("\n"),s.length>0&&(i="<defs>\n"+t.pluck(s,"svg").join("")+"</defs>\n"+i),i.includes("xlink:")&&(o+=' xmlns:xlink="http://www.w3.org/1999/xlink"');var c=`stroke-linecap="${n.default_linecap||"round"}" stroke-linejoin="round"`;i.includes('stroke-linejoin="miter"')&&(c+=' stroke-miterlimit="2"');var f=`<?xml version="1.0"?>\n<svg ${o} version="1.2" baseProfile="tiny" width="%d" height="%d" viewBox="%s %s %s %s" ${c}>${u}\n${i}\n</svg>`;return[{content:i=t.format(f,r.width,r.height,0,0,r.width,r.height),filename:n.file||no(e)+".svg"}]}function ll(e,t,n){var r=gl(e,n);return r.children=zc(Cc(e),t),r}function dl(e,n,r){var i=gl(e,r);return i.children=function(e,n,r){var i=wc(t.defaults({layers:[e]},n),r),a=jf(i.features||i.geometries||(i.type?[i]:[]),r);return r.svg_data&&e.data&&function(e,n,r){var i=n.getFields(),a=r.indexOf("*")>-1?i.concat():r,o=t.difference(a,i);o.length>0&&(a=t.difference(a,o));var s=hl(n.getRecords(),a);e.length!=s.length&&lt("Mismatch between number of SVG symbols and data attributes"),e.forEach((function(e,n){t.extend(e.properties||{},s[n])}))}(a,e.data,r.svg_data),a}(e,n,r),i}function pl(e,n){var r=n.reduce((function(n,r){return function(e,n){return t.some(e,(function(e){return e.data&&e.data.fieldExists(n)||!1}))}(e,r)||n.push(r),n}),[]);r.length&&-1==r.indexOf("*")&&dt("Missing data field(s):",r.join(", "))}function hl(e,n){var r=/^[a-z_][a-z0-9_-]*$/i,i=/^xml/,a=n.filter((function(e){return r.test(e)&&!i.test(e)})),o=t.difference(n,a);return o.length>0&&(ht("Unable to add data-* attributes for field(s):",o.join(", ")),ht("data-* names should match pattern [a-z_][a-z0-9_-]*")),e.map((function(e){for(var t,n={},r=0;r<a.length;r++)n["data-"+a[r].toLowerCase()]=(t=e[a[r]],String(t));return n}))}function gl(e,n){var r={tag:"g",properties:{id:(n.id_prefix||"")+(e.name||t.getUniqueName("layer"))},children:[]};return("polyline"==e.geometry_type||vl(e))&&(r.properties.fill="none"),"polyline"==e.geometry_type&&(r.properties.stroke="black",r.properties["stroke-width"]=1),(bl(e)||vl(e)||kc(e))&&(r.properties["font-family"]="sans-serif",r.properties["font-size"]="12",r.properties["text-anchor"]="middle"),r}function ml(e){return!(!e||!e["svg-symbol"]&&!e.r)}function yl(e){var t=e&&e["label-text"];return t||0===t}function vl(e){return"point"==e.geometry_type&&e.data&&e.data.fieldExists("svg-symbol")}function bl(e){return"point"==e.geometry_type&&e.data&&e.data.fieldExists("label-text")}var xl=Object.freeze({__proto__:null,exportSVG:fl,exportFurnitureForSVG:ll,exportLayerForSVG:dl,validateSvgDataFields:pl,exportDataAttributesForSVG:hl,getEmptyLayerForSVG:gl,featureHasSvgSymbol:ml,featureHasLabel:yl,layerHasSvgSymbols:vl,layerHasLabels:bl});function _l(e,n){t.isNumber(e)?e=new ArrayBuffer(e):e instanceof ArrayBuffer||("function"==typeof u&&e instanceof u?e=_l.toArrayBuffer(e):lt("BinArray constructor takes an integer, ArrayBuffer or Buffer argument")),this._buffer=e,this._bytes=new Uint8Array(e),this._view=new DataView(e),this._idx=0,this._le=!1!==n}_l.bufferToUintArray=function(e,t){return 4==t?new Uint32Array(e):2==t?new Uint16Array(e):1==t?new Uint8Array(e):void lt("BinArray.bufferToUintArray() invalid word length:",t)},_l.uintSize=function(e){return 1&e||2&e||4},_l.bufferCopy=function(e,t,n,r,i){r=r||0,i=i||n.byteLength-r,e.byteLength-t<i&&lt("Buffer overflow; tried to write:",i);for(var a=Math.min(_l.uintSize(i),_l.uintSize(r),_l.uintSize(e.byteLength),_l.uintSize(t),_l.uintSize(n.byteLength)),o=_l.bufferToUintArray(n,a),s=_l.bufferToUintArray(e,a),u=i/a,c=r/a,f=t/a;u--;)s[f++]=o[c++];return i},_l.toArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e[i];return n},_l.bufferSize=function(e){return e instanceof ArrayBuffer?e.byteLength:0|e.length},_l.prototype={size:function(){return this._buffer.byteLength},littleEndian:function(){return this._le=!0,this},bigEndian:function(){return this._le=!1,this},buffer:function(){return this._buffer},bytesLeft:function(){return this._buffer.byteLength-this._idx},skipBytes:function(e){return this._idx+=e+0,this},readUint8:function(){return this._bytes[this._idx++]},writeUint8:function(e){return this._bytes[this._idx++]=e,this},readInt8:function(){return this._view.getInt8(this._idx++)},writeInt8:function(e){return this._view.setInt8(this._idx++,e),this},readUint16:function(){var e=this._view.getUint16(this._idx,this._le);return this._idx+=2,e},writeUint16:function(e){return this._view.setUint16(this._idx,e,this._le),this._idx+=2,this},readUint32:function(){var e=this._view.getUint32(this._idx,this._le);return this._idx+=4,e},writeUint32:function(e){return this._view.setUint32(this._idx,e,this._le),this._idx+=4,this},readInt32:function(){var e=this._view.getInt32(this._idx,this._le);return this._idx+=4,e},writeInt32:function(e){return this._view.setInt32(this._idx,e,this._le),this._idx+=4,this},readFloat64:function(){var e=this._view.getFloat64(this._idx,this._le);return this._idx+=8,e},writeFloat64:function(e){return this._view.setFloat64(this._idx,e,this._le),this._idx+=8,this},readFloat64Array:function(e){var t,n=8*e,r=this._idx,i=this._buffer;if(r%8==0)t=new Float64Array(i,r,e);else if(i.slice)t=new Float64Array(i.slice(r,r+n));else{var a=new ArrayBuffer(n);_l.bufferCopy(a,0,i,r,n),t=new Float64Array(a)}return this._idx+=n,t},readUint32Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.readUint32());return t},peek:function(e){return this._view.getUint8(e>=0?e:this._idx)},position:function(e){return null!=e?(this._idx=e,this):this._idx},readCString:function(e,t){for(var n="",r=e>=0?e:this.bytesLeft();r>0;){var i=this.readUint8();if(r--,0==i)break;if(i>127&&t){n=null;break}n+=String.fromCharCode(i)}return e>0&&r>0&&this.skipBytes(r),n},writeString:function(e,t){var n,r=0,i=e.length;t&&(i=Math.min(i,t));for(var a=0;a<i;a++)(n=e.charCodeAt(a))>127&&(n="?".charCodeAt(0)),this.writeUint8(n),r++;return r},writeCString:function(e,t){var n=t?t-1:null,r=this.writeString(e,n);if(this.writeUint8(0),r++,t)for(;r<t;)this.writeUint8(0),r++;return this},writeBuffer:function(e,t,n){return this._idx+=_l.bufferCopy(this._buffer,this._idx,e,n,t),this}};var wl=Object.freeze({__proto__:null,buffersAreIdentical:function(e,t){var n=_l.bufferSize(e);if(n!=_l.bufferSize(t))return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0},BinArray:_l}),Sl={},Al=254;Sl.MAX_STRING_LEN=Al,Sl.convertValueToString=Ml,Sl.convertFieldNames=Pl,Sl.discoverFieldType=Ol,Sl.getDecimalFormatter=Fl,Sl.getNumericFieldInfo=kl,Sl.truncateEncodedString=Cl,Sl.getFieldInfo=jl,Sl.exportRecords=function(e,n,r){var i,a=e.length,o=qr(e,r),s=n||"utf8",u=yr(o.join(""))?"ascii":s,c=function(e,n){return e.map((function(e){for(var r=wr(e,n),i=r.length,a=t.createBuffer(11),o=0;o<11;o++)a[o]=o<10&&i>=o-1?r[o]:0;return a}))}(Pl(o,u),u),f=o.map((function(t,n){var r=jl(e,t,s);return r.warning&&ht("["+t+"] "+r.warning),r})),l=33+32*f.length,d=(i=t.pluck(f,"size"),t.sum(i)+1),p=l+a*d+1,h=new ArrayBuffer(p),g=new _l(h).littleEndian(),m=new Date;return g.writeUint8(3),g.writeUint8(m.getFullYear()-1900),g.writeUint8(m.getMonth()+1),g.writeUint8(m.getDate()),g.writeUint32(a),g.writeUint16(l),g.writeUint16(d),g.skipBytes(17),g.writeUint8(0),g.skipBytes(2),f.reduce((function(e,t,n){return g.writeBuffer(c[n],11,0),g.writeUint8(t.type.charCodeAt(0)),g.writeUint32(e),g.writeUint8(t.size),g.writeUint8(t.decimals),g.skipBytes(14),e+t.size}),1),g.writeUint8(13),g.position()!=l&&lt("Dbf#exportRecords() header size mismatch; expected:",l,"written:",g.position()),e.forEach((function(e,t){var n=g.position();g.writeUint8(32);for(var r=0,i=f.length;r<i;r++)f[r].write(t,g);g.position()-n!=d&&lt("#exportRecords() Error exporting record:",e)})),g.writeUint8(26),g.position()!=p&&lt("Dbf#exportRecords() file size mismatch; expected:",p,"written:",g.position()),h};var Il=new function(){var e,t;function n(){e=new Uint8Array(5e3),t=0}return n(),{reserve:function(r){return t+r>5e3&&n(),t+=r,e.subarray(t-r,t)},putBack:function(e){t-=e}}};function Ml(e){return null==e?"":String(e)}function Pl(e,t){var n=zr(e.map(El),10,t);return n.forEach((function(t,n){e[n]!=t&&ht('Changed field name from "'+e[n]+'" to "'+t+'"')})),n}function El(e){return e.replace(/[-\s]+/g,"_")}function jl(e,n,r){var i=Ol(e,n),a={type:i,decimals:0};return"N"==i?function(e,n,r){var i,a;i=kl(n,r),e.decimals=i.decimals,(a=Math.max(i.max.toFixed(e.decimals).length,i.min.toFixed(e.decimals).length))>18&&(a=18,e.decimals-=a-18,e.decimals<0&&lt("Dbf#getFieldInfo() Out-of-range error.")),e.size=a;var o=Fl(a,e.decimals);e.write=function(e,i){var s=n[e],u=o(s[r]);u.length<a&&(u=t.lpad(u,a," ")),i.writeString(u,a)}}(a,e,n):"C"==i?function(e,t,n,r){var i="ascii"==r?Nl:function(e){return function(t){var n=Nl(t,!0);return null===n&&(n=wr(String(t),e)),n}}(r),a=1,o=0,s=t.map((function(e){var t=Ml(e[n]),s=i(t);return s.length>Al&&(s="ascii"==r?s.subarray(0,Al):Cl(s,r,Al),o++),a=Math.max(a,s.length),s}));e.size=a,e.write=function(e,t){var n,r=s[e],i=Math.min(a,r.length),o=t._bytes,u=t.position();for(n=0;n<i;n++)o[n+u]=r[n];t.position(u+a)},o>0&&(e.warning="Truncated "+o+" string"+(1==o?"":"s")+" to fit the 254-byte limit")}(a,e,n,r):"L"==i?function(e,t,n){e.size=1,e.write=function(e,r){var i,a=t[e][n];i=!0===a?"T":!1===a?"F":"?",r.writeString(i)}}(a,e,n):"D"==i?function(e,n,r){e.size=8,e.write=function(e,i){var a,o=n[e][r];a=o instanceof Date==0?"00000000":t.lpad(o.getUTCFullYear(),4,"0")+t.lpad(o.getUTCMonth()+1,2,"0")+t.lpad(o.getUTCDate(),2,"0"),i.writeString(a)}}(a,e,n):(a.size=0,a.type="N",i&&(a.warning="Unable to export "+i+"-type data, writing null values"),a.write=function(){}),a}function Ol(e,n){for(var r,i=0,a=e.length;i<a;i++){if(r=e[i][n],t.isString(r))return"C";if(t.isNumber(r))return"N";if(t.isBoolean(r))return"L";if(r instanceof Date)return"D";if(r)return typeof r}return null}function Fl(e,n){return function(r){var i=t.isFiniteNumber(r)?r.toFixed(n):String(" ");return t.lpad(i,e," ")}}function kl(e,n){for(var r,i=0,a=0,o=1,s=1,u=0,c=1e-15,f=0,l=e.length;f<l;f++)if(r=e[f][n],t.isFiniteNumber(r)){if(r<i||r>a)for(r<i&&(i=r),r>a&&(a=r);Math.abs(r)>=s;)s*=10,c*=10;for(;Math.abs(Math.round(r*o)-r*o)>c&&15!=u;)u++,c*=10,o*=10}return{decimals:u,min:i,max:a}}function Nl(e,t){var n,r,i=String(e),a=i.length,o=Il.reserve(a);for(n=0;n<a;n++){if((r=i.charCodeAt(n))>127){if(t){o=null,n=0;break}r="?".charCodeAt(0)}o[n]=r}return Il.putBack(a-n),o?o.subarray(0,n):null}function Cl(e,t,n){for(var r,i,a=e.slice(0,n),o=n;o>0&&o>=n-3;){if("�"!=(i=Sr(r=o==n?a:e.slice(0,o),t)).charAt(i.length-1)){a=r;break}o--}return a}function zl(e,n,r){var i,a=e.data;return(!a||r.cut_table||r.drop_table)&&(a=new Vr(e.shapes?e.shapes.length:0)),a.isEmpty()&&a.addIdField(),i=a.exportAsDbf?a.exportAsDbf(r):Sl.exportRecords(a.getRecords(),r.encoding,r.field_order),t.isInteger(r.ldid)&&(new Uint8Array(i)[29]=r.ldid),[{content:i,filename:e.name+".dbf"}]}function Tl(e,t,n){var r,i,a=[],o=e.length,s=t.length;for(a.push(e),r=0;r<s;r++)i=Ll(t[r][e],n),o=Math.max(o,i.length),a.push(i);for(r=0;r<a.length;r++)a[r]=a[r].padEnd(o," ");return a}function Ll(e,n){return null==e?"":t.isString(e)?e:t.isNumber(e)?n.decimal_comma?t.formatIntlNumber(e):t.formatNumber(e):t.isObject(e)?JSON.stringify(e):e+""}function Bl(e){var n=function(e){var n=t.splitLines(e);n.length>2&&n.pop();for(var r,i,a,o,s=function(e){for(var t=0,n=0;n<e.length;n++)t=Math.max(t,e[n].length);return t}(n),u=n[0],c=[],f=0,l=!1,d=!1,p=0;p<=s;p++){if(i=Ul(u,p),r=!ql(n,p),(a=i&&!d)&&l)return null;(p==s||p>0&&a)&&(o=p==s?void 0:p-1,c.push({name:Dl(u,f,o),end:o,start:f}),f=p),l=r,d=i}return c.length>0?c:null}(e.substring(0,2e3));if(!n)return[];var r=t.splitLines(e);""===r[r.length-1]&&r.pop();for(var i=[],a=1;a<r.length;a++)i.push(Rl(r[a],n));return i}function Dl(e,t,n){return e.substring(t,n).trim()}function Rl(e,t){for(var n,r={},i=0;i<t.length;i++)r[(n=t[i]).name]=Dl(e,n.start,n.end);return r}function Ul(e,t){return t<e.length&&" "!==e[t]}function ql(e,t){for(var n=0;n<e.length;n++)if(Ul(e[n],t))return!1;return!0}function Gl(e,t){var n=function(e,t){var n=",",r=t.file?Za(t.file):"";return t.delimiter?n=t.delimiter:"tsv"==r?n="\t":"csv"==r?n=",":e.input_delimiter&&(n=e.input_delimiter),n}(e.info,t),r=function(e,t){var n="txt";return t.file?n=Za(t.file):"\t"==e?n="tsv":","==e&&(n="csv"),n}(n,t);return e.layers.reduce((function(e,i){return i.data&&e.push({content:Vl(i,n,t),filename:(i.name||"output")+"."+r}),e}),[])}function Vl(e,t,n){var r=n||{},i=r.encoding||"utf8",a=e.data.getRecords(),o=qr(a,r.field_order);if(" "==t)return function(e,t,n){for(var r,i=[],a=0;a<e.length;a++)if(r=Tl(e[a],t,n),0===a)i=r;else for(var o=0;o<i.length;o++)i[o]+=" "+r[o];return i.join("\n")}(o,a,r);var s=function(e,t,n){var r=Jl(t,n);return function(n){return e.map((function(e){return r(n[e])})).join(t)}}(o,t,r);return vr(i)&&!r.to_buffer&&(a.length<1e4||r.to_string)?function(e,t,n){var r=$l(e,n);return t.length?r+"\n"+t.map(n).join("\n"):r}(o,a,s):function(e,t,n,r){for(var i=$l(e,n),a=[wr(i,r)],o=[],s=t.length,c=0;c<s;)o.push(n(t[c])),++c%1e3!=0&&c!=s||(i="\n"+o.join("\n"),o=[],a.push(wr(i,r)));return u.concat(a)}(o,a,s,i)}function $l(e,t){return t(e.reduce((function(e,t){return e[t]=t,e}),{}))}function Jl(e,n){var r=new RegExp('["\n\r'+e+"]"),i=n&&n.decimal_comma||!1;function a(e){return r.test(e)&&(e='"'+e.replace(/"/g,'""')+'"'),e}return function(e){return null==e?"":t.isString(e)?a(e):t.isNumber(e)?i?t.formatIntlNumber(e):t.formatNumber(e):t.isObject(e)?a(JSON.stringify(e)):e+""}}var Yl=Object.freeze({__proto__:null,exportDelim:Gl,exportLayerAsDSV:Vl,getDelimValueFormatter:Jl}),Wl={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULIPOINTM:28,MULTIPATCH:31};function Hl(e,n){return e.layers.reduce((function(r,i){var a=function(e,t){var n=(t.info||{}).prj;if(!n)try{n=Ri(Wi(t))}catch(e){}return n||ht("Unable to generate .prj file for",e.name+".shp"),n?{content:n,filename:e.name+".prj"}:null}(i,e);return r=r.concat(function(e,n,r){var i,a=e.shapes||t.initializeArray(new Array(Kr(e)),null),o=new jt,s=function(e){var t=e.geometry_type;return"point"==t?sr(e.shapes||[])<=1?Wl.POINT:Wl.MULTIPOINT:"polygon"==t?Wl.POLYGON:"polyline"==t?Wl.POLYLINE:Wl.NULL}(e),u=100,c=100+8*a.length,f=new _l(c).bigEndian().position(100),l=a.map((function(t,r){var i=function(e,t,n){var r=Wl.isMultiPartType(n),i=!r&&!Wl.isMultiPointType(n),a=e.pointCount>0==0,o=a?null:e.bounds,s=null;if(a)s=new _l(12,!1).writeInt32(t).writeInt32(2).littleEndian().writeInt32(0);else if(i)s=new _l(28,!1).writeInt32(t).writeInt32(10).littleEndian().writeInt32(n).writeFloat64(e.pathData[0].points[0][0]).writeFloat64(e.pathData[0].points[0][1]);else{var u=r?52+4*e.pathCount:48,c=u+16*e.pointCount,f=0;s=new _l(c,!1).writeInt32(t).writeInt32((c-8)/2).littleEndian().writeInt32(n).writeFloat64(o.xmin).writeFloat64(o.ymin).writeFloat64(o.xmax).writeFloat64(o.ymax),r&&s.writeInt32(e.pathCount),s.writeInt32(e.pointCount),e.pathData.forEach((function(e,t){r&&s.position(52+4*t).writeInt32(f),s.position(u+16*f);for(var n=0,i=e.points.length;n<i;n++)s.writeFloat64(e.points[n][0]),s.writeFloat64(e.points[n][1]);f+=n})),e.pointCount!=f&&lt("Shp record point count mismatch; pointCount:",f,"data.pointCount:",e.pointCount)}return{bounds:o,buffer:s.buffer()}}(xo(t,n.arcs,e.geometry_type),r+1,s),a=i.buffer.byteLength;return f.writeInt32(u/2),f.writeInt32(a/2-4),u+=a,i.bounds&&o.mergeBounds(i.bounds),i.buffer}));return i=new _l(u,!1).writeInt32(9994).skipBytes(20).writeInt32(u/2).littleEndian().writeInt32(1e3).writeInt32(s),o.hasBounds()?i.writeFloat64(o.xmin||0).writeFloat64(o.ymin||0).writeFloat64(o.xmax||0).writeFloat64(o.ymax||0):i.skipBytes(32),i.skipBytes(32),l.forEach((function(e){i.writeBuffer(e)})),f.position(0).writeBuffer(i.buffer(),100).position(24).writeInt32(c/2),[{content:i.buffer(),filename:e.name+".shp"},{content:f.buffer(),filename:e.name+".shx"}]}(i,e)),r=r.concat(zl(i,0,n)),a&&r.push(a),r}),[])}Wl.isPolygonType=function(e){return 5==e||15==e||25==e},Wl.isPolylineType=function(e){return 3==e||13==e||23==e},Wl.isMultiPartType=function(e){return Wl.isPolygonType(e)||Wl.isPolylineType(e)},Wl.isMultiPointType=function(e){return 8==e||18==e||28==e},Wl.isZType=function(e){return[11,13,15,18].includes(e)},Wl.isMType=function(e){return Wl.isZType(e)||[21,23,25,28].includes(e)},Wl.hasBounds=function(e){return Wl.isMultiPartType(e)||Wl.isMultiPointType(e)};var Xl=Object.freeze({__proto__:null,exportShapefile:Hl}),Ql={};function Zl(e){var t=1e4/e;return function(e){return e===1/0?0:Math.ceil(e*t)}}function Kl(e,t,n){return vo(er(e,t,"polygon"),t,n).map((function(e){return e.map((function(e){return e.ids}))}))}Ql.forEachShapePart=function(e,t){var n={GeometryCollection:function(e){e.geometries.forEach(r)},LineString:function(e){var n=t(e.arcs);n&&(e.arcs=n)},MultiLineString:function(e){i(e.arcs)},Polygon:function(e){i(e.arcs)},MultiPolygon:function(e){e.arcs.forEach(i)}};function r(e){e.type in n&&n[e.type](e)}function i(e){for(var n,r=0;r<e.length;r++)(n=t(e[r]))&&(e[r]=n)}r(e)},Ql.forEachArc=function(e,n){Ql.forEachShapePart(e,(function(e){for(var r,i=0;i<e.length;i++)r=n(e[i]),t.isInteger(r)&&(e[i]=r)}))},nu.explodeFeatures=function(e,n,r){var i,a,o,s=e.data?e.data.getRecords():null,u=s?[]:null,c=[],f=t.extend({},e);return e.shapes.forEach((function(i,a){var o,f;if(i?(o="polygon"==e.geometry_type&&i.length>1?r&&r.naive?function(e,t){return er(e,t,"polygon").map((function(e){return e.area<0&&$n(e.ids),[e.ids]}))}(i,n):Kl(i,n):function(e){return e.map((function(e){return[e.concat()]}))}(i),t.merge(c,o)):c.push(null),null!==u)for(var l=0,d=o?o.length:1;l<d;l++)u.push((f=s[a],Object.assign({},f)))})),f.shapes=c,null!==u&&(f.data=new Vr(u)),i=f,a=Kr(e),o=Kr(i),ht(t.format("Exploded %,d feature%s into %,d feature%s",a,t.pluralSuffix(a),o,t.pluralSuffix(o))),f};var ed=Object.freeze({__proto__:null,explodePolygon:Kl});function td(e,n){var r="."+(n.extension||"json"),i=!n.final||Ra(e)&&e.arcs.getRetainedInterval()>0,a=JSON.stringify;return i&&(e=Ta(e)),n.prettify&&(a=So("coordinates,arcs,bbox,translate,scale".split(","))),n.width>0||n.height>0?el(e,n=t.defaults({invert_y:!0},n)):n.fit_bbox&&el(e,{fit_bbox:n.fit_bbox}),n.precision&&Vo(e,n.precision),n.singles?Na(e).map((function(e){return{content:a(Ql.exportTopology(e,n)),filename:(e.layers[0].name||"output")+r}})):[{filename:n.file||no(e)+r,content:a(Ql.exportTopology(e,n))}]}Ql.getPresimplifyFunction=Zl,Ql.exportTopology=function(e,t){var n={type:"Topology",arcs:[]},r=Ra(e),i=Ba(e);return t.bbox&&i.hasBounds()&&(n.bbox=i.toArray()),r&&t.presimplify&&!e.arcs.getVertexData().zz&&nu.simplify(e,t),t.no_quantization||!t.quantization&&!r||(n.transform=Ql.transformDataset(e,i,t)),r&&(Oa(e),n.arcs=Ql.exportArcs(e.arcs,i,t),n.transform&&Ql.deltaEncodeArcs(n.arcs)),n.objects=e.layers.reduce((function(n,r,i){return n[r.name||"layer"+(i+1)]=Ql.exportLayer(r,e.arcs,t),n}),{}),t.metadata&&(n.metadata=function(e){var t=Wi(e),n=null;return t&&(n=Di(t)),{proj4:n}}(e)),n},Ql.transformDataset=function(e,t,n){var r=Ql.calcExportBounds(t,e.arcs,n),i=t.getTransform(r),a=i.invert();function o(e,t){var n=i.transform(e,t);return[Math.round(n[0]),Math.round(n[1])]}return e.arcs&&e.arcs.transformPoints(o),n.no_point_quantization||e.layers.filter(Xr).forEach((function(e){Zr(e,o)})),{scale:[a.mx,a.my],translate:[a.bx,a.by]}},Ql.exportArcs=function(e,t,n){var r=null,i=[];return n.presimplify&&(r=Zl(t.width())),e.forEach2((function(e,t,n,a,o){for(var s,u=[],c=e+t;e<c;e++)s=[n[e],a[e]],r&&s.push(r(o[e])),u.push(s);i.push(u.length>1?u:null)})),i},Ql.deltaEncodeArcs=function(e){e.forEach((function(e){for(var t,n,r,i,a,o=0,s=e.length;o<s;o++)r=(a=e[o])[0],i=a[1],o>0&&(a[0]=r-t,a[1]=i-n),t=r,n=i}))},Ql.calcExportResolution=function(e,t){var n=Un(e);return[n[0]*t,n[1]*t]},Ql.calcExportBounds=function(e,t,n){var r;return r=n.topojson_precision>0?Ql.calcExportResolution(t,n.topojson_precision):n.quantization>0?[e.width()/(n.quantization-1),e.height()/(n.quantization-1)]:n.precision>0?[n.precision,n.precision]:Ql.calcExportResolution(t,.02),new jt(0,0,Math.ceil(e.width()/r[0])||0,Math.ceil(e.height()/r[1])||0)},Ql.exportProperties=function(e,t,n){var r=Pc(t,n),i=jc(t,n);e.forEach((function(e,t){r&&(e.properties=r[t]),i&&(e.id=i[t])}))},Ql.exportLayer=function(e,t,n){for(var r,i=Kr(e),a=[],o=Ql.exporters[e.geometry_type]||null,s=0;s<i;s++)r=o&&e.shapes[s],a[s]=r?o(r,t,n):{type:null};return e.data&&Ql.exportProperties(a,e.data,n),{type:"GeometryCollection",geometries:a}},Ql.exportPolygonGeom=function(e,t,n){var r={};return(e=Kn(e,t))&&0!==e.length?e.length>1?(r.arcs=Kl(e,t,n.invert_y),1==r.arcs.length?(r.arcs=r.arcs[0],r.type="Polygon"):r.type="MultiPolygon"):(r.arcs=e,r.type="Polygon"):r.type=null,r},Ql.exportLineGeom=function(e,t){var n={};return(e=Kn(e,t))&&0!==e.length?1==e.length?(n.type="LineString",n.arcs=e[0]):(n.type="MultiLineString",n.arcs=e):n.type=null,n},Ql.exporters={polygon:Ql.exportPolygonGeom,polyline:Ql.exportLineGeom,point:mc.exportPointGeom};var nd=Object.freeze({__proto__:null,exportTopoJSON:td});function rd(e){return Or(e),{layers:[{data:new Vr(e)}],info:{}}}function id(e,t){return e.layers.reduce((function(e,n){return n.data&&e.push({content:ad(n,t),filename:(n.name||"output")+".json"}),e}),[])}function ad(e,t){t=t||{};var n=e.data.getRecords();return t.ndjson?n.map(wo).join("\n"):t.prettify?So([])(n):JSON.stringify(n)}var od=Object.freeze({__proto__:null,importJSONTable:rd,exportJSON:id,exportJSONTable:ad});function sd(e){var t=Za(e||"").toLowerCase(),n=null;return"dbf"==t||"shp"==t||"prj"==t||"shx"==t||"kml"==t||"cpg"==t?n=t:/json$/.test(t)?n="json":"csv"!=t&&"tsv"!=t&&"txt"!=t&&"tab"!=t||(n="text"),n}function ud(e){var n=null;return t.isString(e)?n=(fd(e)?"json":ld(e)&&"kml")||"text":(t.isObject(e)&&e.type||t.isArray(e))&&(n="json"),n}function cd(e,t){return sd(e)||ud(t)}function fd(e){return/^\s*[{[]/.test(String(e))}function ld(e){return(e=String(e)).includes("<kml ")&&e.includes('xmlns="http://www.opengis.net/kml/')}function dd(e){var t=Za(e).toLowerCase();return/csv|tsv|txt$/.test(t)}function pd(e){return["geojson","topojson","json","dsv","dbf","shapefile","svg"].indexOf(e)>-1}function hd(e){var t=Za(e).toLowerCase();return"shp"==t||"shx"==t||"dbf"==t}function gd(e){return/\.(shx|prj|xls|xlsx|gdb|sbn|sbx|xml|kml)$/i.test(e)}var md=Object.freeze({__proto__:null,guessInputFileType:sd,guessInputContentType:ud,guessInputType:cd,stringLooksLikeJSON:fd,stringLooksLikeKML:ld,couldBeDsvFile:dd,isZipFile:function(e){return/\.zip$/i.test(e)},isSupportedOutputFormat:pd,getFormatName:function(e){return{geojson:"GeoJSON",topojson:"TopoJSON",json:"JSON records",dsv:"CSV",dbf:"DBF",shapefile:"Shapefile",svg:"SVG"}[e]||""},isSupportedBinaryInputType:hd,filenameIsUnsupportedOutputType:gd});function yd(e,t){var n=t.file||null,r=e.info&&e.info.input_formats&&e.info.input_formats[0],i=null;return t.format?t.format:(n?i=vd(n,r):r&&(i=r),"json"==i&&Da(e)&&(i="geojson"),i||null)}function vd(e,t){var n=Za(e).toLowerCase(),r=null;return"shp"==n?r="shapefile":"dbf"==n?r="dbf":"svg"==n?r="svg":/json$/.test(n)?(r="geojson","topojson"==n||"topojson"==t&&"geojson"!=n?r="topojson":"json"==n&&"json"==t&&(r="json")):dd(e)?r="dsv":t&&(r=t),r}var bd=Object.freeze({__proto__:null,getOutputFormat:yd,inferOutputFormat:vd});function xd(e,n){return function(e,n){var r,i=yd(e[0],n);return"svg"==i||"topojson"==i||"geojson"==i&&n.combine_layers?e.length>1&&(e=[_a(e)],"topojson"==i&&ya(e[0]),n=t.defaults({final:!0},n)):function(e){Sd(e.reduce((function(e,t){return e.concat(t.layers)}),[]))}(e=e.map(La)),Ad(r=e.reduce((function(e,r){return Wa()?t.sortOn(r.layers,"stack_id",!0):t.sortOn(r.layers,"target_id",!0),e.concat(_d(r,n))}),[])),r}(e.map((function(e){return t.defaults({layers:e.layers},e.dataset)})),n)}function _d(e,n){var r,i,a=n.format=yd(e,n),o=wd[a],s=[];return a?o||lt("Unknown output format:",a):lt("Missing output format"),e=t.defaults({layers:e.layers.map((function(e){return t.extend({},e)}))},e),n.file&&"topojson"!=a&&"svg"!=a&&e.layers.forEach((function(e){e.name=Qa(n.file)})),Sd(e.layers),n.precision&&"svg"!=a&&"geojson"!=a&&"topojson"!=a&&Vo(e=Ta(e),n.precision),n.cut_table&&(s=(r=e.layers,i=[],r.forEach((function(e){e.data&&i.push({content:JSON.stringify(e.data),filename:(e.name?e.name+"-":"")+"table.json"})})),i).concat(s)),n.extension&&(n.extension=n.extension.replace(/^\.+/,"")),function(e){e.forEach((function(e){e.geometry_type?(t.contains(["polygon","polyline","point"],e.geometry_type)||lt("A layer has an invalid geometry type:",e.geometry_type),e.shapes||lt("A layer is missing shape data")):e.shapes&&t.some(e.shapes,(function(e){return!!e}))&&lt("A layer contains shape records and a null geometry type")}))}(e.layers),s=o(e,n).concat(s),n.bbox_index&&s.push(function(e){var t=e.layers.map((function(t){return{bbox:yi(t,e.arcs).toArray(),name:t.name}}));return{content:JSON.stringify(t),filename:"bbox-index.json"}}(e)),function(e){var t={};e.forEach((function(e,n){var r=e.filename;r||lt("Missing a filename for file"+n),r in t&&lt("Duplicate filename",r),t[r]=!0}))}(s),s}var wd={geojson:yc,topojson:td,shapefile:Hl,dsv:Gl,dbf:function(e,t){return e.layers.reduce((function(e,n){return n.data&&(e=e.concat(zl(n,0,t))),e}),[])},json:id,svg:fl};function Sd(e){var n=e.map((function(e){return e.name||"layer"})),r=t.uniqifyNames(n);e.forEach((function(e,t){e.name=r[t]}))}function Ad(e){var n=e.map((function(e){return e.filename})),r=t.uniqifyNames(n,Id);e.forEach((function(e,t){e.filename=r[t]}))}function Id(e,n){var r,i,a=e.split(".");return a.length<2?t.formatVersionedName(e,n):(r=a.pop(),i=a.join("."),t.formatVersionedName(i,n)+"."+r)}var Md=Object.freeze({__proto__:null,exportTargetLayers:xd,exportFileContent:_d,assignUniqueLayerNames:Sd,assignUniqueFileNames:Ad,formatVersionedFileName:Id});function Pd(e,t){return _r(e.readSync(0,Math.min(t||1e3,e.size())))}function Ed(e){var t=0;this.position=function(){return t},this.remaining=function(){return Math.max(e.size()-t,0)},this.advance=function(e){t+=e},this.readSync=function(){return e.readSync(t)},this.expandBuffer=function(){e.expandBuffer()}}function jd(e){var n,r,i=e.byteLength||e.length;function a(){return r||(r=e instanceof ArrayBuffer?t.createBuffer(e):e),r}this.readToBinArray=function(t,r){return i<t+r&&lt("Out-of-range error"),n||(n=new _l(e)),n.position(t),n},this.toString=function(e){return _r(a(),e)},this.readSync=function(e,t){return a().slice(e,t?e+t:i)},this.findString=Od.prototype.findString,this.expandBuffer=function(){return this},this.size=function(){return i},this.close=function(){}}function Od(e,n){var r,i,o,s,u=lr("fs"),c=u.statSync(e).size,f=n&&n.cacheSize||16777216,l=n&&n.bufferSize||262144;function d(n,a){var s,l,d=c-n;return(d<a||d<0)&&lt("Tried to read past end-of-file"),!(o&&n>=i&&i+o.length>=n+a||(d<(l=Math.max(f,a))&&(l=d),o&&l==o.length||(o=t.createBuffer(l)),r||(r=u.openSync(e,"r")),s=u.readSync(r,o,0,l,n),i=n,s!=l&&lt("Error reading file"),0))}(a("input_files")||[]).push(e),this.expandBuffer=function(){return 2*(l*=2)>f&&(f=2*l),this},this.readToBinArray=function(e,t){return d(e,t)&&(s=new _l(o)),s.position(e-i),s},this.readSync=function(e,n){return n>0==0&&(n=l),e+n>c&&(n=c-e),0===n?t.createBuffer(0):(d(e,n),o.slice(e-i,e-i+n))},this.size=function(){return c},this.toString=function(t){return io.readFile(e,t||"utf8")},this.close=function(){r&&(u.closeSync(r),r=null,o=null)}}Od.prototype.findString=function(e,t){var n,r=Math.min(this.size(),t||this.size()),i=this.readSync(0,r),a=e.length,o=i.length-a,s=e.charCodeAt(0);for(n=0;n<o;n++)if(i[n]==s&&i.toString("utf8",n,n+a)==e)return{offset:n+a,text:i.toString("utf8",0,n)};return null};var Fd=Object.freeze({__proto__:null,readFirstChars:Pd,Reader2:Ed,BufferReader:jd,FileReader:Od});function kd(e,t,n){var r=n||{};if(" "==t)return function(e,t){return Bl(e.toString(t.encoding||"ascii"))}(e,r);var i,a,o=new Ed(e),s=Td(Bd(o,function(e){var t=e.csv_skip_lines||0;return e.csv_field_names||t++,t}(r),r.encoding),t,r),u=zd(s.import_fields),c=r.batch_size||1e3,f=[];if(0===s.import_fields.length)return[];for(;i=Bd(o,c,r.encoding);)if(a=Dd(i,t,u,s.column_filter||!1,s.row_filter||!1),f.push.apply(f,a),r.csv_lines&&f.length>=r.csv_lines)return f.slice(0,r.csv_lines);return f}function Nd(e,t,n){if(" "==t)return Bl(e);var r=Td(e,t,n);if(0===r.import_fields.length||!r.remainder)return[];var i=zd(r.import_fields),a=Dd(r.remainder,t,i,r.column_filter,r.row_filter);return n.csv_lines>0&&(a=a.slice(0,n.csv_lines)),a}function Cd(e,t){var n=/\r\n|[\r\n]|.$/g,r=1;if(1===t)return 0;if(t>1==0)return-1;for(;n.exec(e);)if(++r<t==0)return n.lastIndex;return-1}function zd(e){return new Function("arr","return {"+e.map((function(e,t){return JSON.stringify(e)+": arr["+t+'] || ""'})).join(",")+"}")}function Td(e,n,r){var i,a,o,s,u={headers:[],import_fields:[]},c={};if(e=e||"",r.csv_skip_lines>0){if(-1===(i=Cd(e,r.csv_skip_lines+1)))return u;e=e.substr(i)}if(r.csv_field_names)c.headers=r.csv_field_names;else{if(-1===(i=Cd(e,2)))return u;c.headers=Dd(e.slice(0,i),n)[0],e=e.substr(i)}return r.csv_dedup_fields&&(c.headers=t.uniqifyNames(c.headers)),r.csv_filter&&(c.row_filter=(a=r.csv_filter,o=Ws(a,{returns:!0}),s=Qs(),function(e){var t;try{t=o.call(null,e,s)}catch(e){dt(e.name,"in expression ["+a+"]:",e.message)}return!0!==t&&!1!==t&&dt("Filter expression must return true or false"),t})),r.csv_fields?(c.column_filter=Ld(c.headers,r.csv_fields),c.import_fields=c.headers.filter((function(e,t){return c.column_filter(t)}))):c.import_fields=c.headers,c.remainder=e,c}function Ld(e,n){var r=t.arrayToIndex(n),i=e.map((function(e){return e in r})),a=t.difference(n,e);if(a.length>0){var o=[""].concat(e).join("\n  "),s=[""].concat(a).join("\n  ");dt("csv-fields option has",1==a.length?"a name":a.length+" names","not found in the file\nFields:",o,"\nMissing:",s)}return function(e){return i[e]}}function Bd(e,t,n){var r,i=e.readSync(),a=function(e,t){var n,r,i=!1,a=0,o=e.length;for(a++,n=0;n<o&&a<=t;n++)34==(r=e[n])?i=!i:13!=r&&10!=r||i||(13==r&&n+1<o&&10==e[n+1]&&n++,a++);return{bytesRead:n,buffer:e.slice(0,n)}}(i,t);return a.bytesRead==i.length&&a.bytesRead<e.remaining()?(e.expandBuffer(),Bd(e,t,n)):(r=a.bytesRead>0?Sr(a.buffer,n):"",0===e.position()&&(r=Ir(r)),e.advance(a.bytesRead),r)}function Dd(e,t,n,r,i){var a,o,s,u,c,f=t.charCodeAt(0),l=!1,d=!1,p=-1,h=[];function g(){var e=n?n(c):c;i&&!i(e)||h.push(e),p=-1}function m(e){a=e,0==++p&&(c=[]),r&&!r(p)||(d=!0)}function y(t,n){var r;d&&(d=!1,r=t===n?"":34==e.charCodeAt(t)?e.slice(t+1,n-1).replace(/""/g,'"'):e.slice(t,n),c.push(r))}for(n||(n=function(e){return e}),m(0),o=0,u=e.length;o<u;o++)34==(s=e.charCodeAt(o))?l=!l:l||(s==f?(y(a,o),m(o+1)):13!=s&&10!=s||(y(a,o),g(),13==s&&10==e.charCodeAt(o+1)&&o++,o+1<u&&m(o+1)));return p>-1&&(d&&y(a,o),g()),h}var Rd=Object.freeze({__proto__:null,readDelimRecords:kd,readDelimRecordsFromString:Nd,indexOfLine:Cd,getRowConverter:zd,parseDelimHeaderSection:Td,getDelimFieldFilter:Ld,readLinesAsString:Bd,parseDelimText:Dd});function Ud(e,t){return t.map((function(t){return Sr(t,e).trim()})).join("\n")}function qd(e,t){var n={},r=0;e=e.toLowerCase();for(var i=0,a=t.length;i<a;i++)n[t[i]]=1;for(i=0,a=e.length;i<a;i++)r+=n[e[i]]||0;return r/e.length}function Gd(e,n){var r,i,a,o,s,c,f,l=!e.content&&""!==e.content,d=e.content;return n=n||{},l?r=new Od(e.filename):d instanceof ArrayBuffer||d instanceof u?(r=new jd(d),d=null):t.isString(d)||lt("Unexpected object type"),r&&("utf16be"==(s=(f=(c=r.readSync(0,Math.min(r.size(),3))).length)>=2&&254==c[0]&&255==c[1]?"utf16be":f>=2&&255==c[0]&&254==c[1]?"utf16le":f>=3&&239==c[0]&&187==c[1]&&191==c[2]?"utf8":"")||"utf16le"==s?(d=Ir(r.toString(s)),r=null):n.encoding&&!br(n.encoding)&&(d=r.toString(n.encoding),r=null)),0===(i=r?kd(r,a=Jd(Pd(r,2e3)),n):Nd(d,a=Jd(d),n)).length&&ht("Unable to read any data records"),Wd(i,n),Nr(o=new Vr(i),Cr),{layers:[{data:o}],info:{input_delimiter:a}}}var Vd=["|","\t",",",";"," "];function $d(e){return t.contains(Vd,e)}function Jd(e){return t.find(Vd,(function(n){var r=function(e){var n="^[^\\n\\r]+"+t.regexEscape(e);return new RegExp(n)}(n);return r.test(e)}))||","}function Yd(e){var t={};return(e=e||{}).string_fields&&e.string_fields.forEach((function(e){t[e]="string"})),e.field_types&&e.field_types.forEach((function(e){var n,r,i;-1!=e.indexOf(":")?(r=(n=e.split(":"))[0],i=function(e){var t=e.toLowerCase(),n=null;return"n"==t[0]?n="number":"s"==t[0]&&(n="string"),n}(n[1])):"+"===e[0]&&(r=e.substr(1),i="number"),i?t[r]=i:ht("Invalid type hint (expected :str or :num) ["+e+"]")})),t}function Wd(e,n){var r=n||{},i=Yd(r),a=i["*"],o=Object.keys(e[0]||[]),s=[],u=r.decimal_comma?t.parseIntlNumber:t.parseNumber,c={};o.forEach((function(t){var n=i[t],r=null;"number"==n||"number"==a?r=function(e,t,n){for(var r=[],i=0,a=t.length;i<a;i++)r.push(n(t[i][e]));return r}(t,e,u):"string"==n||"string"==a?r=null:(r=function(e,t,n){for(var r,i,a,o=[],s=0,u=0,c=t.length;u<c;u++){if(null===(a=n(r=t[u][e]))){if((i=r?r.trim():"").length>0&&"NA"!=i&&"NaN"!=i)return null}else s++;o.push(a)}return s>0?o:null}(t,e,u),r&&s.push(t)),r&&(c[t]=r)})),Object.keys(c).length>0&&function(e,t,n){var r="return {"+e.map((function(e){var t=JSON.stringify(e);return t+": "+(n[e]?"replacements["+t+"][i]":"rec["+t+"]")})).join(", ")+"}",i=new Function("rec","replacements","i",r);t.forEach((function(e,r){t[r]=i(e,n,r)}))}(o,e,c),s.length>0&&ht(t.format("Auto-detected number field%s: %s",1==s.length?"":"s",s.join(", ")))}var Hd=Object.freeze({__proto__:null,importDelim:function(e,t){return Gd({content:e},t)},importDelim2:Gd,isSupportedDelimiter:$d,guessDelimiter:Jd,getFieldTypeHints:Yd,adjustRecordTypes:Wd});function Xd(e){var t=e.options,n=e._;n.length>0&&!t.files&&(t.files=n),t.files&&(t.files=io.expandInputFiles(t.files),"-"!=t.files[0]&&"/dev/stdin"!=t.files[0]||(delete t.files,t.stdin=!0)),"precision"in t&&t.precision>0==0&&lt("precision= option should be a positive number"),t.encoding&&(t.encoding=mr(t.encoding))}function Qd(e){var n=e.options,r=e._[0];r&&(/^[0-9.]+%?$/.test(r)?n.percentage=t.parsePercent(r):lt("Unparsable option:",r)),n.interval||n.percentage||n.resolution||lt("Command requires an interval, percentage or resolution parameter")}function Zd(e){var t=e._;t.length>0&&!e.options.crs&&(e.options.crs=t.join(" "),t=[]),t.length>0&&lt("Received one or more unexpected parameters: "+t.join(", ")),e.options.crs||e.options.match||e.options.init||dt("Missing projection data")}function Kd(e){var t=e.options;if(1==e._.length){var n=e._[0].split(",");t.cols=parseInt(n[0],10),t.rows=parseInt(n[1],10)||t.cols}}function ep(e){e.options.expression||lt("Command requires a JavaScript expression")}function tp(e){var t=e._,n=e.options,r=t[0]||"",i=Xa(r);t.length>1&&lt("Command takes one file or directory argument"),"-"==r||"/dev/stdout"==r?n.stdout=!0:r&&!i.extension?(io.isDirectory(r)||lt("Unknown output option:",r),n.directory=r):r&&(i.directory&&(n.directory=i.directory),n.file=i.filename,gd(n.file)&&lt("Output file looks like an unsupported file type:",n.file)),n.format&&(n.format=n.format.toLowerCase(),"csv"==n.format?(n.format="dsv",n.delimiter=n.delimiter||","):"tsv"==n.format&&(n.format="dsv",n.delimiter=n.delimiter||"\t"),pd(n.format)||lt("Unsupported output format:",n.format)),n.delimiter&&(n.delimiter=n.delimiter.replace(/^["']?\\t["']?$/,"\t"),$d(n.delimiter)||lt("Unsupported delimiter:",n.delimiter)),n.encoding&&(n.encoding=mr(n.encoding)),n.field_order&&"ascending"!=n.field_order&&lt("Unsupported field order:",n.field_order),"quantization"in n&&n.quantization>0==0&&lt("quantization= option should be a nonnegative integer"),"topojson_precision"in n&&n.topojson_precision>0==0&&lt("topojson-precision= option should be a positive number")}var np=/^([a-z0-9_+-]+)=(?!=)(.*)$/i;function rp(e){var n=new RegExp("(([^'\"\\s])+|'((\\\\'|[^'])*?)'|\"((\\\\\"|[^\"])*?)\")*","g");return(e.match(n)||[]).filter((function(e){return!!e&&"\\"!=e})).map(t.trimQuotes)}function ip(e){return e.split(",").map(parseFloat)}function ap(e){var t=up(e,",");return 1==t.length&&(t=up(t[0],",")),t}function op(e){var t=up(e.replace(/[ ,] *(?=[^(]*\))/g,"~~~"),", ");return 1==t.length&&(t=up(t[0],", ")),t.map((function(e){return e.replace(/~~~/g,",")}))}function sp(e){return(e=e.map((function(e){return/= $/.test(e)||(e=t.rtrim(e)),t.ltrim(e)}))).filter((function(e){return""!==e}))}function up(e,n){for(var r,i=new RegExp("^(([^"+n+"'\"][^"+n+"]*)|'((\\\\'|[^'])*?)'|\"((\\\\\"|[^\"])*?)\")(["+n+"]+|$)"),a=[];null!==(r=i.exec(e));)a.push(r[1]),e=e.substr(r[0].length);return a.filter((function(e){return!!e&&"\\"!=e})).map(t.trimQuotes)}function cp(e){return np.test(e)}function fp(e){var n=np.exec(e);return[n[1],t.trimQuotes(n[2])]}var lp=Object.freeze({__proto__:null,splitShellTokens:rp,parseNumberList:ip,parseStringList:ap,parseColorList:op,cleanArgv:sp,formatOptionValue:function(e){return(e=String(e)).indexOf(" ")>-1&&(e=JSON.stringify(e)),e},isAssignment:cp,splitAssignment:fp});function dp(){var e,n=/^--?([a-z][\w-]*)$/i,r=/^--?[a-z][\w-]*[=]/i,i="",a=[],o=[],s=null;if(this instanceof dp==0)return new dp;function u(){return o.map((function(e){return e.done()}))}function c(e){return!!f(e,u())}function f(e,n){return t.find(n,(function(t){return t.name===e||t.alias===e||t.old_alias===e}))}function l(e,n){return t.find(n.options,(function(t){return t.name===e||t.alias===e||t.old_alias===e}))}this.usage=function(e){return i=e,this},this.note=function(t){return e=t,this},this.default=function(e){s=e},this.example=function(e){a.push(e)},this.command=function(e){var t=new pp(e);return t.option("verbose",{type:"flag"}),t.option("debug",{type:"flag"}),o.push(t),t},this.section=function(e){return this.command("").title(e)},this.isCommandName=c,this.parseArgv=function(e){var i,a,o,d,p,h=u(),g=[],m=sp(e);for(1==m.length&&c(m[0])?m.unshift("-help"):m.length>0&&!y(m[0])&&s&&m.unshift("-"+s);m.length>0;){for(d=m,p=void 0,(a=(p=n.exec(d[0]))?(d.shift(),p[1]):null)||dt("Invalid command:",m[0]),(o=f(a,h))||(o={name:a,options:[],multi_arg:!0}),i={name:o.name,options:{},_:[]};m.length>0&&!y(m[0]);)v(i,m,o);try{i._.length>0&&o.no_arg&&lt("Received one or more unexpected parameters:",i._.join(" ")),i._.length>1&&!o.multi_arg&&lt("Command expects a single value. Received:",i._.join(" ")),o.default&&1==i._.length&&x(i,o),o.validate&&o.validate(i)}catch(e){dt("["+a+"] "+e.message)}g.push(i)}return g;function y(e){return r.test(e)&&dt("Invalid command syntax:",e),n.test(e)}function v(e,n,r){var i,a,o,s=n.shift();cp(s)?(a=l((o=fp(s))[0],r))&&("flag"==a.type||a.assign_to?dt("-"+r.name+" "+o[0]+" option doesn't take a value"):n.unshift(o[1])):a=l(s,r),a?(a.alias_to&&(a=l(a.alias_to,r)),i=(i=a.name).replace(/-/g,"_"),a.assign_to?e.options[a.assign_to]=a.name:"flag"==a.type?e.options[i]=!0:e.options[i]=b(n,a)):e._.push(t.trimQuotes(s))}function b(e,t){return(0===e.length||y(e[0]))&&dt("Missing value for "+t.name+" option"),function(e,t){var n,r,i=t.type;return(n="number"==i?Number(e):"integer"==i?Math.round(Number(e)):"colors"==i?op(e):"strings"==i?ap(e):"bbox"==i||"numbers"==i?ip(e):e)!=n&&(r="Invalid numeric value"),r&&dt(r+" for "+t.name+" option"),n}(e.shift(),t)}function x(e,t){var n=l(t.default,t);e.options[t.default]=b(e._,n)}},this.getHelpMessage=function(n){var r,o,s;return n?((o=f(n,u()))||dt(n,"is not a known command"),s=function(e){var t=[];return t.push("COMMAND",c(e)),e.options.length>0&&(t.push("","OPTIONS"),e.options.forEach((function(n){t=t.concat(function(e,t){var n,r=[],i=e.describe;return i&&(e.label?r.push([e.label,i]):e.name==t.default?(n=e.name+"=",r.push(["<"+e.name+">","shortcut for "+n]),r.push([n,i])):(n=e.name,e.alias&&(n+=", "+e.alias),"flag"==e.type||e.assign_to||(n+="="),r.push([n,i]))),r}(n,e))}))),e.examples&&(t.push("","EXAMPLE"+(e.examples.length>1?"S":"")),e.examples.forEach((function(e,n){n>0&&t.push(""),e.split("\n").forEach((function(e,n){t.push("  "+e)}))}))),t}(o)):(r=u().filter((function(e){return e.name&&e.describe||e.title})),s=function(t){var n=[];return i&&n.push(i),t.forEach((function(e){e.title?n.push("",e.title):n.push(c(e))})),a.length>0&&(n.push("","Examples"),a.forEach((function(e){n.push("",e)}))),e&&n.push("",e),n}(r)),function(e){var n=function(e){var t=0;return e.forEach((function(e){Array.isArray(e)&&(t=Math.max(t,e[0].length))})),t}(e),r=Wa()?"":"  ";return e.map((function(e){return Array.isArray(e)&&(e=r+t.rpad(e[0],n," ")+"  "+e[1]),e})).join("\n")}(s);function c(e){var t=e.name?"-"+e.name:"";return e.alias&&(t+=", -"+e.alias),[t,e.describe||"(undocumented command)"]}},this.printHelp=function(e){mt(this.getHelpMessage(e))}}function pp(e){var n={name:e,options:[]};this.validate=function(e){return n.validate=e,this},this.describe=function(e){return n.describe=e,this},this.example=function(e){return n.examples||(n.examples=[]),n.examples.push(e),this},this.alias=function(e){return n.alias=e,this},this.oldAlias=function(e){return n.old_alias=e,this},this.title=function(e){return n.title=e,this},this.flag=function(e){return n[e]=!0,this},this.option=function(e,r){return r=t.extend({},r),t.isString(e)&&e||lt("Missing option name"),t.isObject(r)||lt("Invalid option definition:",r),r.DEFAULT&&(n.default=e),r.name=e,n.options.push(r),this},this.options=function(e){return Object.keys(e).forEach((function(t){this.option(t,e[t])}),this),this},this.done=function(){return n}}function hp(){var e={describe:"layer(s) to target (comma-sep. list)"},t={describe:"rename the edited layer(s)"},n={alias:"+",type:"flag",label:"+, no-replace",describe:"retain both input and output layer(s)"},r={type:"flag"},i={describe:"text encoding (applies to .dbf and delimited text files)"},a={describe:"snapping distance in source units (default is tiny)",type:"distance"},o={old_alias:"min-gap-area",describe:"threshold for filling gaps, e.g. 1.5km2 (default is small)",type:"area"},s={describe:"boost gap-fill-area of slivers (0-1, default is 1)",type:"number"},u={describe:"use a JS expression to aggregate data values"},c={describe:"fields to sum when dissolving  (comma-sep. list)",type:"strings"},f={describe:"fields to copy when dissolving (comma-sep. list)",type:"strings"},l={DEFAULT:!0,type:"strings",describe:"(optional) field(s) to dissolve on (comma-sep. list)"},d={describe:"type hints for csv source files, e.g. FIPS:str,ZIPCODE:str",type:"strings"},p={describe:"csv field(s) to import as strings, e.g. FIPS,ZIPCODE",type:"strings"},h={type:"bbox",describe:"comma-sep. bounding box: xmin,ymin,xmax,ymax"},g={type:"flag",describe:"retain only features that would have been deleted"},m={describe:"use a JS expression to select a subset of features"},y={describe:"filter polygon boundaries using a JS expression (with A and B)"},v={describe:"aspect ratio as a number or range (e.g. 2 0.8,1.6 ,2)"},b={describe:"padding as distance or pct of h/w (single value or list)",type:"distance"},x=new dp;x.usage("Usage:  mapshaper -<command> [options] ..."),x.note("Enter mapshaper -help <command> to view options for a single command"),x.section("I/O commands"),x.default("i"),x.command("i").describe("input one or more files").validate(Xd).flag("multi_arg").option("files",{DEFAULT:!0,type:"strings",describe:"one or more files to import, or - to use stdin"}).option("combine-files",{describe:"import files to separate layers with shared topology",type:"flag"}).option("merge-files",{type:"flag"}).option("no-topology",{describe:"treat each shape as topologically independent",type:"flag"}).option("precision",{describe:"coordinate precision in source units, e.g. 0.001",type:"number"}).option("snap",{type:"flag",describe:"snap nearly identical points to fix minor topology errors"}).option("auto-snap",{alias_to:"snap"}).option("snap-interval",a).option("encoding",i).option("id-field",{describe:"import Topo/GeoJSON id property to this field"}).option("string-fields",p).option("field-types",d).option("name",{describe:"Rename the imported layer(s)"}).option("geometry-type",{}).option("json-path",{}).option("csv-skip-lines",{type:"integer",describe:"[CSV] number of lines to skip at the beginning of the file"}).option("csv-lines",{type:"integer",describe:"[CSV] number of data records to read"}).option("csv-field-names",{type:"strings",describe:"[CSV] comma-sep. list of field names to assign each column"}).option("csv-dedup-fields",{type:"flag",describe:"[CSV] rename fields with duplicate names"}).option("csv-filter",{describe:"[CSV] JS expression for filtering records"}).option("csv-fields",{type:"strings",describe:"[CSV] comma-sep. list of fields to import"}).option("decimal-comma",{type:"flag",describe:"[CSV] import numbers formatted like 1.000,01 or 1 000,01"}).option("json-path",{old_alias:"json-subtree",describe:"[JSON] path to JSON input data; separator is /"}).option("single-part",{type:"flag"}),x.command("o").describe("output edited content").validate(tp).option("_",{label:"<file|directory>",describe:"(optional) name of output file or directory, - for stdout"}).option("format",{describe:"options: shapefile,geojson,topojson,json,dbf,csv,tsv,svg"}).option("target",e).option("force",{describe:"allow overwriting input files",type:"flag"}).option("dry-run",{type:"flag"}).option("ldid",{type:"number"}).option("precision",{describe:"coordinate precision in source units, e.g. 0.001",type:"number"}).option("bbox-index",{describe:"export a .json file with bbox of each layer",type:"flag"}).option("cut-table",{describe:"detach data attributes from shapes and save as a JSON file",type:"flag"}).option("drop-table",{describe:"remove data attributes from output",type:"flag"}).option("encoding",{describe:"[Shapefile/CSV] text encoding (default is utf8)"}).option("field-order",{describe:"[Shapefile/CSV] field-order=ascending sorts columns A-Z"}).option("id-field",{describe:"[Topo/GeoJSON/SVG] field to use for id property",type:"strings"}).option("bbox",{type:"flag",describe:"[Topo/GeoJSON] add bbox property"}).option("extension",{describe:'[Topo/GeoJSON] set file extension (default is ".json")'}).option("prettify",{type:"flag",describe:"[Topo/GeoJSON/JSON] format output for readability"}).option("singles",{describe:"[TopoJSON] save each target layer as a separate file",type:"flag"}).option("quantization",{describe:"[TopoJSON] specify quantization (auto-set by default)",type:"integer"}).option("no-quantization",{describe:"[TopoJSON] export coordinates without quantization",type:"flag"}).option("no-point-quantization",{type:"flag"}).option("presimplify",{describe:"[TopoJSON] add per-vertex data for dynamic simplification",type:"flag"}).option("topojson-precision",{type:"number"}).option("rfc7946",{type:"flag"}).option("gj2008",{describe:"[GeoJSON] use original GeoJSON spec (not RFC 7946)",type:"flag"}).option("combine-layers",{describe:"[GeoJSON] output layers as a single file",type:"flag"}).option("geojson-type",{describe:"[GeoJSON] FeatureCollection, GeometryCollection or Feature"}).option("ndjson",{describe:"[GeoJSON/JSON] output newline-delimited features or records",type:"flag"}).option("width",{describe:"[SVG/TopoJSON] pixel width of output (SVG default is 800)",type:"number"}).option("height",{describe:"[SVG/TopoJSON] pixel height of output (optional)",type:"number"}).option("max-height",{describe:"[SVG/TopoJSON] max pixel height of output (optional)",type:"number"}).option("margin",{describe:"[SVG/TopoJSON] space betw. data and viewport (default is 1)"}).option("pixels",{describe:"[SVG/TopoJSON] output area in pix. (alternative to width=)",type:"number"}).option("fit-bbox",{type:"bbox",describe:"[TopoJSON] scale and shift coordinates to fit a bbox"}).option("svg-scale",{describe:"[SVG] source units per pixel (alternative to width= option)",type:"number"}).option("point-symbol",{describe:"[SVG] circle or square (default is circle)"}).option("svg-data",{type:"strings",describe:"[SVG] fields to export as data-* attributes"}).option("id-prefix",{describe:"[SVG] prefix for namespacing layer and feature ids"}).option("scalebar",{type:"flag"}).option("delimiter",{describe:"[CSV] field delimiter"}).option("decimal-comma",{type:"flag",describe:"[CSV] export numbers with decimal commas not points"}).option("final",{type:"flag"}).option("metadata",{type:"flag"}),x.section("Editing commands"),x.command("affine").describe("transform coordinates by shifting, scaling and rotating").flag("no_args").option("shift",{type:"strings",describe:"x,y offsets in source units (e.g. 5000,-5000)"}).option("scale",{type:"number",describe:"scale (default is 1)"}).option("rotate",{type:"number",describe:"angle of rotation in degrees (default is 0)"}).option("anchor",{type:"numbers",describe:"center of rotation/scaling (default is center of selected shapes)"}).option("where",m).option("target",e),x.command("buffer").option("radius",{describe:"radius of buffer, as an expression or a constant",DEFAULT:!0}).option("tolerance",{}).option("vertices",{type:"integer"}).option("backtrack",{type:"integer"}).option("type",{}).option("planar",{type:"flag"}).option("v2",{type:"flag"}).option("debug-division",{type:"flag"}).option("debug-mosaic",{type:"flag"}).option("no-cleanup",{type:"flag"}).option("units",{describe:"distance units (meters|miles|km|feet) (default is meters)"}).option("name",t).option("target",e).option("no-replace",n),x.command("classify").describe("assign colors or values using one of several methods").option("field",{describe:"name of field to classify",DEFAULT:!0}).option("save-as",{describe:"name of output field (default is fill|stroke|class)"}).option("colors",{describe:"list of CSS colors or color scheme name (see -colors)",type:"colors"}).option("values",{describe:"values to assign to classes (alternative to colors=)",type:"strings"}).option("color-scheme",{}).option("non-adjacent",{describe:"assign non-adjacent colors to a polygon layer",assign_to:"method"}).option("stops",{describe:"a pair of values (0-100) for limiting a color ramp",type:"numbers"}).option("null-value",{describe:"value (or color) to use for invalid or missing data"}).option("method",{describe:"quantile, nice, equal-interval, categorical, etc."}).option("quantile",{assign_to:"method"}).option("equal-interval",{assign_to:"method"}).option("hybrid",{assign_to:"method"}).option("nice",{assign_to:"method"}).option("breaks",{describe:"user-defined sequential class breaks",type:"numbers"}).option("classes",{describe:"number of classes (can be inferred from other options)",type:"integer"}).option("invert",{describe:"reverse the order of colors/values",type:"flag"}).option("continuous",{describe:"output continuous interpolated values (experimental)",type:"flag"}).option("index-field",{describe:"apply pre-calculated classes (0 ... n-1, -1)"}).option("precision",{describe:"round data values before classification (e.g. 0.1)",type:"number"}).option("categories",{describe:"list of data values for categorical color scheme",type:"strings"}).option("other",{describe:"default value for categorical scheme"}).option("key",{type:"flag"}).option("key-style",{describe:"one of: simple, gradient, dataviz"}).option("key-name",{describe:"name of output SVG file"}).option("key-width",{describe:"width of key in pixels",type:"number"}).option("key-font-size",{describe:"label size in pixels",type:"number"}).option("key-tile-height",{describe:"height of color tiles in pixels",type:"number"}).option("key-tic-length",{describe:"length of tic mark in pixels"}).option("key-label-suffix",{describe:"string to append to each label"}).option("key-last-suffix",{describe:"string to append to last label"}).option("target",e),x.command("clean").describe("fixes geometry issues, such as polygon overlaps and gaps").option("gap-fill-area",o).option("sliver-control",s).option("snap-interval",a).option("no-snap",r).option("allow-overlaps",{describe:"allow polygons to overlap (disables gap fill)",type:"flag"}).option("overlap-rule",{describe:"how to resolve overlaps: min-id|max-id|min-area|[max-area]"}).option("allow-empty",{describe:"keep null geometries (removed by default)",type:"flag"}).option("rewind",{describe:"fix errors in the CW/CCW winding order of polygon rings",type:"flag"}).option("arcs",{alias_to:"only-arcs"}).option("only-arcs",{describe:"delete unused arcs but don't remove gaps and overlaps",type:"flag"}).option("no-arc-dissolve",{type:"flag"}).option("target",e),x.command("clip").describe("use a polygon layer to clip another layer").example("$ mapshaper states.shp -clip land_area.shp -o clipped.shp").option("source",{DEFAULT:!0,describe:"file or layer containing clip polygons"}).option("remove-slivers",{describe:"remove sliver polygons created by clipping",type:"flag"}).option("bbox",h).option("bbox2",{type:"bbox",describe:"experimental fast bbox clipping"}).option("name",t).option("no-snap",r).option("target",e).option("no-replace",n),x.command("colorizer").describe("define a function to convert data values to color classes").flag("no_arg").option("colors",{describe:"comma-separated list of CSS colors",type:"colors"}).option("breaks",{describe:"ascending-order list of breaks for sequential color scheme",type:"numbers"}).option("categories",{describe:"comma-sep. list of keys for categorical color scheme",type:"strings"}).option("random",{describe:"randomly assign colors",type:"flag"}).option("other",{describe:"default color for categorical scheme (defaults to no-data color)"}).option("nodata",{describe:"color to use for invalid or missing data (default is white)"}).option("name",{describe:"function name to use in -each and -svg-style commands"}).option("precision",{describe:"rounding precision to apply before classification (e.g. 0.1)",type:"number"}).example("Define a sequential color scheme and use it to create a new field\n$ mapshaper data.json -colorizer name=getColor nodata=#eee breaks=20,40 \\\n  colors=#e0f3db,#a8ddb5,#43a2ca -each 'fill = getColor(RATING)' -o output.json"),x.command("dashlines").describe("split lines into sections, with or without a gap").oldAlias("split-lines").option("dash-length",{type:"distance",describe:"length of split-apart lines (e.g. 200km)"}).option("gap-length",{type:"distance",describe:"length of gaps between dashes (default is 0)"}).option("scaled",{type:"flag",describe:"scale dashes and gaps to prevent partial dashes"}).option("planar",{type:"flag",describe:"use planar geometry"}).option("where",m).option("target",e),x.command("define").option("expression",{DEFAULT:!0,describe:"one or more assignment expressions (comma-sep.)"}),x.command("dissolve").describe("merge features within a layer").example("Dissolve all polygons in a feature layer into a single polygon\n$ mapshaper states.shp -dissolve -o country.shp").example("Generate state-level polygons by dissolving a layer of counties\n(STATE_FIPS, POPULATION and STATE_NAME are attribute field names)\n$ mapshaper counties.shp -dissolve STATE_FIPS copy-fields=STATE_NAME sum-fields=POPULATION -o states.shp").option("field",{}).option("fields",l).option("calc",u).option("sum-fields",c).option("copy-fields",f).option("multipart",{type:"flag",describe:"make multipart features instead of dissolving"}).option("where",m).option("group-points",{type:"flag",describe:"[points] group points instead of converting to centroids"}).option("weight",{describe:"[points] field or expression to use for weighting centroid"}).option("planar",{type:"flag",describe:"[points] use 2D math to find centroids of latlong points"}).option("name",t).option("target",e).option("no-replace",n),x.command("dissolve2").describe("merge adjacent polygons (repairs overlaps and gaps)").option("field",{}).option("fields",l).option("calc",u).option("sum-fields",c).option("copy-fields",f).option("gap-fill-area",o).option("sliver-control",s).option("allow-overlaps",{describe:"allow dissolved polygons to overlap (disables gap fill)",type:"flag"}).option("name",t).option("no-snap",r).option("target",e).option("no-replace",n),x.command("divide").describe("divide lines by polygons, copy polygon data to lines").option("fields",{describe:"fields to copy (comma-sep.) (default is all but key field)",type:"strings"}).option("calc",{describe:"use a JS expression to assign values (for many-to-one joins)"}).option("force",{describe:"replace values from same-named fields",type:"flag"}).option("source",{DEFAULT:!0,describe:"file or layer containing polygons"}).option("target",e),x.command("dots").describe("fill polygons with dots of one or more colors").option("fields",{DEFAULT:!0,describe:"one or more fields containing numbers of dots",type:"strings"}).option("colors",{describe:"one or more colors",type:"strings"}).option("values",{describe:"values to assign to dot classes (alternative to colors=)",type:"strings"}).option("save-as",{describe:"name of color/value output field (default is fill)"}).option("progressive",{type:"flag"}).option("r",{describe:"radius of each dot in pixels",type:"number"}).option("evenness",{describe:"(0-1) dot spacing, from random to even (default is 1)",type:"number"}).option("per-dot",{describe:"number for scaling data values (e.g. 10 per dot)",type:"number"}).option("copy-fields",{describe:"list of fields to copy from polygons to dots",type:"strings"}).option("multipart",{describe:"combine groups of same-color dots into multi-part features",type:"flag"}).option("target",e).option("name",t).option("no-replace",n),x.command("drop").describe("delete layer(s) or elements within the target layer(s)").flag("no_arg").option("geometry",{describe:"delete all geometry from the target layer(s)",type:"flag"}).option("holes",{describe:"delete holes from polygons",type:"flag"}).option("fields",{type:"strings",describe:"delete a list of attribute data fields, e.g. 'id,name' '*'"}).option("target",e),x.command("each").describe("create/update/delete data fields using a JS expression").example("Add two calculated data fields to a layer of U.S. counties\n$ mapshaper counties.shp -each 'STATE_FIPS=CNTY_FIPS.substr(0, 2), AREA=$.area'").option("expression",{DEFAULT:!0,describe:"JS expression to apply to each target feature"}).option("where",m).option("target",e),x.command("erase").describe("use a polygon layer to erase another layer").example("$ mapshaper land_areas.shp -erase water_bodies.shp -o erased.shp").option("source",{DEFAULT:!0,describe:"file or layer containing erase polygons"}).option("remove-slivers",{describe:"remove sliver polygons created by erasing",type:"flag"}).option("bbox",h).option("name",t).option("no-snap",r).option("target",e).option("no-replace",n),x.command("explode").describe("divide multi-part features into single-part features").option("naive",{type:"flag"}).option("target",e),x.command("filter").describe("delete features using a JS expression").option("expression",{DEFAULT:!0,describe:"delete features that evaluate to false"}).option("bbox",{describe:"delete features outside bbox (xmin,ymin,xmax,ymax)",type:"bbox"}).option("invert",g).option("remove-empty",{type:"flag",describe:"delete features with null geometry"}).option("keep-shapes",{type:"flag"}).option("ids",{type:"numbers"}).option("cleanup",{type:"flag"}).option("name",t).option("target",e).option("no-replace",n),x.command("filter-fields").describe("retain a subset of data fields").option("fields",{DEFAULT:!0,type:"strings",describe:"fields to retain (comma-sep.), e.g. 'fips,name'"}).option("target",e),x.command("filter-geom").describe("").option("bbox",{type:"bbox",describe:"remove non-intersecting geometry (xmin,ymin,xmax,ymax)"}).option("target",e),x.command("filter-islands2").option("min-area",{type:"area",describe:"remove small-area islands (e.g. 10km2)"}).option("min-vertices",{type:"integer",describe:"remove low-vertex-count islands"}).option("keep-shapes",{type:"flag",describe:"only filter smaller parts of multipart polygons"}).option("remove-empty",{type:"flag",describe:"delete features with null geometry"}).option("target",e),x.command("filter-islands").describe("remove small detached polygon rings (islands)").option("min-area",{type:"area",describe:"remove small-area islands (e.g. 10km2)"}).option("min-vertices",{type:"integer",describe:"remove low-vertex-count islands"}).option("remove-empty",{type:"flag",describe:"delete features with null geometry"}).option("target",e),x.command("filter-slivers").describe("remove small polygon rings").option("min-area",{type:"area",describe:"area threshold (e.g. 2sqkm)"}).option("sliver-control",{describe:"boost area threshold of slivers (0-1, default is 1)",type:"number"}).option("weighted",{type:"flag"}).option("target",e),x.command("graticule").describe("create a graticule layer").option("interval",{describe:"size of grid cells in degrees (options: 5 10 15 30 45, default is 10)",type:"number"}).option("polygon",{describe:"create a polygon to match the outline of the graticule",type:"flag"}),x.command("grid").describe("create a grid of square or hexagonal polygons").option("type",{describe:"square, hex or hex2 (default is square)"}).option("interval",{describe:"side length (e.g. 500m, 12km)",type:"distance"}).option("name",t).option("target",e).option("no-replace",n),x.command("include").describe("import JS data and functions for use in JS expressions").option("file",{DEFAULT:!0,describe:"file containing a JS object with key:value pairs to import"}),x.command("inlay").describe("inscribe a polygon layer inside another polygon layer").option("source",{DEFAULT:!0,describe:"file or layer containing polygons to inlay"}).option("target",e),x.command("innerlines").describe("convert polygons to polylines along shared edges").flag("no_arg").option("where",y).option("name",t).option("target",e).option("no-replace",n),x.command("join").describe("join data records from a file or layer to a layer").example("Join a csv table to a Shapefile (don't auto-convert FIPS column to numbers)\n$ mapshaper states.shp -join data.csv keys=STATE_FIPS,FIPS string-fields=FIPS -o joined.shp").validate((function(e){e.options.source||lt("Command requires the name of a layer or file to join")})).option("source",{DEFAULT:!0,describe:"file or layer containing data records"}).option("keys",{describe:"join by matching target,source key fields, e.g. keys=FID,id",type:"strings"}).option("calc",{describe:"use a JS expression to assign values (for many-to-one joins)"}).option("where",{describe:"use a JS expression to filter source records"}).option("fields",{describe:"fields to copy (comma-sep.) (default is all but key field)",type:"strings"}).option("prefix",{describe:"prefix for renaming fields joined from the source table"}).option("interpolate",{describe:"(polygon-polygon join) list of area-interpolated fields",type:"strings"}).option("point-method",{describe:"(polygon-polygon join) join polygons via inner points",type:"flag"}).option("largest-overlap",{describe:"(polygon-polygon join) use max overlap to join one polygon",type:"flag"}).option("max-distance",{describe:"(point-point join) join source points within this radius",type:"distance"}).option("planar",{type:"flag"}).option("duplication",{describe:"duplicate target features on many-to-one joins",type:"flag"}).option("string-fields",p).option("field-types",d).option("sum-fields",{describe:"fields to sum in a many-to-one join (or use calc= for this)",type:"strings"}).option("force",{describe:"replace values from same-named fields",type:"flag"}).option("unjoined",{describe:'copy unjoined records from source table to "unjoined" layer',type:"flag"}).option("unmatched",{describe:'copy unmatched records in target table to "unmatched" layer',type:"flag"}).option("encoding",i).option("target",e),x.command("lines").describe("convert a polygon or point layer to a polyline layer").option("fields",{DEFAULT:!0,describe:"field(s) to create a hierarchy of boundary lines",type:"strings"}).option("where",y).option("each",{describe:"apply a JS expression to each polygon boundary (with A and B)"}).option("segments",{describe:"convert paths to segments, for debugging",type:"flag"}).option("callouts",{type:"flag"}).option("arcs",{describe:"convert paths to arcs, for debugging",type:"flag"}).option("groupby",{describe:"field for grouping point input into multiple lines"}).option("name",t).option("target",e).option("no-replace",n),x.command("merge-layers").describe("merge multiple layers into as few layers as possible").flag("no_arg").option("force",{type:"flag",describe:"merge layers with inconsistent data fields"}).option("flatten",{describe:"remove polygon overlaps; higher-id polygons take priority",type:"flag"}).option("name",t).option("target",e),x.command("mosaic").describe("convert a polygon layer with overlaps into a flat mosaic").option("calc",u).option("name",t).option("target",e).option("no-replace",n),x.command("point-grid").describe("create a rectangular grid of points").validate(Kd).option("-",{label:"<cols,rows>",describe:"size of the grid, e.g. -point-grid 100,100"}).option("interval",{describe:"distance between adjacent points, in source units",type:"distance"}).option("cols",{type:"integer"}).option("rows",{type:"integer"}).option("bbox",{type:"bbox",describe:"xmin,ymin,xmax,ymax (default is bbox of data)"}).option("name",t).option("target",e).option("no-replace",n),x.command("points").describe("create a point layer from a different layer type").flag("no_arg").option("x",{describe:"field containing x coordinate"}).option("y",{describe:"field containing y coordinate"}).option("inner",{describe:"create an interior point for each polygon's largest ring",type:"flag"}).option("centroid",{describe:"create a centroid point for each polygon's largest ring",type:"flag"}).option("vertices",{describe:"capture unique vertices of polygons and polylines",type:"flag"}).option("vertices2",{describe:"like vertices, but without removal of duplicate coordinates",type:"flag"}).option("endpoints",{describe:"capture unique endpoints of polygons and polylines",type:"flag"}).option("midpoints",{describe:"find the (planar) midpoint of each polyline",type:"flag"}).option("intersections",{type:"flag"}).option("interpolated",{describe:"interpolate points along polylines; requires interval=",type:"flag"}).option("interval",{describe:"distance between interpolated points (meters or projected units)",type:"distance"}).option("name",t).option("target",e).option("no-replace",n),x.command("polygons").describe("convert polylines to polygons").option("gap-tolerance",{describe:"specify gap tolerance in source units",type:"distance"}).option("from-rings",{describe:"do simple conversion from a layer of closed paths",type:"flag"}).option("target",e),x.command("proj").describe("project your data (using Proj.4)").flag("multi_arg").option("crs",{DEFAULT:!0,describe:"set destination CRS using a Proj.4 definition or alias"}).option("projection",{alias_to:"crs"}).option("match",{describe:"set destination CRS using a .prj file or layer id"}).option("source",{alias_to:"match"}).option("from",{alias_to:"init",describe:"(deprecated) alias for init="}).option("init",{describe:"set source CRS (if unset) using a string, .prj or layer id"}).option("densify",{type:"flag",describe:"add points along straight segments to approximate curves"}).option("clip-angle",{describe:"use a custom clipping radius (for azimuthal projections)",type:"number"}).option("clip-bbox",{describe:"clip to a lat-long bounding box before projecting",type:"bbox"}).option("target",e).validate(Zd),x.command("rectangle").describe("create a rectangle from a bbox or target layer extent").option("bbox",{describe:"rectangle coordinates (xmin,ymin,xmax,ymax)",type:"bbox"}).option("offset",b).option("aspect-ratio",v).option("source",{describe:"name of layer to enclose"}).option("name",t).option("target",e).option("no-replace",n),x.command("rectangles").describe("create a rectangle around each feature in a layer").option("offset",b).option("aspect-ratio",v).option("name",t).option("target",e).option("no-replace",n),x.command("rename-fields").describe("rename data fields").option("fields",{DEFAULT:!0,type:"strings",describe:"list of replacements (comma-sep.), e.g. 'fips=STATE_FIPS,st=state'"}).option("target",e),x.command("rename-layers").describe("assign new names to layers").option("names",{DEFAULT:!0,type:"strings",describe:"list of replacements (comma-sep.)"}).option("target",e),x.command("simplify").validate(Qd).example("Retain 10% of removable vertices\n$ mapshaper input.shp -simplify 10%").describe("simplify the geometry of polygon and polyline features").option("percentage",{DEFAULT:!0,alias:"p",type:"percent",describe:"percentage of removable points to retain, e.g. 10%"}).option("dp",{alias:"rdp",describe:"use Ramer-Douglas-Peucker simplification",assign_to:"method"}).option("visvalingam",{describe:'use Visvalingam simplification with "effective area" metric',assign_to:"method"}).option("weighted",{describe:"use weighted Visvalingam simplification (default)",assign_to:"method"}).option("method",{}).option("weighting",{type:"number",describe:"weighted Visvalingam coefficient (default is 0.7)"}).option("resolution",{describe:"output resolution as a grid (e.g. 1000x500)"}).option("interval",{describe:"output resolution as a distance (e.g. 100)",type:"distance"}).option("variable",{describe:"JS expr. assigning to one of: interval= percentage= resolution=",type:"flag"}).option("planar",{describe:"simplify decimal degree coords in 2D space (default is 3D)",type:"flag"}).option("cartesian",{alias_to:"planar"}).option("keep-shapes",{describe:"prevent small polygon features from disappearing",type:"flag"}).option("lock-box",{type:"flag"}).option("no-repair",{describe:"don't remove intersections introduced by simplification",type:"flag"}).option("stats",{describe:"display simplification statistics",type:"flag"}).option("target",e),x.command("slice").option("source",{DEFAULT:!0,describe:"file or layer containing clip polygons"}).option("id-field",{describe:"slice id field (from source layer)"}).option("name",t).option("no-snap",r).option("target",e).option("no-replace",n),x.command("snap").describe("snap together nearby vertices").option("interval",{describe:"snap together vertices within a tolerance (default is small)",DEFAULT:!0,type:"distance"}).option("endpoints",{describe:"only snap together the endpoints of lines",type:"flag"}).option("precision",{describe:"round all coordinates to a given decimal precision (e.g. 0.000001)",type:"number"}).option("target",e),x.command("sort").describe("sort features using a JS expression").option("expression",{DEFAULT:!0,describe:"JS expression to generate a sort key for each feature"}).option("ascending",{describe:"sort in ascending order (default)",type:"flag"}).option("descending",{describe:"sort in descending order",type:"flag"}).option("target",e),x.command("split").describe("split a layer into single-feature or multi-feature layers").option("field",{alias_to:"expression"}).option("expression",{DEFAULT:!0,describe:"expression or field for grouping features and naming split layers"}).option("ids",{type:"numbers"}).option("apart",{describe:"save output layers to independent datasets",type:"flag"}).option("target",e).option("no-replace",n),x.command("split-on-grid").describe("split features into separate layers using a grid").validate(Kd).option("-",{label:"<cols,rows>",describe:"size of the grid, e.g. -split-on-grid 12,10"}).option("cols",{type:"integer"}).option("rows",{type:"integer"}).option("id-field",{describe:"assign each feature a cell id instead of splitting layer"}).option("target",e),x.command("style").oldAlias("svg-style").describe("set SVG style properties using JS or literal values").option("where",m).option("class",{describe:"name of CSS class or classes (space-separated)"}).option("fill",{describe:"fill color; examples: #eee pink rgba(0, 0, 0, 0.2)"}).option("fill-pattern",{describe:'pattern fill, ex: "hatches 2px grey 2px blue"'}).option("fill-opacity",{describe:"fill opacity"}).option("fill-hatch",{alias_to:"fill-pattern"}).option("stroke",{describe:"stroke color"}).option("stroke-width",{describe:"stroke width"}).option("stroke-dasharray",{describe:'stroke dashes. Examples: "4" "2 4"'}).option("stroke-opacity",{describe:"stroke opacity"}).option("opacity",{describe:"opacity; example: 0.5"}).option("r",{describe:"symbol radius (set this to export points as circles)"}).option("label-text",{describe:"label text (set this to export points as labels)"}).option("text-anchor",{describe:"label alignment; one of: start, end, middle (default)"}).option("dx",{describe:"x offset of labels (default is 0)"}).option("dy",{describe:"y offset of labels (default is 0/baseline-aligned)"}).option("font-size",{describe:"size of label text (default is 12)"}).option("font-family",{describe:"CSS font family of labels (default is sans-serif)"}).option("font-weight",{describe:"CSS font weight property of labels (e.g. bold, 700)"}).option("font-style",{describe:"CSS font style property of labels (e.g. italic)"}).option("letter-spacing",{describe:"CSS letter-spacing property of labels"}).option("line-height",{describe:"line spacing of multi-line labels (default is 1.1em)"}).option("target",e),x.command("symbols").describe("symbolize points as arrows, circles, stars, polygons, etc.").option("type",{describe:"symbol type (e.g. arrow, circle, square, star, polygon, ring)"}).option("stroke",{}).option("stroke-width",{}).option("fill",{describe:"symbol fill color (filled symbols only)"}).option("stroke",{describe:"symbol line color (linear symbols only)"}).option("stroke-width",{describe:"symbol line width (linear symbols only)"}).option("geographic",{old_alias:"polygons",describe:"make geographic shapes instead of SVG objects",type:"flag"}).option("pixel-scale",{describe:"set symbol scale in meters per pixel (geographic option)",type:"number"}).option("rotated",{type:"flag",describe:"symbol is rotated to an alternate orientation"}).option("rotation",{describe:"rotation of symbol in degrees"}).option("scale",{describe:"scale symbols by a multiplier",type:"number"}).option("radius",{describe:"distance from center to farthest point on the symbol",type:"distance"}).option("sides",{describe:"(polygon) number of sides of a (regular) polygon symbol",type:"number"}).option("points",{describe:"(star) number of points"}).option("point-ratio",{old_alias:"star-ratio",describe:"(star) ratio of minor to major radius of star",type:"number"}).option("radii",{describe:"(ring) comma-sep. list of concentric radii, ascending order"}).option("arrow-style",{describe:"(arrow) options: stick, standard (default is standard)"}).option("length",{old_alias:"arrow-length",describe:"(arrow) length of arrow in pixels"}).option("direction",{old_alias:"arrow-direction",describe:"(arrow) angle off of vertical (-90 = left-pointing)"}).option("head-angle",{old_alias:"arrow-head-angle",describe:"(arrow) angle of tip of arrow (default is 40 degrees)"}).option("head-width",{old_alias:"arrow-head-width",describe:"(arrow) width of arrow head from side to side"}).option("head-length",{old_alias:"arrow-head-width",describe:"(arrow) length of head (alternative to head-angle)"}).option("head-shape",{}).option("stem-width",{old_alias:"arrow-stem-width",describe:"(arrow) width of stem at its widest point"}).option("stem-length",{old_alias:"arrow-stem-length",describe:"(arrow) alternative to length"}).option("stem-taper",{old_alias:"arrow-stem-taper",describe:"(arrow) factor for tapering the width of the stem (0-1)"}).option("stem-curve",{old_alias:"arrow-stem-curve",describe:"(arrow) curvature in degrees (default is 0)"}).option("min-stem-ratio",{old_alias:"arrow-min-stem",describe:"(arrow) minimum ratio of stem to total length",type:"number"}).option("anchor",{describe:"(arrow) takes one of: start, middle, end (default is start)"}).option("effect",{}).option("name",t).option("target",e).option("no-replace",n),x.command("target").describe("set active layer (or layers)").option("target",{DEFAULT:!0,describe:"name or index of layer to target"}).option("type",{describe:"type of layer to target (polygon|polyline|point)"}).option("name",{describe:"rename the target layer"}),x.command("union").describe("create a flat mosaic from two or more polygon layers").option("fields",{type:"strings",describe:"fields to retain (comma-sep.) (default is all fields)"}).option("name",t).option("target",{describe:"specify layers to target (comma-sep. list)"}).option("no-replace",n),x.command("uniq").describe("delete features with the same id as a previous feature").option("expression",{DEFAULT:!0,describe:"JS expression to obtain the id of a feature"}).option("max-count",{type:"number",describe:"max features with the same id (default is 1)"}).option("index",{type:"flag"}).option("invert",g).option("verbose",{describe:"print each removed feature",type:"flag"}).option("target",e),x.section("Experimental commands (may give unexpected results)"),x.command("alpha-shapes").option("interval",{describe:"alpha parameter",type:"number"}).option("keep-points",{type:"flag"}).option("name",t).option("target",e).option("no-replace",n),x.command("cluster").describe("group polygons into compact clusters").option("id-field",{describe:'field name of cluster id (default is "cluster")'}).option("pct",{alias:"p",type:"percent",describe:"percentage of shapes to retain, e.g. 50%"}).option("max-width",{describe:"max width of cluster bounding box",type:"number"}).option("max-height",{describe:"max height of cluster bounding box",type:"number"}).option("max-area",{describe:"max area of a cluster",type:"number"}).option("group-by",{describe:"field name; only same-value shapes will be grouped"}).option("target",e),x.command("data-fill").describe("fill in missing values in a polygon layer").option("field",{describe:"name of field to fill in"}).option("postprocess",{alias_to:"contiguous"}).option("contiguous",{describe:"remove non-contiguous data islands",type:"flag"}).option("weight-field",{describe:"use field values to calculate data island weights"}),x.command("external").option("module",{DEFAULT:!0,describe:"name of Node module containing the command"}),x.command("filter-points").option("group-interval",{type:"number"}),x.command("frame").option("bbox",{describe:"frame coordinates (xmin,ymin,xmax,ymax)",type:"bbox"}).option("offset",b).option("width",{describe:"pixel width of output (default is 800)"}).option("height",{describe:"pixel height of output (may be a range)"}).option("pixels",{describe:"area of output in pixels (alternative to width and height)",type:"number"}).option("source",{describe:"name of layer to enclose"}).option("name",t),x.command("fuzzy-join").describe("join points to polygons, with data fill and fuzzy match").option("source",{DEFAULT:!0,describe:"file or layer containing data records"}).option("field",{describe:"field to join"}).option("dedup-points",{describe:"uniqify points with the same location and field value",type:"flag"}).option("no-dropouts",{describe:"try to retain all values from the point layer",type:"flag"}).option("postprocess",{alias_to:"contiguous"}).option("contiguous",{describe:"remove non-contiguous data islands",type:"flag"}).option("target",e),x.command("point-to-grid").option("interval",{type:"number"}).option("radius",{type:"number"}).option("circles",{type:"flag"}).option("cell-margin",{type:"number"}).option("aligned",{type:"flag"}).option("calc",u).option("name",t).option("target",e).option("no-replace",n),x.command("require").describe("require a Node module for use in -each expressions").option("module",{DEFAULT:!0,describe:"name of Node module or path to module file"}).option("alias",{describe:"Set the module name to an alias"}).option("init",{describe:"JS expression to run after the module loads"}),x.command("rotate").option("rotation",{DEFAULT:!0,type:"numbers"}).option("invert",{type:"flag"}),x.command("run").describe("create commands on-the-fly and run them").option("include",{}).option("commands",{DEFAULT:!0,describe:"command string or JS expresson to generate command(s)"}).option("target",e),x.command("scalebar").option("top",{}).option("right",{}).option("bottom",{}).option("left",{}).option("font-size",{}).option("label-position",{}).option("label-text",{}),x.command("shape").describe("create a polyline or polygon from coordinates").option("coordinates",{describe:"list of vertices as x,y,x,y...",type:"numbers"}).option("offsets",{describe:"list of vertices as offsets from coordinates list",type:"numbers"}).option("closed",{describe:"close an open path to create a polygon",type:"flag"}).option("type",{DEFAULT:!0}).option("center",{type:"numbers"}).option("radius",{type:"number"}).option("radius-angle",{type:"number"}).option("bbox",{type:"numbers"}).option("geometry",{}).option("rotation",{type:"numbers"}).option("name",t),x.command("subdivide").describe("recursively split a layer using a JS expression").validate(ep).option("expression",{DEFAULT:!0,describe:"boolean JS expression"}).option("target",e),x.section("Control flow commands");var _={expression:{DEFAULT:!0,describe:"JS expression"},layer:{describe:"name or id of layer to test (default is current target)"},target:e};return x.command("if").describe("run the following commands if a condition is met").options(_),x.command("elif").describe("test an alternate condition; used after -if").options(_),x.command("else").describe("run commands if all preceding -if/-elif conditions are false"),x.command("endif").describe("mark the end of an -if sequence"),x.command("ignore").option("empty",{describe:"ignore empty files",type:"flag"}).option("target",e),x.command("stop").describe("stop processing (skip remaining commands)"),x.section("Informational commands"),x.command("calc").describe("calculate statistics about the features in a layer").example("Calculate the total area of a polygon layer\n$ mapshaper polygons.shp -calc 'sum($.area)'").example("Count census blocks in NY with zero population\n$ mapshaper ny-census-blocks.shp -calc 'count()' where='POPULATION == 0'").validate(ep).option("expression",{DEFAULT:!0,describe:"functions: sum() average() median() max() min() count()"}).option("where",m).option("target",e),x.command("colors").describe("print list of color scheme names"),x.command("comment").describe("add a comment to the sequence of commands").flag("multi_arg"),x.command("encodings").describe("print list of supported text encodings (for .dbf import)"),x.command("help").alias("h").describe("print help; takes optional command name").option("command",{DEFAULT:!0,describe:"view detailed information about a command"}),x.command("info").describe("print information about data layers").option("target",e),x.command("inspect").describe("print information about a feature").option("expression",{DEFAULT:!0,describe:"boolean JS expression for selecting a feature"}).option("target",e).validate(ep),x.command("print").describe("print a message to stdout").flag("multi_arg"),x.command("projections").describe("print list of supported projections"),x.command("quiet").describe("inhibit console messages"),x.command("verbose").describe("print verbose processing messages"),x.command("version").alias("v").describe("print mapshaper version"),x.command("debug"),x}var gp=[1,"437",2,"850",3,"1252",8,"865",9,"437",10,"850",11,"437",13,"437",14,"850",15,"437",16,"850",17,"437",18,"850",19,"932",20,"850",21,"437",22,"850",23,"865",24,"437",25,"437",26,"850",27,"437",28,"863",29,"850",31,"852",34,"852",35,"852",36,"860",37,"850",38,"866",55,"850",64,"852",77,"936",78,"949",79,"950",80,"874",87,"1252",88,"1252",89,"1252",100,"852",101,"866",102,"865",103,"861",106,"737",107,"857",108,"863",120,"950",121,"949",122,"936",123,"932",124,"874",134,"737",135,"852",136,"857",200,"1250",201,"1251",202,"1254",203,"1253",204,"1257"],mp={932:"Japanese",936:"Simplified Chinese",950:"Traditional Chinese",1252:"Western European",949:"Korean",874:"Thai",1250:"Eastern European",1251:"Russian",1254:"Turkish",1253:"Greek",1257:"Baltic"};function yp(e,t,n){for(var r,i=e.position(),a=0,o=0;o<t&&0!==(r=e.readUint8());o++)(a>0||32!=r)&&(n[a++]=r);for(;a>0&&32==n[a-1];)a--;return e.position(i+t),a}function vp(e){var n=e||"ascii",r=xr(n),i=t.createBuffer(256);return"utf8"==r||"ascii"==r?function(e,t){var n=yp(e,t,i);return i.toString(r,0,n)}:function(e,t){var r,a,o=yp(e,t,i),s="";for(r=0;r<o;r++){if((a=i[r])>127)return _r(i,n,0,o);s+=String.fromCharCode(a)}return s}}function bp(e,t){for(var n=0;n<t;n++)if(e[n]>=128)return!0;return!1}function xp(e,t){return e.readInt32()}function _p(e,t){var n=e.readCString(t),r=null;return/[ty]/i.test(n)?r=!0:/[fn]/i.test(n)&&(r=!1),r}function wp(e,t){var n=e.readCString(t),r=n.substr(0,4),i=n.substr(4,2),a=n.substr(6,2);return new Date(Date.UTC(+r,+i-1,+a))}function Sp(e,n){var r,i,a=t.isString(e)?new Od(e,{cacheSize:33554432,bufferSize:4194304}):new jd(e),o=function(e){var t=e.readToBinArray(0,Math.min(8193,e.size()));t.position(0).littleEndian();var n,r={version:t.readInt8(),updateYear:t.readUint8(),updateMonth:t.readUint8(),updateDay:t.readUint8(),recordCount:t.readUint32(),dataOffset:t.readUint16(),recordSize:t.readUint16(),incompleteTransaction:t.skipBytes(2).readUint8(),encrypted:t.readUint8(),mdx:t.skipBytes(12).readUint8(),ldid:t.readUint8()},i=1;for(t.skipBytes(2),r.fields=[];13!=t.peek()&&10!=t.peek()&&t.position()<r.dataOffset-1;)(n=u(t)).columnOffset=i,r.fields.push(n),i+=n.size;return i!=r.recordSize&&lt("Record length mismatch; header:",r.recordSize,"detected:",i),13!=t.peek()&&ht("Found a non-standard DBF header terminator ("+t.peek()+"). DBF file may be corrupted."),r}(a);function s(){if(!r){var e="ascii";l(),g().length>0&&(e=d()),r=o.fields.map((function(n){var r=t.extend({},n);return r.name=Sr(n.namebuf,e),r})),zr(t.pluck(r,"name")).forEach((function(e,t){r[t].name=e}))}}function u(e){var n=t.createBuffer(11),r=yp(e,11,n);return{namebuf:t.createBuffer(n.slice(0,r)),type:String.fromCharCode(e.readUint8()),address:e.readUint32(),size:e.readUint8(),decimals:e.readUint8(),id:e.skipBytes(2).readUint8(),position:e.skipBytes(2).readUint8(),indexFlag:e.skipBytes(7).readUint8()}}function c(){return s(),t.pluck(r,"name")}function f(e){return o.dataOffset+o.recordSize*e}function l(){i=n||function(){var e,n,r,i,s=o.ldid,u=(r=s,-1==(i=gp.indexOf(r))?null:gp[i+1]),c=function(){var e,n,r,i,s,u,c=[],l=o.fields.filter((function(e){return"C"==e.type})),d=l.length,p=Math.min(o.recordCount,1e4),h=t.createBuffer(256),m={};c=g();for(var y=0;y<p;y++){u=(s=a.readToBinArray(f(y),o.recordSize)).position();for(var v=0;v<d&&!(c.length>=50);v++)e=l[v],s.position(u+e.columnOffset),(n=yp(s,e.size,h))>0&&bp(h,n)&&(i=(r=t.createBuffer(h.slice(0,n))).toString("hex"))in m==0&&(m[i]=!0,c.push(r))}return c}(),l=0===c.length;return u&&87!=s?e=u:l&&(e="ascii"),e||(e=function(e){var t=null;return function(e){return-1==Ud("utf8",e).indexOf("�")}(e)?t="utf8":function(e){var t="abcdefghijklmnopqrstuvwxyz0123456789.'\"?+-\n,:;/|_$% ",n=Ud("win1252",e),r=qd(n,t);return qd(n,"ßàáâãäåæçèéêëìíîïðñòóôõöøùúûüýÿ°–±’‘"+t)>.97&&r>=.6}(e)&&(t="win1252"),t}(c)),e&&c.length>0&&(ht(n="Detected DBF text encoding: "+e+(e in mp?" ("+mp[e]+")":"")),yt(n="\nSample text containing non-ascii characters:"+((n=St((n=Ud(e,c)).split("\n"))).length>60?"\n":"")+n)),e}(),i||(i="utf8",dt('Unable to auto-detect the text encoding of the DBF file.\nTo avoid corrupted text, re-import using the "encoding=" option.\nTo see a list of supported encodings, run the "encodings" command.'))}function d(){return i||l(),i}function p(){s();var e,t=r.map(h),n=(e=c().map((function(e,t){return JSON.stringify(e)+": arguments["+t+"]"})),new Function("return {"+e.join(",")+"};")),i=[];return function(e){var s,u,c=a.readToBinArray(f(e),o.recordSize),l=c.position();(c.bytesLeft()<o.recordSize||c.bytesLeft()==o.recordSize&&26==c.peek(c.size()-1))&&dt("Invalid DBF file: encountered end-of-file while reading data");for(var d=0,p=r.length;d<p;d++)s=l+(u=r[d]).columnOffset,c.position(s),i[d]=t[d](c,u.size);return n.apply(null,i)}}function h(e){var t,n=e.type,r=null;return"I"==n?r=xp:"F"==n||"N"==n?(t=vp("ascii"),r=function(e,n){var r,i=t(e,n);return i.indexOf(",")>=0&&(i=i.replace(",",".")),r=parseFloat(i),isNaN(r)?null:r}):"L"==n?r=_p:"D"==n?r=wp:"C"==n?r=vp(d()):(ht('Field "'+e.name+'" has an unsupported type ('+e.type+") -- converting to null values"),r=function(){return null}),r}function g(){var e=[];return o.fields.forEach((function(t){bp(t.namebuf,t.namebuf.length)&&e.push(t.namebuf)})),e}this.size=function(){return o.recordCount},this.readRow=function(e){return p()(e)},this.getFields=c,this.getBuffer=function(){return a.readSync(0,a.size())},this.deleteField=function(e){s(),r=r.filter((function(t){return t.name!=e}))},this.readRows=function(){for(var e=p(),t=[],n=0,r=this.size();n<r;n++)t.push(e(n));return t}}function Ap(e,t){return new Ip(e,(t||{}).encoding)}function Ip(e,t){var n,r=new Sp(e,t),i=!1;function a(){return n||(n=new Vr(r.readRows()),r=null,e=null),n}this.exportAsDbf=function(e){if(r&&!i&&!e.field_order&&!e.encoding)try{return r.getBuffer()}catch(e){}return Sl.exportRecords(a().getRecords(),e.encoding,e.field_order)},this.getReadOnlyRecordAt=function(e){return r?r.readRow(e):n.getReadOnlyRecordAt(e)},this.deleteField=function(e){n?n.deleteField(e):(i=!0,r.deleteField(e))},this.getRecords=function(){return a().getRecords()},this.getFields=function(){return r?r.getFields():n.getFields()},this.isEmpty=function(){return r?0===this.size():n.isEmpty()},this.size=function(){return r?r.size():n.size()}}Object.assign(Ip.prototype,Vr.prototype);var Mp=Object.freeze({__proto__:null,importDbfTable:Ap,ShapefileTable:Ip});function Pp(e){return[Wl.POLYGON,Wl.POLYGONM,Wl.POLYGONZ].includes(e)?"polygon":[Wl.POLYLINE,Wl.POLYLINEM,Wl.POLYLINEZ].includes(e)?"polyline":[Wl.POINT,Wl.POINTM,Wl.POINTZ,Wl.MULTIPOINT,Wl.MULTIPOINTM,Wl.MULTIPOINTZ].includes(e)?"point":null}function Ep(e){return[0,1,3,5,8,11,13,15,18,21,23,25,28].includes(e)}var jp=Object.freeze({__proto__:null,translateShapefileType:Pp,isSupportedShapefileType:Ep});function Op(e){var t,n,r=Wl.hasBounds(e),i=Wl.isMultiPartType(e),a=Wl.isZType(e),o=Wl.isMType(e),s=!r,u=s?0:16;t=function(t,n){var r=t.position();if(this.id=t.bigEndian().readUint32(),this.type=t.littleEndian().skipBytes(4).readUint32(),0===this.type||0===e)return{id:this.id,isNull:!0,pointCount:0,partCount:0,byteLength:12};(n>0!=1||this.type!=e&&0!==this.type)&&lt("Unable to read a shape -- .shp file may be corrupted"),this.byteLength=n,s?(this.pointCount=1,this.partCount=1):(t.skipBytes(32),this.partCount=i?t.readUint32():1,this.pointCount=t.readUint32()),this._data=function(){return t.position(r)}};var c={_xypos:function(){var e=12;return s||(e+=4),r&&(e+=32),i&&(e+=4*this.partCount+4),e},readCoords:function(){if(0===this.pointCount)return null;var e=this.readPartSizes(),t=this._data().skipBytes(this._xypos());return e.map((function(e){return t.readFloat64Array(2*e)}))},readXY:function(){return 0===this.pointCount?new Float64Array(0):this._data().skipBytes(this._xypos()).readFloat64Array(2*this.pointCount)},readPoints:function(){for(var e,t=this.readXY(),n=a?this.readZ():null,r=o&&this.hasM()?this.readM():null,i=[],s=0,u=t.length/2;s<u;s++)e=[t[2*s],t[2*s+1]],n&&e.push(n[s]),r&&e.push(r[s]),i.push(e);return i},readPartSizes:function(){var e,t,n,r=[];if(0===this.pointCount);else if(1==this.partCount)r.push(this.pointCount);else{t=0,n=this._data().skipBytes(56);for(var i=0,a=this.partCount;i<a;i++)(e=(i<a-1?n.readUint32():this.pointCount)-t)>0&&(r.push(e),t+=e)}return r}},f={read:function(){var e=2;return a&&e++,this.hasM()&&e++,this._data().skipBytes(12).readFloat64Array(e)},stream:function(e){var t=this._data().skipBytes(12);e.addPoint(t.readFloat64(),t.readFloat64()),e.endPath()}},l={readBounds:function(){return this._data().skipBytes(12).readFloat64Array(4)},stream:function(e){for(var t,n=this.readPartSizes(),r=this.readXY(),i=0,a=0;i<n.length;){for(t=n[i];t-- >0;)e.addPoint(r[a++],r[a++]);e.endPath(),i++}r.length!=a&&lt("Counting error")},stream2:function(e){for(var t,n=this.readPartSizes(),r=this._data().skipBytes(this._xypos()),i=0;i<n.length;){for(t=n[i];t-- >0;)e.addPoint(r.readFloat64(),r.readFloat64());e.endPath(),i++}},read:function(){for(var e=[],t=this.readPartSizes(),n=this.readPoints(),r=0,i=t.length-1;r<i;r++)e.push(n.splice(0,t[r]));return e.push(n),e}},d={_mpos:function(){var e=this._xypos()+16*this.pointCount;return a&&(e+=8*this.pointCount+u),e},readMBounds:function(){return this.hasM()?this._data().skipBytes(this._mpos()).readFloat64Array(2):null},readM:function(){return this.hasM()?this._data().skipBytes(this._mpos()+u).readFloat64Array(this.pointCount):null},hasM:function(){var e=this._mpos(),t=e+8*this.pointCount+u;return this.byteLength!=e&&(this.byteLength==t||void lt("#hasM() Counting error"))}},p={_zpos:function(){return this._xypos()+16*this.pointCount},readZBounds:function(){return this._data().skipBytes(this._zpos()).readFloat64Array(2)},readZ:function(){return this._data().skipBytes(this._zpos()+u).readFloat64Array(this.pointCount)}};return n=0===e?{}:s?Object.assign(c,f):Object.assign(c,l),a&&Object.assign(n,p),o&&Object.assign(n,d),t.prototype=n,n.constructor=t,t}function Fp(e,n){if(this instanceof Fp==0)return new Fp(e,n);var r,i,a=t.isString(e)?new Od(e):new jd(e),o=function(e){var t={signature:e.bigEndian().readUint32(),byteLength:2*e.skipBytes(20).readUint32(),version:e.littleEndian().readUint32(),type:e.readUint32(),bounds:e.readFloat64Array(4),zbounds:e.readFloat64Array(2),mbounds:e.readFloat64Array(2)};return 9994!=t.signature&&lt("Not a valid .shp file"),Ep(t.type)||lt("Unsupported .shp type:",t.type),t.byteLength!=a.size()&&lt("File size of .shp doesn't match size in header"),t}(a.readToBinArray(0,100)),s=o.type,u=100,c=0,f=0,l=new Op(s);function d(e,t){var n=e.size();if(t+12>n)return null;var r=e.readToBinArray(t,12),i=(r.bigEndian().readUint32(),2*r.readUint32()+8),a=r.littleEndian().readUint32();return t+i<=n&&i>=12&&(0===a||a==s)?(r=e.readToBinArray(t,i),new l(r,i)):null}n&&(i=t.isString(n)?new Od(n):new jd(n),r=i.readToBinArray(0,i.size()).bigEndian()),this.header=function(){return o},this.forEachShape=function(e){for(var t=this.nextShape();t;)e(t),t=this.nextShape()},this.nextShape=function(){var e,t;return a||lt("Tried to read from a used ShpReader"),t=c,e=r?function(e,t,n){if(t.size()<=100+8*n)return null;t.position(100+8*n);var r=n+1,i=2*t.readUint32(),a=(t.readUint32(),d(e,i));return a||dt("Index of Shapefile record",r,"in the .shx file is invalid."),a.id!=r&&(f++,yt(`Warning: A feature has a different record number in .shx (${r}) and .shp (${a.id}).`)),a}(a,r,t):function(e,t,n){for(var r,i,a,o=n+1,c=t,f=e.size(),l=null;c+12<=f;)if(i=(r=e.readToBinArray(c,12)).bigEndian().readUint32(),(a=r.littleEndian().skipBytes(4).readUint32())!=s&&0!==a||i!=o&&0===a)c+=4;else{if(!(l=d(e,c)))break;if(u=c+l.byteLength,i==o)break;i<o?(ht("Found a Shapefile record with the same id as a previous record ("+l.id+") -- skipping."),c+=l.byteLength):dt("Shapefile contains an out-of-sequence record. Possible data corruption -- bailing.")}return l&&c>t&&yt("Skipped over "+(c-t)+" non-data bytes in the .shp file."),l}(a,u,t),e?(c++,e):(a.close(),a=i=r=null,f>0&&ht(`Warning: ${f}/${c} features have non-standard record numbers in the .shp file.`),null)}}function kp(e,t){var n,r=e.arcs;(t.snap||t.auto_snap||t.snap_interval)&&(t.snap_interval&&(n=Ko(t.snap_interval,Wi(e))),r&&Sn(r,n)),e.layers.forEach((function(e){Hr(e)&&Au(e.shapes,r,e.geometry_type)}))}function Np(e){return e[0]>-1e38&&e[1]>-1e38}function Cp(e){var n=1e4,r=new Float64Array(n),i=new Float64Array(n),a=0;this.endPath=function(){e(r,i,a),a=0},this.addPoint=function(e,o){a>=n&&(n=Math.ceil(1.3*n),r=t.extendBuffer(r,n),i=t.extendBuffer(i,n)),r[a]=e,i[a]=o,a++}}function zp(e){var n=e.reserved_points>0?e.reserved_points:2e4,r=new Float64Array(n),i=new Float64Array(n),a=[],o=[],s=[],u=[],c=e.type||null,f=null,l=-1,d=-1,p=0,h=0,g=0;function m(e){var t=d<u.length?u[d]:null;t?t!=e&&dt("Unable to import mixed-geometry features"):(u[d]=e,c?e!=c&&(c="mixed"):c=e)}function y(e){if(e>r.length){var n=Math.max(e,Math.ceil(1.5*r.length));r=t.extendBuffer(r,n,p),i=t.extendBuffer(i,n,p)}}function v(e){(a[d]||(a[d]=[])).push(e)}e.precision&&(f=Uo(e.precision)),t.extend(this,new Cp((function(e,t,n){var a,o,u,d,m=0;y(p+n);for(var b=0;b<n;b++)a=e[b],o=t[b],f&&(a=f(a),o=f(o)),b>0&&a==u&&o==d?h++:(r[p]=a,i[p]=o,p++,m++),d=o,u=a;"polygon"==c&&m>0&&(e[0]==e[n-1]&&t[0]==t[n-1]||(y(p+1),r[p]=e[0],i[p]=t[0],g++,p++,m++)),function(e){l++,s[l]=e,v([l])}(m)}))),this.startShape=function(e){a[++d]=null,e&&(o[d]=e)},this.importLine=function(e){e.length<2?yt("Skipping a defective line"):(m("polyline"),this.importPath(e))},this.importPoints=function(e){m("point"),e=e.filter(Np),f&&e.forEach((function(e){e[0]=f(e[0]),e[1]=f(e[1])})),e.forEach(v)},this.importRing=function(e,t){var n=Dn.getPlanarPathArea2(e);!n||e.length<4?yt("Skipping a defective ring"):(m("polygon"),(!0===t&&n>0||!1===t&&n<0)&&e.reverse(),this.importPath(e))},this.importPath=function(e){for(var t,n=0,r=e.length;n<r;n++)t=e[n],this.addPoint(t[0],t[1]);this.endPath()},this.done=function(){var e,n,f={name:""};return h>0&&yt(t.format("Removed %,d duplicate point%s",h,t.pluralSuffix(h))),g>0&&ht(t.format("Closed %,d open polygon ring%s",g,t.pluralSuffix(g))),p>0&&(p<r.length&&(r=r.subarray(0,p),i=i.subarray(0,p)),e=new da(s,r,i)),"mixed"==c?n=ci(a,o,u):(f={geometry_type:c},c&&(f.shapes=a),o.length>0&&(f.data=new Vr(o)),n=[f]),n.forEach((function(e){e.data&&Or(e.data.getRecords())})),{arcs:e||null,info:{},layers:n}}}Fp.prototype.type=function(){return this.header().type};var Tp=Object.freeze({__proto__:null,cleanPathsAfterImport:kp,pointHasValidCoords:Np,PathImporter:zp});function Lp(e,n,r){var i=new Fp(e,n),a=i.type(),o=Pp(a),s=new zp(t.defaults({type:o,reserved_points:Math.round(i.header().byteLength/16)},r));return Ep(a)||dt("Unsupported Shapefile type:",a),Wl.isZType(a)?ht("Warning: Shapefile Z data will be lost."):Wl.isMType(a)&&ht("Warning: Shapefile M data will be lost."),i.forEachShape((function(e){s.startShape(),e.isNull||("point"==o?s.importPoints(e.readPoints()):e.stream(s))})),s.done()}var Bp=Object.freeze({__proto__:null,importShp:Lp});function Dp(e,n){var r,i,a=n||{},o=Object.keys(mc.pathImporters),s=t.isString(e)?JSON.parse(e):e,u=new Rp(a);return((r="Feature"==s.type?{type:"FeatureCollection",features:[s]}:o.includes(s.type)?{type:"GeometryCollection",geometries:[s]}:s).features||r.geometries||[]).forEach(u.parseObject),qp(i=u.done(),s),i}function Rp(e){var t=e.id_field||mc.ID_FIELD,n=new zp(e);this.parseObject=function(r){var i,a;r&&r.type?"Feature"==r.type?(i=r.geometry,a=r.properties||{},"id"in r&&(a[t]=r.id)):i=r:i=null,i&&"GeometryCollection"==i.type?mc.importComplexFeature(n,i,a,e):e.single_part&&function(e){return e&&e.type&&0===e.type.indexOf("Multi")}(i)?mc.importMultiAsSingles(n,i,a,e):mc.importSimpleFeature(n,i,a,e)},this.done=function(){return n.done()}}function Up(e,t){return t=t||{},e.forEach((function(e){if(e){var n=mc.translateGeoJSONType(e.type);n?(n in t==0&&(t[n]=[]),t[n].push(e)):"GeometryCollection"==e.type&&Up(e.geometries||[],t)}})),Object.values(t)}function qp(e,t){"crs"in t&&(e.info.input_geojson_crs=t.crs)}mc.importComplexFeature=function(e,t,n,r){var i=Up(t.geometries||[]);0!==i.length?i.forEach((function(t,i){e.startShape(Er(n)),t.forEach((function(t){mc.importSimpleGeometry(e,t,r)}))})):e.startShape(n)},mc.importSimpleFeature=function(e,t,n,r){e.startShape(n),mc.importSimpleGeometry(e,t,r)},mc.importMultiAsSingles=function(e,t,n,r){t.coordinates.forEach((function(i,a){var o={type:t.type.substr(5),coordinates:i},s=0===a?n:Er(n);mc.importSimpleFeature(e,o,s,r)}))},mc.importSimpleGeometry=function(e,t,n){var r=t?t.type:null;if(null===r);else if(r in mc.pathImporters){if(n.geometry_type&&n.geometry_type!=mc.translateGeoJSONType(r))return;mc.pathImporters[r](t.coordinates,e)}else yt("Unsupported geometry type:",t.type)},mc.pathImporters={LineString:function(e,t){t.importLine(e)},MultiLineString:function(e,t){for(var n=0;n<e.length;n++)mc.pathImporters.LineString(e[n],t)},Polygon:function(e,t){for(var n=0;n<e.length;n++)t.importRing(e[n],n>0)},MultiPolygon:function(e,t){for(var n=0;n<e.length;n++)mc.pathImporters.Polygon(e[n],t)},Point:function(e,t){t.importPoints([e])},MultiPoint:function(e,t){t.importPoints(e)}};var Gp=Object.freeze({__proto__:null,importGeoJSON:Dp,GeoJSONParser:Rp,importCRS:qp});function Vp(e,n){var r,i,a;return t.isString(e)&&(e=JSON.parse(e)),e.arcs&&e.arcs.length>0&&(e.transform&&Ql.decodeArcs(e.arcs,e.transform),n&&n.precision&&Ql.roundCoords(e.arcs,n.precision),i=new da(e.arcs)),(a=Object.keys(e.objects).reduce((function(t,r){for(var a,o=Ql.importObject(e.objects[r],i,n),s=0,u=o.length;s<u;s++)(a=o[s]).name=r,t.push(a);return t}),[])).forEach((function(t){Hr(t)&&Au(t.shapes,i,t.geometry_type),"point"==t.geometry_type&&e.transform&&Ql.decodePoints(t.shapes,e.transform),t.data&&Or(t.data.getRecords())})),qp(r={layers:a,arcs:i,info:{}},e),e.metadata&&function(e,t){t.proj4&&(e.info.crs=$i(t.proj4))}(r,e.metadata),r}Ql.decodePoints=function(e,t){Nt(e,(function(e){e[0]=e[0]*t.scale[0]+t.translate[0],e[1]=e[1]*t.scale[1]+t.translate[1]}))},Ql.decodeArcs=function(e,t){var n=t.scale[0],r=t.scale[1],i=t.translate[0],a=t.translate[1];e.forEach((function(e){for(var t,o,s,u=0,c=0,f=0,l=e.length;f<l;f++)o=(t=e[f])[0]+u,s=t[1]+c,t[0]=o*n+i,t[1]=s*r+a,u=o,c=s}))},Ql.roundCoords=function(e,t){var n,r=Uo(t);e.forEach((function(e){for(var t=0,i=e.length;t<i;t++)(n=e[t])[0]=r(n[0]),n[1]=r(n[1])}))},Ql.importObject=function(e,t,n){var r=new Ql.GeometryImporter(t,n);return("GeometryCollection"==e.type?e.geometries:[e]).forEach(r.addGeometryObject,r),r.done()},Ql.GeometryImporter=function(e,t){var n,r=t&&t.id_field||mc.ID_FIELD,i=[],a=[],o=[],s=0,u=null;this.addGeometryObject=function(e){var t=e.properties||null;n=a.length,a[n]=null,"id"in e&&((t=t||{})[r]=e.id),i[n]=t,t||s++,e.type&&this.addShape(e)},this.addShape=function(t){var r,i=a[n],o=mc.translateGeoJSONType(t.type);"GeometryCollection"==t.type?t.geometries.forEach(this.addShape,this):o?(this.setGeometryType(o),(r=Ql.shapeImporters[t.type](t,e))&&r.length&&(Array.isArray(r[0])?a[n]=i?i.concat(r):r:dt("Invalid TopoJSON",t.type,"geometry"))):t.type&&dt("Invalid TopoJSON geometry type:",t.type)},this.setGeometryType=function(e){var t=n<o.length?o[n]:null;t?t!=e&&dt("Unable to import mixed-type TopoJSON geometries"):(o[n]=e,this.updateCollectionType(e))},this.updateCollectionType=function(e){u?e&&u!=e&&(u="mixed"):u=e},this.done=function(){return"mixed"==u?ci(a,i,o):[{geometry_type:u,shapes:u?a:null,data:s<a.length?new Vr(i):null}]}},Ql.importPolygonArcs=function(e,t){var n,r=e[0],i=null;if(t||dt("Invalid TopoJSON file: missing arc data."),!(n=r?Dn.getPlanarPathArea(r,t):null))return null;n<0&&$n(r),i=[r];for(var a=1;a<e.length;a++)r=e[a],(n=Dn.getPlanarPathArea(r,t))&&(n>0&&$n(r),i.push(r));return i},Ql.shapeImporters={Point:function(e){return[e.coordinates]},MultiPoint:function(e){return e.coordinates},LineString:function(e){return[e.arcs]},MultiLineString:function(e){return e.arcs},Polygon:function(e,t){return Ql.importPolygonArcs(e.arcs,t)},MultiPolygon:function(e,t){return e.arcs.reduce((function(e,n){var r=Ql.importPolygonArcs(n,t);return r&&(e=e?e.concat(r):r),e}),null)}};var $p,Jp=Object.freeze({__proto__:null,importTopoJSON:Vp}),Yp=123,Wp=34,Hp=44,Xp=4096,Qp=1e7;function Zp(e,t){t>=0&&(e+=" at position "+t),dt(e)}function Kp(e,t){if(e==$p)return Zp("Unexpected end of JSON input");Zp(e==Wp?"Unexpected string in JSON":e<33||e>126?"Unexpected token in JSON":"Unexpected token "+String.fromCharCode(e)+" in JSON",t)}function eh(e,t){t==$p&&Zp("Unterminated string in JSON",e),Zp("Too-long string in JSON",e)}function th(e){return 32==e||10==e||13==e||9==e}function nh(e){for(;th(e.peek());)e.advance()}function rh(e){var t,n,r,i,a=e.index();if(91==e.getChar()&&hh(e.peek())&&(t=mh(e),r=e.getChar(),nh(e),r==Hp&&hh(e.peek()))){if(n=mh(e),93==(i=e.getChar()))return[t,n];if(i==Hp)return function(e,t){nh(e);do{e.refresh(),t.push(sh(e))}while(uh(e,Hp,93)==Hp);return t}(e,[t,n])}return e.index(a),sh(e)}function ih(e,t){for(var n=0;n<t.length;n++)ah(e,t.charCodeAt(n));return!0}function ah(e,t){var n=e.getChar();n!=t&&Kp(n,e.index()-1)}function oh(e,t){return nh(e),e.peek()===t?(e.advance(),nh(e),t):null}function sh(e){var t,n=e.peek();return hh(n)?t=mh(e):91==n?t=function(e){var t,n=[];for(ah(e,91),t=oh(e,93);93!=t;)e.refresh(),n.push(rh(e)),t=uh(e,Hp,93);return n}(e):n==Wp?t=lh(e):n==Yp?t=ch(e):110==n?t=ih(e,"null")&&null:116==n?t=ih(e,"true")&&!0:102==n?t=ih(e,"false")&&!1:Kp(n,e.index()),t}function uh(e,t,n){nh(e);var r=e.getChar();return r!=t&&r!=n&&Kp(r,e.index()-1),nh(e),r}function ch(e){var t,n,r={};for(ah(e,Yp),n=oh(e,125);125!=n;)e.refresh(),t=fh(e),nh(e),ah(e,58),nh(e),r[t]="type"==t&&e.peek()==Wp?fh(e):sh(e),n=uh(e,Hp,125);return r}function fh(e){var t=e.index(),n=e.cache,r=!1,i=0;ah(e,Wp);for(var a=e.getChar();a!=Wp||!0===r;)++i>2e3&&eh(t,a),r?r=!1:92==a&&(r=!0),n[a]||(n[a]=[]),n=n[a],a=e.getChar();return n[0]||(e.index(t),n[0]=lh(e)),n[0]}function lh(e){var t=e.index();ah(e,Wp);for(var n=0,r="",i=e.getChar();i!=Wp;){if(++n>256||92==i||i<32||i>126)return e.index(t),dh(e);r+=String.fromCharCode(i),i=e.getChar()}return r}function dh(e){e.refresh();var t=Xp-2,n=e.index(),r=0,i=!1;ah(e,Wp);for(var a,o=e.getChar();o!=Wp||!0===i;){if(++r>t)return o!=$p&&(Xp*=2)<=5e6||eh(n,o),e.index(n),dh(e);i?i=!1:92==o&&(i=!0),o=e.getChar()}return a=JSON.parse(e.toString(n,r+2)),e.refresh(),a}function ph(e){return e>=48&&e<=57}function hh(e){return e>=48&&e<=57||45==e}function gh(e){return e>=48&&e<=57||45==e||46==e||43==e||69==e||101==e}function mh(e){var t,n,r=e.index(),i=0,a=1,o=1,s=!1,u=!1,c=e.getChar();for(45===c&&(o=-1,c=e.getChar()),t=c;ph(c);)i=10*i+(n=c-48),c=e.getChar();if(i>0&&48===t&&(u=!0),46==c){for(;ph(c=e.getChar());)a*=10,i=10*i+(n=c-48);1!=a&&46!=t||(u=!0)}return 0===i&&48!=t&&(u=!0),u&&Zp("Invalid number in JSON",r),a>1e22&&(s=!0),i>=9007199254740992&&(i>=0x40000000000000||1==(1&n))&&(s=!0),s||69==c||101==c?(e.index(r),function(e){for(var t=e.index(),n=0;gh(e.getChar());)n++;e.back();var r=e.toString(t,n),i=Number(r);return isNaN(i)&&Zp("Invalid number in JSON",t),i}(e)):(e.back(),o*i/a)}function yh(e,t){var n=e.size(),r=t,i=e.readSync(r,Qp),a=0,o={peek:function(){return i[a]},getChar:function(){return i[a++]},advance:function(){a++},back:function(){a--},toString:function(e,t){var n=e-r;return i.toString("utf8",n,n+t)},index:function(e){if(e>=0==0)return a+r;a=e-r},refresh:s,cache:[]};return s(),o;function s(){i.length-a>=Xp||r+i.length>=n||(r+=a,a=0,i=e.readSync(r,Qp))}}function vh(e){this.readObjects=function(t){var n=e.findString('"features"',5e3)||e.findString('"geometries"',5e3),r=n?n.offset:0;tc.start(),function(e,t,n){var r=yh(e,t);for(function(e){for(var t=e.getChar(),n=0;t!=$p&&n<Xp;){if(n++,t==Yp)return e.back(),!0;t=e.getChar()}}(r);r.peek()==Yp;)n(ch(r)),oh(r,Hp)}(e,r,t),vt("Parse GeoJSON",tc.stop())}}function bh(e,t){var n=null;return e.length>1e3&&(e=e.substr(0,1e3)),e=e.replace(/\s/g,""),t&&t.json_path||/^\[[{\]]/.test(e)?n="json":/"arcs":\[|"objects":\{|"transform":\{/.test(e)?n="topojson":/^\{"/.test(e)&&(n="geojson"),n}function xh(e){var n=null;return e&&("Topology"==e.type?n="topojson":e.type?n="geojson":t.isArray(e)&&(n="json")),n}function _h(e,t){var n=new Rp(t);return new vh(e).readObjects(n.parseObject),n.done()}function wh(e,n){var r,i,a=e.content,o=e.filename,s={filename:o};if(a?a instanceof ArrayBuffer&&(a.byteLength<1e7?a=_r(t.createBuffer(a)):(r=new jd(a),a=null)):r=new Od(o),r&&(e=function(e,t){var n;return n="geojson"==bh(Pd(e,1e3),t)?{dataset:_h(e,t),format:"geojson"}:{content:e.toString("utf8")},e.close(),n}(r,n),e.dataset?(s.dataset=e.dataset,s.format=e.format):a=e.content),a){if(t.isString(a))try{a=JSON.parse(a)}catch(e){dt("JSON parsing error --",e.message)}n.json_path?(i=xh(a=function(e,t){for(var n,r,i,a=/(.*)\[([0-9]+)\]$/,o=t.indexOf("/")>0?"/":".",s=t.split(o);s.length>0;)if(n=s.shift(),!(e=(i=a.exec(n))?(r=e[i[1]])&&r[+i[2]]||null:e[n]))return null;return e}(a,n.json_path)))||dt("Unexpected object type at JSON path:",n.json_path):i=xh(a),"topojson"==i?s.dataset=Vp(a,n):"geojson"==i?s.dataset=Dp(a,n):"json"==i?s.dataset=rd(a):dt("Unknown JSON format"),s.format=i}return s}var Sh=Object.freeze({__proto__:null,identifyJSONString:bh,identifyJSONObject:xh,importGeoJSONFile:_h,importJSON:wh});function Ah(e,n){var r,i,a;return n=n||{},e.json?(i=(a=wh(e.json,n)).format,kp(r=a.dataset,n)):e.text?(i="dsv",r=Gd(a=e.text,n)):e.shp?(i="shapefile",a=e.shp,r=function(e,n){var r,i=Lp(e.shp.content||e.shp.filename,e.shx?e.shx.content||e.shx.filename:null,n),a=i.layers[0];return e.dbf&&(r=Ih(e,n),t.extend(i.info,r.info),a.data=r.layers[0].data,a.shapes&&a.data.size()!=a.shapes.length&&ht("Mismatched .dbf and .shp record count -- possible data loss.")),e.prj&&(i.info.prj=e.prj.content),e.cpg&&(i.info.cpg=e.cpg.content),i}(e,n),kp(r,n)):e.dbf?(i="dbf",a=e.dbf,r=Ih(e,n)):e.prj?(i="prj",r={layers:[],info:{prj:(a=e.prj).content}}):e.kml&&(i="kml",r=function(e,t){var n=lr("@tmcw/togeojson"),r="undefined"==typeof DOMParser?lr("@xmldom/xmldom").DOMParser:DOMParser;return Dp(n.kml((new r).parseFromString(e,"text/xml")),t||{})}((a=e.kml).content,n)),r||dt("Missing an expected input type"),r.arcs&&!n.no_topology&&"topojson"!=i&&ya(r),"topojson"!=i&&r.layers.forEach((function(e){e.name||(e.name=function(e){var t="layer1",n=Xa(e);return n.basename&&n.extension&&(t=n.basename),t}(a.filename||""))})),a.filename&&(r.info.input_files=[a.filename]),r.info.input_formats=[i],r}function Ih(e,n){return n=t.extend({},n),e.cpg&&!n.encoding&&(n.encoding=e.cpg.content),{info:{},layers:[{data:Ap(e.dbf.content||e.dbf.filename,n)}]}}var Mh=Object.freeze({__proto__:null,importContent:Ah,importFileContent:function(e,t,n){var r={};return r[cd(t,e)]={filename:t,content:e},Ah(r,n)}});function Ph(e,n){var r=!1,i=Sa(e.map((function(e){var i=jh(e,t.defaults({no_topology:!0,snap:!1,snap_interval:null,files:[e]},n));return i.arcs&&i.arcs.size()>0&&"topojson"!=i.info.input_formats[0]&&(r=!0),i})));return r&&!n.no_topology&&(kp(i,n),ya(i)),i}var Eh=Object.freeze({__proto__:null,importFiles:Ph});function jh(e,t){return Oh(e,t)}nu.importFiles=function(e){var t,n=e.files||[];return e.stdin?jh("/dev/stdin",e):(n.length>0==0&&dt("Missing input file(s)"),yt("Importing: "+n.join(" ")),1==n.length?t=jh(n[0],e):e.merge_files?(t=Ph(n,e)).layers=nu.mergeLayers(t.layers):e.combine_files?t=Ph(n,e):dt("Invalid inputs"),t)};var Oh=function(e,n){var r,i=sd(e),a={},o=n&&n.encoding||null,s=n&&n.input||null,u=s&&e in s;return io.checkFileExists(e,s),"shp"!=i&&"json"!=i&&"text"!=i&&"dbf"!=i||u?i&&hd(e)?(r=io.readFile(e,null,s),t.isString(r)&&dt("Expected binary content, received a string")):i?r=io.readFile(e,o||"utf-8",s):"text"==(i=ud(r=io.readFile(e,o||"utf-8",s)))&&r.indexOf("�")>-1&&(i=null):r=null,i||dt(function(e){var t="Unable to import "+e;return"zip"==Za(e).toLowerCase()?t+=" (ZIP files must be unpacked before running mapshaper)":t+=" (unknown file type)",t}(e)),a[i]={filename:e,content:r},r=null,"shp"!=i&&"dbf"!=i||function(e,t,n){var r=eo(e,"dbf"),i=eo(e,"shx"),a=eo(e,"cpg"),o=eo(e,"prj");io.isFile(o,n)&&(t.prj={filename:o,content:io.readFile(o,"utf-8",n)}),io.isFile(i,n)&&(t.shx={filename:i,content:io.readFile(i,null,n)}),!t.dbf&&io.isFile(r,n)&&(t.dbf={filename:r,content:n&&r in n?io.readFile(r,null,n):null}),t.dbf&&io.isFile(a,n)&&(t.cpg={filename:a,content:io.readFile(a,"utf-8",n).trim()})}(e,a,s),"shp"!=i||a.dbf||ht(t.format("[%s] .dbf file is missing - shapes imported without attribute data.",e)),Ah(a,n)},Fh=Object.freeze({__proto__:null,replaceImportFile:function(e){Oh=e},importFile:jh});function kh(e,t){return function(e){return/[$][{]/.test(e)}(e)?((t.length>1||1!=t[0].layers.length)&&dt("Interpolated names are not compatible with multiple targets."),Nh(e,t[0].layers[0])):e}function Nh(e,t){var n={target:t.name||""},r="with($$ctx) { return `"+e+"`; }";try{e=new Function("$$ctx",r)(n)}catch(t){dt("Unable to interpolate ["+e+"]")}return e}function Ch(e,n,r){var i,a=n.findSingleLayer(e);return a||((i=jh(e,t.defaults({no_topology:!0},r)))?i.layers.length>1&&dt("Multiple-layer sources are not supported"):dt(t.format("Unable to find source [%s]",e)),a={dataset:i,layer:i.layers[0],disposable:!0}),a}var zh=Object.freeze({__proto__:null,convertSourceName:kh,convertInterpolatedName:Nh,findCommandSource:Ch});function Th(){var e=[],t=[];function n(e,t){return{layer:e,dataset:t}}function r(e,t){var n=-1;return t.forEach((function(t,r){t.layer==e&&(n=r)})),n}this.forEachLayer=function(t){var n=0;e.forEach((function(e){e.layers.forEach((function(r){t(r,e,n++)}))}))},this.deleteLayer=function(e,n){this.getActiveLayer().layer==e&&(t=[]),n.layers.splice(n.layers.indexOf(e),1),0===n.layers.length&&this.removeDataset(n),t=t.filter((function(t){var n=t.layers.indexOf(e);return-1==n||(t.layers.splice(n,1),t.layers.length>0)}))},this.findLayer=function(e){var t="function"==typeof e?e:null,r=null;return this.forEachLayer((function(i,a){(t?t(i,a):i==e)&&(r=n(i,a))})),r},this.findCommandTargets=function(e,t){return e?Ns(this.getLayers(),e,t):this.getDefaultTargets()||[]},this.findSingleLayer=function(e){var t=zs(this.getLayers(),e);return t.length>1&&dt("Ambiguous pattern (multiple layers were matched):",e),t[0]||null},this.removeDataset=function(n){t=t.filter((function(e){return e.dataset!=n})),e=e.filter((function(e){return e!=n}))},this.getDatasets=function(){return e},this.getLayers=function(){var e=[];return this.forEachLayer((function(t,r){e.push(n(t,r))})),e},this.addDataset=function(e){return this.setDefaultTarget(e.layers,e),this},this.findNextLayer=function(e){var t=this.getLayers(),n=r(e,t);return n>-1?t[(n+1)%t.length]:null},this.findPrevLayer=function(e){var t=this.getLayers(),n=r(e,t);return n>-1?t[(n-1+t.length)%t.length]:null},this.isEmpty=function(){return 0===e.length},this.getDefaultTargets=function(){return 0!==t.length||this.isEmpty()||(t=[{dataset:e[0],layers:e[0].layers.slice(0,1)}]),t},this.setDefaultTarget=function(n,r){-1==e.indexOf(r)&&e.push(r),t=[{layers:n.concat(),dataset:r}]},this.setDefaultTargets=function(e){t=e},this.getActiveLayer=function(){var e=(this.getDefaultTargets()||[])[0],t=e.layers[e.layers.length-1];return e?{layer:t,dataset:e.dataset}:null}}function Lh(e){var t=[];return e.forEachLayer((function(e,n,r){t.push("  ["+(r+1)+"]  "+(e.name||"[unnamed]"))})),t.length>0?t.join("\n"):"[none]"}var Bh=Object.freeze({__proto__:null,Catalog:Th,getFormattedLayerList:Lh});function Dh(e){var t,n={catalog:e||new Th,defs:{},settings:{},input_files:[],initSettings:function(e){n.settings=e,Rh(n,{})},startCommand:function(e){t=e,Rh(n,e)},endCommand:function(){t=null,o()},resumeCommand:function(){Rh(n,t)}};return n}function Rh(e,t){o(),i("current_command",t.name),i("DEBUG",e.settings.DEBUG||t.debug),i("VERBOSE",e.settings.VERBOSE||t.verbose),i("QUIET",e.settings.QUIET||t.quiet),i("defs",e.defs),i("input_files",e.input_files)}const Uh=134217729;function qh(e,t,n,r,i){let a,o,s,u,c=t[0],f=r[0],l=0,d=0;f>c==f>-c?(a=c,c=t[++l]):(a=f,f=r[++d]);let p=0;if(l<e&&d<n)for(f>c==f>-c?(o=c+a,s=a-(o-c),c=t[++l]):(o=f+a,s=a-(o-f),f=r[++d]),a=o,0!==s&&(i[p++]=s);l<e&&d<n;)f>c==f>-c?(o=a+c,u=o-a,s=a-(o-u)+(c-u),c=t[++l]):(o=a+f,u=o-a,s=a-(o-u)+(f-u),f=r[++d]),a=o,0!==s&&(i[p++]=s);for(;l<e;)o=a+c,u=o-a,s=a-(o-u)+(c-u),c=t[++l],a=o,0!==s&&(i[p++]=s);for(;d<n;)o=a+f,u=o-a,s=a-(o-u)+(f-u),f=r[++d],a=o,0!==s&&(i[p++]=s);return 0===a&&0!==p||(i[p++]=a),p}function Gh(e){return new Float64Array(e)}const Vh=Gh(4),$h=Gh(8),Jh=Gh(12),Yh=Gh(16),Wh=Gh(4);function Hh(e,t,n,r,i,a){const o=(t-a)*(n-i),s=(e-i)*(r-a),u=o-s;if(0===o||0===s||o>0!=s>0)return u;const c=Math.abs(o+s);return Math.abs(u)>=33306690738754716e-32*c?u:-function(e,t,n,r,i,a,o){let s,u,c,f,l,d,p,h,g,m,y,v,b,x,_,w,S,A;const I=e-i,M=n-i,P=t-a,E=r-a;x=I*E,d=Uh*I,p=d-(d-I),h=I-p,d=Uh*E,g=d-(d-E),m=E-g,_=h*m-(x-p*g-h*g-p*m),w=P*M,d=Uh*P,p=d-(d-P),h=P-p,d=Uh*M,g=d-(d-M),m=M-g,S=h*m-(w-p*g-h*g-p*m),y=_-S,l=_-y,Vh[0]=_-(y+l)+(l-S),v=x+y,l=v-x,b=x-(v-l)+(y-l),y=b-w,l=b-y,Vh[1]=b-(y+l)+(l-w),A=v+y,l=A-v,Vh[2]=v-(A-l)+(y-l),Vh[3]=A;let j=function(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}(4,Vh),O=22204460492503146e-32*o;if(j>=O||-j>=O)return j;if(l=e-I,s=e-(I+l)+(l-i),l=n-M,c=n-(M+l)+(l-i),l=t-P,u=t-(P+l)+(l-a),l=r-E,f=r-(E+l)+(l-a),0===s&&0===u&&0===c&&0===f)return j;if(O=11093356479670487e-47*o+33306690738754706e-32*Math.abs(j),j+=I*f+E*s-(P*c+M*u),j>=O||-j>=O)return j;x=s*E,d=Uh*s,p=d-(d-s),h=s-p,d=Uh*E,g=d-(d-E),m=E-g,_=h*m-(x-p*g-h*g-p*m),w=u*M,d=Uh*u,p=d-(d-u),h=u-p,d=Uh*M,g=d-(d-M),m=M-g,S=h*m-(w-p*g-h*g-p*m),y=_-S,l=_-y,Wh[0]=_-(y+l)+(l-S),v=x+y,l=v-x,b=x-(v-l)+(y-l),y=b-w,l=b-y,Wh[1]=b-(y+l)+(l-w),A=v+y,l=A-v,Wh[2]=v-(A-l)+(y-l),Wh[3]=A;const F=qh(4,Vh,4,Wh,$h);x=I*f,d=Uh*I,p=d-(d-I),h=I-p,d=Uh*f,g=d-(d-f),m=f-g,_=h*m-(x-p*g-h*g-p*m),w=P*c,d=Uh*P,p=d-(d-P),h=P-p,d=Uh*c,g=d-(d-c),m=c-g,S=h*m-(w-p*g-h*g-p*m),y=_-S,l=_-y,Wh[0]=_-(y+l)+(l-S),v=x+y,l=v-x,b=x-(v-l)+(y-l),y=b-w,l=b-y,Wh[1]=b-(y+l)+(l-w),A=v+y,l=A-v,Wh[2]=v-(A-l)+(y-l),Wh[3]=A;const k=qh(F,$h,4,Wh,Jh);x=s*f,d=Uh*s,p=d-(d-s),h=s-p,d=Uh*f,g=d-(d-f),m=f-g,_=h*m-(x-p*g-h*g-p*m),w=u*c,d=Uh*u,p=d-(d-u),h=u-p,d=Uh*c,g=d-(d-c),m=c-g,S=h*m-(w-p*g-h*g-p*m),y=_-S,l=_-y,Wh[0]=_-(y+l)+(l-S),v=x+y,l=v-x,b=x-(v-l)+(y-l),y=b-w,l=b-y,Wh[1]=b-(y+l)+(l-w),A=v+y,l=A-v,Wh[2]=v-(A-l)+(y-l),Wh[3]=A;const N=qh(k,Jh,4,Wh,Yh);return Yh[N-1]}(e,t,n,r,i,a,c)}Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(8),Gh(8),Gh(8),Gh(4),Gh(8),Gh(8),Gh(8),Gh(12),Gh(192),Gh(192),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(8),Gh(8),Gh(8),Gh(8),Gh(8),Gh(8),Gh(8),Gh(8),Gh(8),Gh(4),Gh(4),Gh(4),Gh(8),Gh(16),Gh(16),Gh(16),Gh(32),Gh(32),Gh(48),Gh(64),Gh(1152),Gh(1152),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(4),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(24),Gh(1152),Gh(1152),Gh(1152),Gh(1152),Gh(1152),Gh(2304),Gh(2304),Gh(3456),Gh(5760),Gh(8),Gh(8),Gh(8),Gh(16),Gh(24),Gh(48),Gh(48),Gh(96),Gh(192),Gh(384),Gh(384),Gh(384),Gh(768),Gh(96),Gh(96),Gh(96),Gh(1152);const Xh=Math.pow(2,-52),Qh=new Uint32Array(512);class Zh{static from(e,t=ig,n=ag){const r=e.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=e[a];i[2*a]=t(r),i[2*a+1]=n(r)}return new Zh(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=e.length>>1;let o=1/0,s=1/0,u=-1/0,c=-1/0;for(let t=0;t<a;t++){const n=e[2*t],r=e[2*t+1];n<o&&(o=n),r<s&&(s=r),n>u&&(u=n),r>c&&(c=r),this._ids[t]=t}const f=(o+u)/2,l=(s+c)/2;let d,p,h,g=1/0;for(let t=0;t<a;t++){const n=Kh(f,l,e[2*t],e[2*t+1]);n<g&&(d=t,g=n)}const m=e[2*d],y=e[2*d+1];g=1/0;for(let t=0;t<a;t++){if(t===d)continue;const n=Kh(m,y,e[2*t],e[2*t+1]);n<g&&n>0&&(p=t,g=n)}let v=e[2*p],b=e[2*p+1],x=1/0;for(let t=0;t<a;t++){if(t===d||t===p)continue;const n=tg(m,y,v,b,e[2*t],e[2*t+1]);n<x&&(h=t,x=n)}let _=e[2*h],w=e[2*h+1];if(x===1/0){for(let t=0;t<a;t++)this._dists[t]=e[2*t]-e[0]||e[2*t+1]-e[1];ng(this._ids,this._dists,0,a-1);const t=new Uint32Array(a);let n=0;for(let e=0,r=-1/0;e<a;e++){const i=this._ids[e];this._dists[i]>r&&(t[n++]=i,r=this._dists[i])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Hh(m,y,v,b,_,w)<0){const e=p,t=v,n=b;p=h,v=_,b=w,h=e,_=t,w=n}const S=function(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,c=a-t,f=o*o+s*s,l=u*u+c*c,d=.5/(o*c-s*u);return{x:e+(c*f-s*l)*d,y:t+(o*l-u*f)*d}}(m,y,v,b,_,w);this._cx=S.x,this._cy=S.y;for(let t=0;t<a;t++)this._dists[t]=Kh(e[2*t],e[2*t+1],S.x,S.y);ng(this._ids,this._dists,0,a-1),this._hullStart=d;let A=3;n[d]=t[h]=p,n[p]=t[d]=h,n[h]=t[p]=d,r[d]=0,r[p]=1,r[h]=2,i.fill(-1),i[this._hashKey(m,y)]=d,i[this._hashKey(v,b)]=p,i[this._hashKey(_,w)]=h,this.trianglesLen=0,this._addTriangle(d,p,h,-1,-1,-1);for(let a,o,s=0;s<this._ids.length;s++){const u=this._ids[s],c=e[2*u],f=e[2*u+1];if(s>0&&Math.abs(c-a)<=Xh&&Math.abs(f-o)<=Xh)continue;if(a=c,o=f,u===d||u===p||u===h)continue;let l=0;for(let e=0,t=this._hashKey(c,f);e<this._hashSize&&(l=i[(t+e)%this._hashSize],-1===l||l===n[l]);e++);l=t[l];let g,m=l;for(;g=n[m],Hh(c,f,e[2*m],e[2*m+1],e[2*g],e[2*g+1])>=0;)if(m=g,m===l){m=-1;break}if(-1===m)continue;let y=this._addTriangle(m,u,n[m],-1,-1,r[m]);r[u]=this._legalize(y+2),r[m]=y,A++;let v=n[m];for(;g=n[v],Hh(c,f,e[2*v],e[2*v+1],e[2*g],e[2*g+1])<0;)y=this._addTriangle(v,u,g,r[u],-1,r[v]),r[u]=this._legalize(y+2),n[v]=v,A--,v=g;if(m===l)for(;g=t[m],Hh(c,f,e[2*g],e[2*g+1],e[2*m],e[2*m+1])<0;)y=this._addTriangle(g,u,m,-1,r[m],r[g]),this._legalize(y+2),r[g]=y,n[m]=m,A--,m=g;this._hullStart=t[u]=m,n[m]=t[v]=u,n[u]=v,i[this._hashKey(c,f)]=u,i[this._hashKey(e[2*m],e[2*m+1])]=m}this.hull=new Uint32Array(A);for(let e=0,t=this._hullStart;e<A;e++)this.hull[e]=t,t=n[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[e],s=e-e%3;if(a=s+(e+2)%3,-1===o){if(0===i)break;e=Qh[--i];continue}const u=o-o%3,c=s+(e+1)%3,f=u+(o+2)%3,l=t[a],d=t[e],p=t[c],h=t[f];if(eg(r[2*l],r[2*l+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1],r[2*h],r[2*h+1])){t[e]=h,t[o]=l;const r=n[f];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===f){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(o,n[a]),this._link(a,f);const s=u+(o+1)%3;i<Qh.length&&(Qh[i++]=s)}else{if(0===i)break;e=Qh[--i]}}return a}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function Kh(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function eg(e,t,n,r,i,a,o,s){const u=e-o,c=t-s,f=n-o,l=r-s,d=i-o,p=a-s,h=f*f+l*l,g=d*d+p*p;return u*(l*g-h*p)-c*(f*g-h*d)+(u*u+c*c)*(f*p-l*d)<0}function tg(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,c=a-t,f=o*o+s*s,l=u*u+c*c,d=.5/(o*c-s*u),p=(c*f-s*l)*d,h=(o*l-u*f)*d;return p*p+h*h}function ng(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],a=t[r];let o=i-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=r}else{let i=n+1,a=r;rg(e,n+r>>1,i),t[e[n]]>t[e[r]]&&rg(e,n,r),t[e[i]]>t[e[r]]&&rg(e,i,r),t[e[n]]>t[e[i]]&&rg(e,n,i);const o=e[i],s=t[o];for(;;){do{i++}while(t[e[i]]<s);do{a--}while(t[e[a]]>s);if(a<i)break;rg(e,i,a)}e[n+1]=e[a],e[a]=o,r-i+1>=a-n?(ng(e,t,i,r),ng(e,t,n,a-1)):(ng(e,t,n,a-1),ng(e,t,i,r))}}function rg(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function ig(e){return e[0]}function ag(e){return e[1]}function og(e,t){return Zi(e)?function(e){return function(t,n){return Xt(t[0],t[1],n[0],n[1])<=e}}(t):function(e){return function(t,n){return Vt(t[0],t[1],n[0],n[1])<=e}}(t)}function sg(e,t){var n,r=t||{},i=e.layers[0],a=Vu(e,{});if(r.debug_division)return function(e,t){var n=Fu(t),r=[],i=[];return e.shapes.forEach((function(e){var t=[],a=[];n(e,t,a),t.forEach((function(e){r.push([e]),i.push({type:"ring"})})),a.forEach((function(e){r.push([$n(e)]),i.push({type:"hole"})}))})),e.shapes=r,e.data=new Vr(i),e}(i,a);var o=new sc(i,a,{flat:!1,no_holes:!1});if(r.debug_mosaic)return n=lc(i,o.mosaic),i.shapes=n.shapes,void(i.data=n.data);var s=zo(o.nodes),u=i.shapes.map((function(e,t){for(var n=o.getTilesByShapeIds([t]),r=[],i=0;i<n.length;i++)r.push(n[i][0]);return s(r,"dissolve")}));i.shapes=u,r.no_dissolve||Oa(e)}function ug(e,t){return Xo(e).value&&Zo(e,t)||null}function cg(e,t){var n=Wi(e),r=t.tolerance?ug(t.tolerance,n):0;return function(e){return r||r||.01*e}}function fg(e,t,n){n.radius||dt("Missing expected radius parameter");var r=n.units||"",i=Wi(t),a=ug(n.radius+r,i);if(a)return function(){return a};var o=Gs(n.radius,e,null,{});return function(e){var t=o(e);return t&&ug(t+r,i)||0}}nu.alphaShapes=function(e,t,n){ii(e),n.interval>0==0&&dt("Expected a non-negative interval parameter");var r=function(e,t,n){var r=function(e,t,n){for(var r,i,a,o,s,u,c=kt(e),f=Zh.from(c),l=n.keep_points?new Uint8Array(c.length):null,d=f.triangles,p={type:"MultiPolygon",coordinates:[]},h=0,g=d.length;h<g;h+=3)o=d[h],s=d[h+1],u=d[h+2],r=c[o],i=c[s],a=c[u],t(r,i)&&t(i,a)&&t(r,a)&&(p.coordinates.push([[a,i,r,a]]),l&&(l[o]=1,l[s]=1,l[u]=1));return l&&function(e,t,n){for(var r=0,i=n.length;r<i;r++)0===n[r]&&e.coordinates.push((a=t[r],o=void 0,s=void 0,u=void 0,o=1e-4,s=a[0],u=a[1],[[[s,u],[s,u+o],[s+o,u+o],[s+o,u],[s,u]]]));var a,o,s,u}(p,c,l),Dp(p)}(e,t,n);return ya(r),n.debug||hc(r.layers,r,{quiet:!0}),r}(e,og(t,n.interval),n),i=Sa([t,r]),a=i.layers.pop();return t.arcs=i.arcs,li(a,e,null,n),a};var lg=Object.freeze({__proto__:null,dissolveBufferDataset:sg,getBufferToleranceFromCircleSegments:function(e){return 1-Math.cos(Math.PI/e)},getArcDegreesFromTolerancePct:function(e){return 360*Math.acos(1-e)/Math.PI},getBufferToleranceFromCircleSegments2:function(e){return 1/Math.cos(Math.PI/e)-1},getArcDegreesFromTolerancePct2:function(e){return 360*Math.acos(1/(e+1))/Math.PI},parseConstantBufferDistance:ug,getBufferToleranceFunction:cg,getBufferDistanceFunction:fg});function dg(e,t,n,r){var i=function(e,t,n,r){var i=r.backtrack>=0?r.backtrack:50,a=new oa(e),o=r.cap_style||"round";function s(e,n,r,a,o,s){for(var u=a+o,c=a+10;c<u;)d(e,t(n,r,c,s),i),c+=10}function u(e,t,n,r,i){return Dn.distance2D(e,t,n,r)<i}function c(e,t){var n=e[e.length-1];u(n[0],n[1],t[0],t[1],1e-10)||e.push(t)}function f(e,n,r,i){return"flat"==o?[[e,n]]:function(e,n,r,i){for(var a=[],o=10,s=r-90,u=o;u<180;)a.push(t(e,n,s+u,i)),u+=o;return a}(e,n,r,i)}function l(e,t){var n=t-e;return n>180&&(n-=360),n<-180&&(n+=360),n}function d(e,t,n){for(var r,i,a,o,s=0,u=e.length-3;s<n&&u>=0;s++,u--)if(a=e[e.length-1],r=e[u],i=e[u+1],o=pg(r[0],r[1],i[0],i[1],a[0],a[1],t[0],t[1])){for(;e.length>u+1;)e.pop();c(e,o)}c(e,t)}return function(e,r){var o,c,p,h,g,m,y,v,b,x,_,w,S,A,I,M,P=[],E=0;for(a.init(e);a.hasNext();)a.x===g&&a.y===m||(p=g,h=m,g=a.x,m=a.y,E>=1&&(x=b,b=n(p,h,g,m),y=t(p,h,b-90,r),v=t(g,m,b-90,r)),1==E&&(_=b,o=p,c=h,P.push(y,v)),E>1&&(w=l(x,b),S=P,A=y[0],I=y[1],M=void 0,u((M=S[S.length-1])[0],M[1],A,I,1e-6)?d(P,v,i):w>0?(s(P,p,h,x-90,w,r),d(P,y,i),d(P,v,i)):(d(P,y,i),d(P,v,i))),E++);return g==o&&m==c?(w=l(b,_))>0&&s(P,g,m,b-90,w,r):P.push.apply(P,f(g,m,b,r)),P}}(e,t,n,r),a=r.geometry_type,o="polyline"==r.output_geometry?"polyline":"polygon";function s(e,t){var n,r=i(e,t);return"polyline"==a&&(n=$n(e.concat()),r=r.concat(i(n,t))),r.push(r[0]),"polyline"==o?r:[r]}return function(e,t){for(var n={type:"polyline"==o?"MultiLineString":"MultiPolygon",coordinates:[]},r=0;r<e.length;r++)n.coordinates.push(s(e[r],t));return 0==n.coordinates.length?null:n}}function pg(e,t,n,r,i,a,o,s){return e<i&&e<o&&n<i&&n<o||e>i&&e>o&&n>i&&n>o||t<a&&t<s&&r<a&&r<s||t>a&&t>s&&r>a&&r>s?null:Dn.segmentIntersection(e,t,n,r,i,a,o,s)}var hg=Object.freeze({__proto__:null,getPolylineBufferMaker:dg,addBufferVertex:function(e,t,n){for(var r,i,a,o,s=0,u=e.length-3;s<n&&u>=0;s++,u--)if(a=e[e.length-1],r=e[u],i=e[u+1],o=pg(r[0],r[1],i[0],i[1],a[0],a[1],t[0],t[1])){for(o.length;e.length>u+1;)e.pop();e.push(o)}e.push(t)},bufferIntersection:pg});function gg(e,t,n){return!!n.containsPoint(e[0],e[1])||!!(Dn.segmentIntersection(e[0],e[1],t[0],t[1],n.xmin,n.ymin,n.xmin,n.ymax)||Dn.segmentIntersection(e[0],e[1],t[0],t[1],n.xmin,n.ymax,n.xmax,n.ymax)||Dn.segmentIntersection(e[0],e[1],t[0],t[1],n.xmax,n.ymax,n.xmax,n.ymin)||Dn.segmentIntersection(e[0],e[1],t[0],t[1],n.xmax,n.ymin,n.xmin,n.ymin))}function mg(e,t,n,r){var i=function(e,t,n,r){var i,a,o,s,u=r.backtrack>=0?r.backtrack:50,c=new oa(e);function f(e,n,r,i,a){for(var o=r+i,s=r+10;s<o;)p(t(e,n,s,a)),s+=10}function l(e,t,n,r,i){return Dn.distance2D(e,t,n,r)<i}function d(e,t){var n=e[e.length-1];l(n[0],n[1],t[0],t[1],1e-10)||e.push(t)}function p(e){var t,n,r,i,o,c=a;i=r=c[c.length-1];for(var f=0,l=c.length-3;l>=0;f++,l--){if(t=c[l],n=c[l+1],o=pg(t[0],t[1],n[0],n[1],r[0],r[1],e[0],e[1])){if(1==Ln(t,n,r,e)){h();break}for(;c.length>l+1;)c.pop();d(c,o),r=o}if(f>=u){s||(s=new jt).mergePoint(t[0],t[1]),s.mergePoint(n[0],n[1]),gg(i,e,s)&&h();break}}d(c,e)}function h(){var e=a[a.length-1],t=o[o.length-1],n=[];g(n,a),o.reverse(),g(n,o),n.push(n[0]),i.push(n),a.push(e),o.push(t)}function g(e,t){for(t.reverse();t.length>0;)e.push(t.pop())}return function(e,r){var s,u,d,g,m,y,v,b,x,_,w,S,A,I;for(i=[],a=[],o=[],c.init(e);c.hasNext();)c.x===d&&c.y===g||(s=d,u=g,d=c.x,g=c.y,b=v,v=n(s,u,d,g),m=t(s,u,v-90,r),y=t(d,g,v-90,r),0===o.length?(a.push(m,y),o.push([s,u],[d,g])):(I=void 0,(I=v-b)>180&&(I-=360),I<-180&&(I+=360),x=I,_=a,w=m[0],S=m[1],A=void 0,l((A=_[_.length-1])[0],A[1],w,S,1e-6)?p(y):x>0?(f(s,u,b-90,x,r),p(m),p(y)):(p(m),p(y)),o.push([d,g])));return o.length>1&&h(),i}}(e,t,n,r),a=r.geometry_type;function o(e){return[e]}function s(t,n){var s,u,c;return function(e,t){return"polyline"==a?"right"!=r.type:"outer"==r.type?1==Dn.getPathWinding(e,t):"inner"!=r.type||-1==Dn.getPathWinding(e,t)}(t,e)&&(s=i(t,n)),"polyline"==a&&"left"!=r.type&&(c=$n(t.concat()),u=i(c,n)),(s||[]).concat(u||[]).map(o)}return function(e,t){for(var n={type:"MultiPolygon",coordinates:[]},r=0;r<e.length;r++)n.coordinates=n.coordinates.concat(s(e[r],t));return 0==n.coordinates.length?null:n}}function yg(e){Qi(e)||lt("Expected an unprojected CRS");var t=e.es/(1+Math.sqrt(e.one_es));return new(lr("mproj").internal.GeographicLib.Geodesic.Geodesic)(e.a,t)}function vg(e,t,n,r,i){var a=1-i;return[e*a+n*i,t*a+r*i]}function bg(e){if(!e||!Qi(e))return vg;var t=yg(e);return function(e,n,r,i,a){var o=t.Inverse(n,e,i,r),s=o.s12*a,u=t.Direct(n,e,o.azi1,s);return[u.lon2,u.lat2]}}function xg(e,t,n,r){var i=n/180*Math.PI;return[e+Math.sin(i)*r,t+Math.cos(i)*r]}function _g(e,t,n,r){var i=Math.PI/180,a=Math.cos(t*i),o=2*a*a-1,s=2*a*o-a,u=2*a*s-o,c=1e3*(111.41513*a-.09455*s+12e-5*(2*a*u-s)),f=1e3*(111.13209-.56605*o+.0012*u),l=n*i,d=t+Math.cos(l)*r/f;return[e+Math.sin(l)*r/c,d]}function wg(e){if(!Qi(e))return xg;var t=yg(e);return function(e,n,r,i){var a=t.Direct(n,e,r,i);return[a.lon2,a.lat2]}}function Sg(e){return Qi(e)?_g:xg}function Ag(e,t,n,r){return 180*Dn.bearing(e,t,n,r)/Math.PI}function Ig(e,t,n,r){return 180*Dn.bearing2D(e,t,n,r)/Math.PI}function Mg(e){return Qi(Wi(e))?Ag:Ig}var Pg=Object.freeze({__proto__:null,interpolatePoint2D:vg,getInterpolationFunction:bg,getPlanarSegmentEndpoint:xg,getGeodeticSegmentFunction:wg,getFastGeodeticSegmentFunction:Sg,bearingDegrees:Ag,bearingDegrees2D:Ig,getBearingFunction:Mg});function Eg(e,t,n){var r=fg(e,t,n),i=(cg(t,n),Sg(Wi(t))),a=Mg(t),o=Object.assign({geometry_type:e.geometry_type},n),s=(n.v2?mg:dg)(t.arcs,i,a,o),u=(e.data&&e.data.getRecords(),e.shapes.map((function(t,n){var i=r(n);return i&&t?s(t,i,e.geometry_type):null})));return{type:"GeometryCollection",geometries:u}}var jg=1e-10,Og=90-jg,Fg=-180+jg,kg=-90+jg,Ng=180-jg;function Cg(e){return e[e.length-1]}function zg(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function Tg(e){return zg(e[0],Cg(e))}function Lg(e){e[0]<=Fg&&(e[0]=-180),e[0]>=Ng&&(e[0]=180),e[1]<=kg&&(e[1]=-90),e[1]>=Og&&(e[1]=90)}function Bg(e){return e[1]>=Og||e[1]<=kg}function Dg(e,t){return Bg(e)||Bg(t)||e[0]<=Fg&&t[0]<=Fg||e[0]>=Ng&&t[0]>=Ng}function Rg(e){return e[1]<=kg||e[1]>=Og||e[0]<=Fg||e[0]>=Ng}function Ug(e){return Jg(e)}function qg(e){return-180==e[0]||180==e[0]}function Gg(e){for(var n,r=[],i=[],a=0;a<e.length;a++)Tg(n=e[a])||lt("Received an open path"),0===$g(n)?r.push(n):i=i.concat(Jg(n));return i.length>0&&(r=r.concat(function(e){var n=function(e){var n=e.map((function(e){return e[0][1]}));return t.genericSort(n,!0)}(e),r=[],i=[];return e.forEach((function(e,t){if(!i[t]){(function(e){var t=Cg(e)[0],n=e[0][0];return!(180!=t&&-180!=t||180!=n&&-180!=n)})(e)||lt("Geometry error");var n=a(e,[]);n&&(Tg(n)||lt("Generated an open ring"),r.push(n))}})),r;function a(t,r){var o=Cg(t),s=e.indexOf(t);if(i[s])return vt("Tried to use a previously used path"),null;i[s]=!0,r=r.concat(t);var u=function(e,t,n){var r=t[0],i=t[1],a=n.indexOf(i),o=-180==r?180:-180,s=180==r?a-1:a+1;return 180!=r&&-180!=r?(vt("Unexpected error"),null):-1==a?(vt("Point missing from intersection table:",t),null):s<0||s>=n.length?[o,i]:[r,n[s]]}(0,o,n);if(!u)return null;if(o[0]!=u[0]){var c=180==o[0]?-90:90;r.push([o[0],c],[0,c],[u[0],c])}var f=function(e,t){for(var n=0;n<e.length;n++)if(zg(e[n][0],t))return e[n];return null}(e,u);return f?zg(r[0],f[0])?(r.push(r[0]),r):a(f,r):null}}(i))),r}function Vg(e,t){t.length>1&&e.push(t)}function $g(e){for(var t,n,r=0,i=0,a=e.length;i<a;i++)n=e[i],i>0&&Math.abs(t[0]-n[0])>180&&r++,t=n;return r}function Jg(e){for(var t,n,r,i=[],a=[],o=e[0],s=zg(o,Cg(e)),u=0,c=e.length;u<c;u++)t=e[u],u>0&&Yg(n,t)&&(Wg(a,n,(f=n,d=void 0,p=void 0,(l=t)[0]-f[0]>0?(d=f[0]+180,p=180-l[0]):(d=180-f[0],p=l[0]+180),r=0===d?f[1]:0===p?l[1]:(p*f[1]+d*l[1])/(d+p))),Vg(i,a),Wg(a=[],t,r)),a.push(t),n=t;var f,l,d,p;return Vg(i,a),s&&i.length>1&&!qg(o)&&((a=i.pop()).pop(),i[0]=a.concat(i[0])),i}function Yg(e,t){return Math.abs(e[0]-t[0])>180}function Wg(e,t,n){var r=t[0]<0?-180:180;qg(t)||e.push([r,n])}function Hg(e,t,n,r){var i=n||360,a=wg($i("wgs84"));return r.inset&&(t-=r.inset),"polyline"==r.geometry_type?function(e,t,n,r){var i,a=[];if(!e||!e.length)return null;for(var o=0;o<e.length;o++)for(i=Ug(i=Qg(e[o],t,n,r));i.length>0;)a.push(i.pop());return 1==a.length?{type:"LineString",coordinates:a[0]}:{type:"MultiLineString",coordinates:a}}([e],t,i,a):Xg([e],t,i,a,!0)}function Xg(e,t,n,r,i){var a,o,s=[];if(!e||!e.length)return null;for(var u=0;u<e.length;u++)if(a=Qg(e[u],t,n,r),i)if($g(a)>0)for(o=Gg([a]);o.length>0;)s.push([o.pop()]);else mn(new ra(a))<0?s.push([[[180,90],[180,-90],[0,-90],[-180,-90],[-180,90],[0,90],[180,90]],a]):s.push([a]);else s.push([a]);return{type:"MultiPolygon",coordinates:s}}function Qg(e,t,n,r){for(var i,a=[],o=360/n,s=0;s<n;s++)i=(s+.5)*o%360,a.push(r(e[0],e[1],i,t));return a.push(a[0].concat()),a}nu.buffer=function(e,t,n){var r;return"point"==e.geometry_type?r=function(e,t,n){var r=function(e,t,n){var r=n.vertices||72,i=fg(e,t,n),a=Wi(t),o=Qi(a),s=wg(a),u=e.shapes.map((function(e,t){var n=i(t);return n&&e?Xg(e,n,r,s,o):null}));return{type:"GeometryCollection",geometries:u}}(e,t,n);return Dp(r,{})}(e,t,n):"polyline"==e.geometry_type?r=function(e,t,n){var r=Dp(Eg(e,t,n),{});return sg(r,n),r}(e,t,n):"polygon"==e.geometry_type?r=function(e,t,n){var r=Dp(Eg(e,t,n),{});return sg(r),r}(e,t,n):dt("Unsupported geometry type"),[$a(e,t,r,n)]};var Zg=[10,12,15,18,20,22,25,30,35,40,45,50,60,70,80,90,100],Kg=[10,2,5,2,10,2,5,10,5,10,5,50,10,10,10,10,10];function em(e,t){return(t>=50?1:t>=10&&.9)||t>=5&&.8||.7}function tm(e,n){var r=av(e,n),i=function(e,t,n){var r=[],i=Math.max(Math.abs(e),Math.abs(t)),a=n>=2?(t-e)/(n-1):i,o=function(e){var t=1;for(e>1e-4!=0&&e<1e9!=0||dt("Data range error");e>100;)e/=10,t/=10;for(;e<10;)e*=10,t*=10;return t}(a);return function(e){for(var t,n,r=Zg,i=1;i<r.length;i++)if(t=r[i-1],n=r[i],e>=t&&e<=n)return[t,n];lt("Range error")}(o*a).forEach((function(t){var i=function(e){var t=Zg.indexOf(e);return Kg[t]||lt("Unknown error")}(t),a=rm(t,o),s=rm(i,o),u=function(e,t){var n=Uo(t)(e),r=n+(e>n?t:-t);return n<r?[n,r]:[r,n]}(e,s);u.forEach((function(e){r.push({interval:a,precision:s,roundness:em(0,i),breaks:im(e,a,n)})}))})),r}(r[0],r[r.length-1],n);return i.forEach((function(n){var r,i,a,o;ov(n.breaks,e),n.distribution=ov(n.breaks,e),n.quality=n.roundness*(r=n.distribution,i=t.sum(r)/r.length,a=r[0],o=r[r.length-1],(nm(i,a)+nm(i,o))/2)})),t.sortOn(i,"quality",!1),i[0].breaks}function nm(e,t){return t>e?e/t:e/(2*e-t)}function rm(e,t){return t<1?e*Math.round(1/t):e/t}function im(e,t,n){for(var r=[e],i=1;i<n;i++)r.push(e+t*i);return r}function am(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function om(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function sm(){}var um=.7,cm=1/um,fm="\\s*([+-]?\\d+)\\s*",lm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pm=/^#([0-9a-f]{3,8})$/,hm=new RegExp("^rgb\\("+[fm,fm,fm]+"\\)$"),gm=new RegExp("^rgb\\("+[dm,dm,dm]+"\\)$"),mm=new RegExp("^rgba\\("+[fm,fm,fm,lm]+"\\)$"),ym=new RegExp("^rgba\\("+[dm,dm,dm,lm]+"\\)$"),vm=new RegExp("^hsl\\("+[lm,dm,dm]+"\\)$"),bm=new RegExp("^hsla\\("+[lm,dm,dm,lm]+"\\)$"),xm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _m(){return this.rgb().formatHex()}function wm(){return this.rgb().formatRgb()}function Sm(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pm.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Am(t):3===n?new Em(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Im(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Im(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=hm.exec(e))?new Em(t[1],t[2],t[3],1):(t=gm.exec(e))?new Em(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=mm.exec(e))?Im(t[1],t[2],t[3],t[4]):(t=ym.exec(e))?Im(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=vm.exec(e))?km(t[1],t[2]/100,t[3]/100,1):(t=bm.exec(e))?km(t[1],t[2]/100,t[3]/100,t[4]):xm.hasOwnProperty(e)?Am(xm[e]):"transparent"===e?new Em(NaN,NaN,NaN,0):null}function Am(e){return new Em(e>>16&255,e>>8&255,255&e,1)}function Im(e,t,n,r){return r<=0&&(e=t=n=NaN),new Em(e,t,n,r)}function Mm(e){return e instanceof sm||(e=Sm(e)),e?new Em((e=e.rgb()).r,e.g,e.b,e.opacity):new Em}function Pm(e,t,n,r){return 1===arguments.length?Mm(e):new Em(e,t,n,null==r?1:r)}function Em(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function jm(){return"#"+Fm(this.r)+Fm(this.g)+Fm(this.b)}function Om(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Fm(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function km(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new zm(e,t,n,r)}function Nm(e){if(e instanceof zm)return new zm(e.h,e.s,e.l,e.opacity);if(e instanceof sm||(e=Sm(e)),!e)return new zm;if(e instanceof zm)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new zm(o,s,u,e.opacity)}function Cm(e,t,n,r){return 1===arguments.length?Nm(e):new zm(e,t,n,null==r?1:r)}function zm(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Tm(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}am(sm,Sm,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:_m,formatHex:_m,formatHsl:function(){return Nm(this).formatHsl()},formatRgb:wm,toString:wm}),am(Em,Pm,om(sm,{brighter:function(e){return e=null==e?cm:Math.pow(cm,e),new Em(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?um:Math.pow(um,e),new Em(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jm,formatHex:jm,formatRgb:Om,toString:Om})),am(zm,Cm,om(sm,{brighter:function(e){return e=null==e?cm:Math.pow(cm,e),new zm(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?um:Math.pow(um,e),new zm(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Em(Tm(e>=240?e-240:e+120,i,r),Tm(e,i,r),Tm(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const Lm=Math.PI/180,Bm=180/Math.PI,Dm=.96422,Rm=.82521,Um=4/29,qm=6/29,Gm=3*qm*qm;function Vm(e){if(e instanceof $m)return new $m(e.l,e.a,e.b,e.opacity);if(e instanceof Zm)return Km(e);e instanceof Em||(e=Mm(e));var t,n,r=Hm(e.r),i=Hm(e.g),a=Hm(e.b),o=Jm((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?t=n=o:(t=Jm((.4360747*r+.3850649*i+.1430804*a)/Dm),n=Jm((.0139322*r+.0971045*i+.7141733*a)/Rm)),new $m(116*o-16,500*(t-o),200*(o-n),e.opacity)}function $m(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Jm(e){return e>.008856451679035631?Math.pow(e,1/3):e/Gm+Um}function Ym(e){return e>qm?e*e*e:Gm*(e-Um)}function Wm(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Hm(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Xm(e){if(e instanceof Zm)return new Zm(e.h,e.c,e.l,e.opacity);if(e instanceof $m||(e=Vm(e)),0===e.a&&0===e.b)return new Zm(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Bm;return new Zm(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Qm(e,t,n,r){return 1===arguments.length?Xm(e):new Zm(e,t,n,null==r?1:r)}function Zm(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Km(e){if(isNaN(e.h))return new $m(e.l,0,0,e.opacity);var t=e.h*Lm;return new $m(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}am($m,(function(e,t,n,r){return 1===arguments.length?Vm(e):new $m(e,t,n,null==r?1:r)}),om(sm,{brighter:function(e){return new $m(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new $m(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Em(Wm(3.1338561*(t=Dm*Ym(t))-1.6168667*(e=1*Ym(e))-.4906146*(n=Rm*Ym(n))),Wm(-.9787684*t+1.9161415*e+.033454*n),Wm(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),am(Zm,Qm,om(sm,{brighter:function(e){return new Zm(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Zm(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Km(this).rgb()}}));var ey=-.14861,ty=1.78277,ny=-.29227,ry=-.90649,iy=1.97294,ay=iy*ry,oy=iy*ty,sy=ty*ny-ry*ey;function uy(e){if(e instanceof fy)return new fy(e.h,e.s,e.l,e.opacity);e instanceof Em||(e=Mm(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(sy*r+ay*t-oy*n)/(sy+ay-oy),a=r-i,o=(iy*(n-i)-ny*a)/ry,s=Math.sqrt(o*o+a*a)/(iy*i*(1-i)),u=s?Math.atan2(o,a)*Bm-120:NaN;return new fy(u<0?u+360:u,s,i,e.opacity)}function cy(e,t,n,r){return 1===arguments.length?uy(e):new fy(e,t,n,null==r?1:r)}function fy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ly(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}am(fy,cy,om(sm,{brighter:function(e){return e=null==e?cm:Math.pow(cm,e),new fy(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?um:Math.pow(um,e),new fy(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Lm,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Em(255*(t+n*(ey*r+ty*i)),255*(t+n*(ny*r+ry*i)),255*(t+n*(iy*r)),this.opacity)}}));var dy=e=>()=>e;function py(e,t){return function(n){return e+n*t}}function hy(e,t){var n=t-e;return n?py(e,n>180||n<-180?n-360*Math.round(n/360):n):dy(isNaN(e)?t:e)}function gy(e,t){var n=t-e;return n?py(e,n):dy(isNaN(e)?t:e)}var my=function e(t){var n=function(e){return 1==(e=+e)?gy:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):dy(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Pm(e)).r,(t=Pm(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=gy(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function yy(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Pm(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}var vy=yy((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return ly((n-r/t)*t,o,i,a,s)}}));function by(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function xy(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Py(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function _y(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wy(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Sy(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Py(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}yy((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return ly((n-r/t)*t,i,a,o,s)}}));var Ay=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Iy=new RegExp(Ay.source,"g");function My(e,t){var n,r,i,a=Ay.lastIndex=Iy.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=Ay.exec(e))&&(r=Iy.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:wy(n,r)})),a=Iy.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function Py(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?dy(t):("number"===i?wy:"string"===i?(n=Sm(t))?(t=n,my):My:t instanceof Sm?my:t instanceof Date?_y:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?xy:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Sy:wy:by))(e,t)}var Ey,jy=180/Math.PI,Oy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Fy(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*jy,skewX:Math.atan(u)*jy,scaleX:o,scaleY:s}}function ky(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],u=[];return a=e(a),o=e(o),function(e,r,i,a,o,s){if(e!==i||r!==a){var u=o.push("translate(",null,t,null,n);s.push({i:u-4,x:wy(e,i)},{i:u-2,x:wy(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:wy(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,o.rotate,s,u),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:wy(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,o.skewX,s,u),function(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:wy(e,n)},{i:s-2,x:wy(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}function Ny(e){return((e=Math.exp(e))+1/e)/2}function Cy(e){return function(t,n){var r=e((t=Cm(t)).h,(n=Cm(n)).h),i=gy(t.s,n.s),a=gy(t.l,n.l),o=gy(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=a(e),t.opacity=o(e),t+""}}}function zy(e){return function(t,n){var r=e((t=Qm(t)).h,(n=Qm(n)).h),i=gy(t.c,n.c),a=gy(t.l,n.l),o=gy(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=a(e),t.opacity=o(e),t+""}}}function Ty(e){return function t(n){function r(t,r){var i=e((t=cy(t)).h,(r=cy(r)).h),a=gy(t.s,r.s),o=gy(t.l,r.l),s=gy(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=a(e),t.l=o(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}ky((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Oy:Fy(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),ky((function(e){return null==e?Oy:(Ey||(Ey=document.createElementNS("http://www.w3.org/2000/svg","g")),Ey.setAttribute("transform",e),(e=Ey.transform.baseVal.consolidate())?Fy((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Oy)}),", ",")",")"),function e(t,n,r){function i(e,i){var a,o,s=e[0],u=e[1],c=e[2],f=i[0],l=i[1],d=i[2],p=f-s,h=l-u,g=p*p+h*h;if(g<1e-12)o=Math.log(d/c)/t,a=function(e){return[s+e*p,u+e*h,c*Math.exp(t*e*o)]};else{var m=Math.sqrt(g),y=(d*d-c*c+r*g)/(2*c*n*m),v=(d*d-c*c-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-b)/t,a=function(e){var r,i=e*o,a=Ny(b),f=c/(n*m)*(a*(r=t*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+f*p,u+f*h,c*a/Ny(t*i+b)]}}return a.duration=1e3*o*t/Math.SQRT2,a}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4),Cy(hy),Cy(gy),zy(hy),zy(gy),Ty(hy);var Ly=Ty(gy);function By(e,t){for(var n,r=Dy(e,null),i=e.length,a=function(e){var t=e[0]/100,n=e[1]/100;return 2!=e.length&&dt("Only two stops are currently supported"),t>=0&&n<=1&&t<n||dt("Invalid gradient stops:",e),function(e){return e*(n-t)+t}}(t),o=[],s=0;s<i;s++)n=r(a(s/(i-1))*(i-1)),o.push(n);return o}function Dy(e,t){for(var n=[],r=e.length-1,i=1;i<e.length;i++)n.push(Py(e[i-1],e[i]));return function(e){if(-1==e)return t;0==(e>=0&&e<=r)&&lt("Range error");var i=e==r?r-1:Math.floor(e),a=e==r?1:e%1;return n[i](a)}}function Ry(e,t,n){var r=e.length;return function(i){return i>=0&&i<r?e[i]:-2==i?void 0===n?t:n:t}}function Uy(e,t,n){return n.continuous?Dy(e,t):Ry(e,t,n.other)}function qy(e,t){return{width:t.key_width||"dataviz"==e&&500||300,tileHeight:t.key_tile_height||10,labelSuffix:t.key_label_suffix||"",lastSuffix:t.key_last_suffix||"",chartHeight:90,chartColor:"#ddd",ticColor:"rgba(0,0,0,0.3)",ticLen:t.key_tic_length>=0?+t.key_tic_length:6,fontFamily:"sans-serif",fontSize:t.key_font_size||13,textColor:"#555"}}function Gy(e,t,n){return function(r){return(r-t)/(n-t)*e}}function Vy(e,t){var n=function(e){var t=e[0],n=(e[e.length-1]-t)/e.length,r=0;return n<1?r=2:n<10&&(r=1),r}(e);return e.map((function(r,i){var a=i==e.length-1&&t.lastSuffix||t.labelSuffix||"";return Bo(r,n)+a}))}function $y(e,t){for(var n=[],r=0;r<e;r++)n.push((r+1)/(e+1)*t);return n}function Jy(e,t,n,r){for(var i=Gy(r.width,t,n),a=[],o=0;o<e.length;o++)a.push(Ky(i(e[o]),r));return Qy(a)}function Yy(e){return e.labelSuffix?3:0}function Wy(e,t,n){return[t].concat(e,n)}function Hy(e,t,n,r,i){for(var a=Vy(e,i),o=Gy(i.width,n,r),s=[],u=0;u<t.length;u++)s.push(Zy(a[u],o(t[u]),i));return Qy(s)}function Xy(e,t,n){var r={width:n,crisp_paths:!0,default_linecap:"butt"},i=e+(e.endsWith(".svg")?"":".svg"),a=fl(1==t.length?t[0]:Sa(t),r);a[0].filename=i,ao(a,{})}function Qy(e){return Dp({type:"FeatureCollection",features:e})}function Zy(e,t,n){var r,i=-(n.ticLen+.7*n.fontSize+4);return t<=0?r="start":t>=n.width?r="end":(r="middle",t+=Yy(n)),{type:"Feature",properties:{"label-text":e,"font-family":n.fontFamily,"font-size":n.fontSize,"text-anchor":r,fill:n.textColor},geometry:{type:"Point",coordinates:[t,i]}}}function Ky(e,t){var n=t.tileHeight,r=t.tileHeight+t.ticLen;return{type:"Feature",properties:{stroke:t.ticColor},geometry:{type:"LineString",coordinates:[[e,n],[e,n-r]]}}}function ev(e,t,n,r,i){var a=function(e,t,n,r){return[[e,t],[e,t+r],[e+n,t+r],[e+n,t],[e,t]]}(e,t,n,r);return{type:"Feature",properties:{fill:i},geometry:{type:"Polygon",coordinates:[a]}}}function tv(e,n,r,i,a){var o,s,u,c,f=e.length,l=(a.continuous?f-1:f)-1,d=a.precision?Uo(a.precision):null;d&&(r=r.map(d));var p,h=(p=r.filter(t.isFiniteNumber),t.genericSort(p,!0),p),g=r.length-h.length,m=h[0],y=h[h.length-1];return 0===l?o=[]:a.breaks?o=a.breaks:"equal-interval"==i?o=iv(h,l):"quantile"==i?o=av(h,l):"hybrid"==i?o=function(e,t){var n=av(e,t);if(t<3)return n;var r=n[0],i=n[n.length-1],a=iv(e.filter((function(e){return e>=r&&e<i})),t-2);return[r].concat(a).concat(i)}(h,l):"nice"==i?ht("Nice breaks:",o=tm(h,l)):dt("Unknown classification method:",i),function(e,t,n){var r=ov(t,e),i=function(e,t){for(var n,r,i,a,o=[],s=0,u=0;s<=e.length;s++)(n=nv(t,r=0===s?-1/0:e[s-1],i=s<e.length?e[s]:1/0,u))?(a=[t[n[0]],t[n[1]]],u=n[1]):a=0===s?[i,i]:s<e.length?[r,i]:[r,r],o.push(a);return o}(t,e).map((function(e,t){return[`${e[0]} - ${e[1]}`,`(${r[t]})`]}));i.push(["null or non-numeric values",`(${n})`]),ht("Data ranges and (feature counts):\n"+wt(i,["left","right"]))}(h,o,g),u=a.continuous?function(e,n,r){return function(i){var a,o,s=e.length;if(!t.isValidNumber(i)||i<n||i>r)return-1;for(var u=0;u<=s;u++)if(o=u===s?r:e[u],u===s||i<o)return u+(i-(a=0===u?n:e[u-1]))/(o-a);lt("Range error")}}(o,m,y):rv(o,d),c=Uy(e,n,a),s=function(e){return c(u(e))},a.colors&&(a.key||a.key_style)&&("gradient"==a.key_style&&a.continuous?function(e,t,n,r,i){var a=qy("gradient",i),o=function(e,t,n){for(var r=[],i=function(e,t){var n=e.length-1,r=t/n;return function(t){var i=Math.min(Math.floor(t/r),n-1),a=(t-i*r)/r;return e[i]*(1-a)+e[i+1]*a}}(t,n.width),a=0;a<n.width;a+=2)r.push(ev(a,0,2,n.tileHeight,e(i(a))));return Qy(r)}(e,Wy(t,n,r),a),s=$y(t.length,a.width),u=Hy(t,s,0,a.width,a),c=[o,Jy(s,0,a.width,a),u];Xy(i.key_name||"gradient-key",c,a.width)}(s,o,m,y,a):"dataviz"==a.key_style?function(e,t,n,r){var i=qy("dataviz",r),a=n[0],o=n[n.length-1],s=Wy(t,a,o),u=function(e,t){for(var n,r,i=Math.floor(t.width/5),a=ov(iv(e,i-1),e),o=Math.max.apply(a,a),s=[],u=t.tileHeight,c=0;c<i;c++)(n=a[c])&&(r=n/o*t.chartHeight,s.push(ev(5*c,u,5,r,t.chartColor)));return Qy(s)}(n,i),c=function(e,t,n,r,i){for(var a,o,s=Wy(t,n,r),u=Gy(i.width,n,r),c=[],f=0;f<s.length;f++)a=u(s[f]),o=u(s[f+1])-a,c.push(ev(a,0,o,i.tileHeight,e[f]));return Qy(c)}(e,t,a,o,i),f=Hy(s,s,a,o,i),l=Jy(s,a,o,i);Xy(r.key_name||"dataviz-key",[u,c,l,f],i.width)}(e,o,h,a):(a.key||"simple"==a.key_style)&&function(e,t,n,r,i){var a,o,s,u=qy("simple",i),c=function(e,t,n){for(var r=[],i=0;i<n.length;i++)r.push(ev(i*e,0,e,t,n[i]));return Qy(r)}(u.width/e.length,u.tileHeight,e),f=[c];e.length==t.length+1?(a=Hy(t,s=$y(t.length,u.width),0,u.width,u),o=Jy(s,0,u.width,u),f.push(o,a)):e.length==t.length+2&&(u.ticLen=2,a=function(e,t){for(var n,r=[],i=Vy(e,t),a=(Yy(t),0);a<i.length;a++)n=(a+.5)*t.width/i.length,r.push(Zy(i[a],n,t));return Qy(r)}(Wy(t,n,r),u),f.push(a)),Xy(i.key_name||"simple-key",f,u.width)}(e,o,m,y,a)),s}function nv(e,t,n,r){for(var i,a=e.length,o=-1,s=-1;r<a&&!((i=e[r])>=n);)-1==o&&i>=t&&(o=r),s=r,r++;return o>-1&&s>-1?[o,s]:null}function rv(e,n){var r,i=!1;return sv(r=e,t.genericSort(r.map(parseFloat)))||(function(e){return sv(e,t.genericSort(e.map(parseFloat),!1))}(e)?(e=e.concat().reverse(),i=!0):dt("Invalid class breaks:",e.join(","))),function(t){var r=-1;return Number(t)===t&&(n&&(t=t(n)),r=uv(t,e)),i&&r>-1&&(r=e.length-r),r}}function iv(e,t){var n,r=t+1,i=e[0],a=(e[e.length-1]-i)/r,o=[];for(n=1;n<r;n++)o.push(i+n*a);return o}function av(e,t){var n,r,i=t+1,a=e.length/i,o=[];for(n=1;n<i;n++)r=Math.floor(n*a),o.push(e[r]);return o}function ov(e,n){var r=t.initializeArray(new Array(e.length+1),0);return n.forEach((function(t){var n=uv(t,e);-1==n?lt("Indexing error"):r[n]++})),r}function sv(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return e.length==t.length}function uv(e,n){var r=0;if(!t.isValidNumber(e))return-1;for(;r<n.length&&e>=n[r];)r++;return r}function cv(e,t,n){var r=n.categories,i=Ry(e,t,n.other);return function(e){var t=r.indexOf(e);return i(t>=0?t:e?-2:-1)}}function fv(e,n){var r=arguments[2]||{},i=!r.reusable,a=n.size(),o=new Int32Array(a),s=new Int32Array(a);function u(e,t){var n,a=zt(e),u=o[a],c=s[a];return-1==u||null===(n=t(u,c))||!1===n?null:(i&&(o[a]=-1,s[a]=-1),r.filter&&!r.filter(u,c)?null:n)}return t.initializeArray(o,-1),t.initializeArray(s,-1),Qn(e,(function(e){var t=zt(e.arcId),n=e.shapeId,r=o[t];-1==r?o[t]=n:n<r?(s[t]=r,o[t]=n):s[t]=n})),function(e){return function(t){return u(t,e)}}}var lv=Object.freeze({__proto__:null,getArcClassifier:fv});function dv(e,t){var n,r,i,a=fv(e.shapes,t,{reusable:!0})((function(e,t){return-1==t?-1:e==n?t:e}));function o(e){var t=a(e);-1!=t&&(i?i(t,e):-1==r.indexOf(t)&&r.push(t))}return function(t,a){if(n=t,!a)return r=[],Wn(e.shapes[t],o),r;i=a,Wn(e.shapes[t],o),i=null}}function pv(e,t){var n=fv(e,t)((function(e,t){return t>-1&&e>-1?[e,t]:null})),r=[],i={};return Wn(e,(function(e){var t,a=n(e);a&&(t=a.join("~"))in i==0&&(r.push(a),i[t]=!0)})),r}var hv=Object.freeze({__proto__:null,getNeighborLookupFunction:dv,findPairsOfNeighbors:pv});function gv(e,t,n){for(var r,i=e.nabes,a=0;a<i.length;a++)(r=n[i[a]]).colorId>-1||mv(r,e.colorId,t)}function mv(e,t,n){var r,i=function(e,t){for(var n,r=0,i=t.length;i-r>50;)t[n=Math.floor((r+i)/2)].saturation>=e.saturation?i=n:r=n;return t.indexOf(e,r)}(e,n),a=n.length;for(-1==i&&lt("Indexing error"),e.uncolored--,e.nabeColors.includes(t)?e.common++:(e.saturation++,e.nabeColors.push(t));++i<a&&yv(e,r=n[i]);)n[i-1]=r,n[i]=e}function yv(e,t){return e.saturation>t.saturation||!(e.saturation<t.saturation)&&(e.common>t.common||!(e.common<t.common)&&e.uncolored<t.uncolored)}function vv(e,t,n){for(var r=e.nabes,i=0;i<r.length;i++)if(t[r[i]].colorId===n)return!1;return!0}function bv(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}var xv=bv("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),_v=bv("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),wv=bv("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Sv=bv("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Av=bv("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Iv=bv("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Mv=bv("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Pv=bv("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Ev=bv("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),jv=bv("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ov=e=>vy(e[e.length-1]),Fv=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(bv),kv=Ov(Fv),Nv=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(bv),Cv=Ov(Nv),zv=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(bv),Tv=Ov(zv),Lv=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(bv),Bv=Ov(Lv),Dv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(bv),Rv=Ov(Dv),Uv=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(bv),qv=Ov(Uv),Gv=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(bv),Vv=Ov(Gv),$v=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(bv),Jv=Ov($v),Yv=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(bv),Wv=Ov(Yv),Hv=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(bv),Xv=Ov(Hv),Qv=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(bv),Zv=Ov(Qv),Kv=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(bv),eb=Ov(Kv),tb=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(bv),nb=Ov(tb),rb=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(bv),ib=Ov(rb),ab=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(bv),ob=Ov(ab),sb=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(bv),ub=Ov(sb),cb=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(bv),fb=Ov(cb),lb=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(bv),db=Ov(lb),pb=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(bv),hb=Ov(pb),gb=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(bv),mb=Ov(gb),yb=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(bv),vb=Ov(yb),bb=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(bv),xb=Ov(bb),_b=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(bv),wb=Ov(_b),Sb=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(bv),Ab=Ov(Sb),Ib=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(bv),Mb=Ov(Ib),Pb=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(bv),Eb=Ov(Pb),jb=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(bv),Ob=Ov(jb),Fb=Ly(cy(300,.5,0),cy(-240,.5,1)),kb=Ly(cy(-100,.75,.35),cy(80,1.5,.8)),Nb=Ly(cy(260,.75,.35),cy(80,1.5,.8)),Cb=cy(),zb=Pm(),Tb=Math.PI/3,Lb=2*Math.PI/3;function Bb(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var Db,Rb=Bb(bv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Ub=Bb(bv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),qb=Bb(bv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Gb=Bb(bv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Vb=Object.freeze({__proto__:null,schemeCategory10:xv,schemeAccent:_v,schemeDark2:wv,schemePaired:Sv,schemePastel1:Av,schemePastel2:Iv,schemeSet1:Mv,schemeSet2:Pv,schemeSet3:Ev,schemeTableau10:jv,interpolateBrBG:kv,schemeBrBG:Fv,interpolatePRGn:Cv,schemePRGn:Nv,interpolatePiYG:Tv,schemePiYG:zv,interpolatePuOr:Bv,schemePuOr:Lv,interpolateRdBu:Rv,schemeRdBu:Dv,interpolateRdGy:qv,schemeRdGy:Uv,interpolateRdYlBu:Vv,schemeRdYlBu:Gv,interpolateRdYlGn:Jv,schemeRdYlGn:$v,interpolateSpectral:Wv,schemeSpectral:Yv,interpolateBuGn:Xv,schemeBuGn:Hv,interpolateBuPu:Zv,schemeBuPu:Qv,interpolateGnBu:eb,schemeGnBu:Kv,interpolateOrRd:nb,schemeOrRd:tb,interpolatePuBuGn:ib,schemePuBuGn:rb,interpolatePuBu:ob,schemePuBu:ab,interpolatePuRd:ub,schemePuRd:sb,interpolateRdPu:fb,schemeRdPu:cb,interpolateYlGnBu:db,schemeYlGnBu:lb,interpolateYlGn:hb,schemeYlGn:pb,interpolateYlOrBr:mb,schemeYlOrBr:gb,interpolateYlOrRd:vb,schemeYlOrRd:yb,interpolateBlues:xb,schemeBlues:bb,interpolateGreens:wb,schemeGreens:_b,interpolateGreys:Ab,schemeGreys:Sb,interpolatePurples:Mb,schemePurples:Ib,interpolateReds:Eb,schemeReds:Pb,interpolateOranges:Ob,schemeOranges:jb,interpolateCividis:function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-2710.57*e)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-67.37*e)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-2475.67*e)))))))+")"},interpolateCubehelixDefault:Fb,interpolateRainbow:function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Cb.h=360*e-100,Cb.s=1.5-1.5*t,Cb.l=.8-.9*t,Cb+""},interpolateWarm:kb,interpolateCool:Nb,interpolateSinebow:function(e){var t;return e=(.5-e)*Math.PI,zb.r=255*(t=Math.sin(e))*t,zb.g=255*(t=Math.sin(e+Tb))*t,zb.b=255*(t=Math.sin(e+Lb))*t,zb+""},interpolateTurbo:function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"},interpolateViridis:Rb,interpolateMagma:Ub,interpolateInferno:qb,interpolatePlasma:Gb}),$b={categorical:[],sequential:[],rainbow:[],diverging:[],all:[]};function Jb(){Db||(Db={},Wb("categorical","Category10,Accent,Dark2,Paired,Pastel1,Pastel2,Set1,Set2,Set3,Tableau10"),Wb("sequential","Blues,Greens,Greys,Purples,Reds,Oranges,BuGn,BuPu,GnBu,OrRd,PuBuGn,PuBu,PuRd,RdPu,YlGnBu,YlGn,YlOrBr,YlOrRd"),Wb("rainbow","Cividis,CubehelixDefault,Rainbow,Warm,Cool,Sinebow,Turbo,Viridis,Magma,Inferno,Plasma"),Wb("diverging","BrBG,PRGn,PRGn,PiYG,PuOr,RdBu,RdGy,RdYlBu,RdYlGn,Spectral"),function(){function e(e){e.forEach((function(e){Vb["scheme"+e]||ht("Warning: missing data for",e)}))}function t(e){e.forEach((function(e){Vb["interpolate"+e]||ht("Missing interpolator for",e)}))}e($b.categorical),e($b.sequential),e($b.diverging),t($b.sequential),t($b.rainbow),t($b.diverging)}(),Hb("Category20","1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Hb("Category20b","393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Hb("Category20c","3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Hb("Tableau20","4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"),$b.all=[].concat($b.sequential,$b.rainbow,$b.diverging,$b.categorical))}function Yb(e){if(!e)return null;for(var t=e.toLowerCase(),n=0;n<$b.all.length;n++)if($b.all[n].toLowerCase()==t)return $b.all[n];return null}function Wb(e,t){$b[e]=$b[e].concat(t.split(","))}function Hb(e,t){$b.categorical.push(e),Db[e]=function(e){for(var t=[],n=0,r=e.length;n<r;n+=6)t.push("#"+e.substr(n,6));return t}(t)}function Xb(e,t){var n;return Jb(),Zb(e=Yb(e))?n=Kb(e)?Db[e]||Vb["scheme"+e]:ex(e,t):dt("Unknown color scheme name:",e),t>n.length?(ht("Color scheme has",n.length,"colors. Using duplication to match",t,"categories."),n=Qb(n,t)):n=n.slice(0,t),n}function Qb(e,t){for(;e.length>0&&e.length<t;)e=e.concat(e.slice(0,t-e.length));return e}function Zb(e){return Jb(),$b.all.includes(Yb(e))}function Kb(e){return Jb(),$b.categorical.includes(Yb(e))}function ex(e,n,r){Jb(),e=Yb(e);var i,a=Vb["scheme"+e],o=Vb["interpolate"+e];return a||o||dt("Unknown color scheme name:",e),$b.categorical.includes(e)&&dt(e," is a categorical color scheme (expected a sequential color scheme)"),i=a&&a[n]?a[n]:function(e,n){n>0!=0&&t.isInteger(n)||lt("Expected a positive integer");for(var r=[],i=0;i<n;i++)r.push(e(i/(n-1)));return r}(o,n),r&&(i=By(i,r)),i}var tx=["quantile","nice","equal-interval","hybrid","breaks"],nx=["non-adjacent","indexed","categorical"].concat(tx);function rx(e,t,n,r){var i=new go(t,n.arcs);return e.map((function(e){return function(e){var t=null;return e&&(t=e.reduce(a,[])),t&&t.length>0?t:null}(e)}));function a(e,t){for(var n,a,o=null,s=0;s<t.length;s++)n=t[s],(a=i.arcIsEnclosed(n))&&"clip"==r||!a&&"erase"==r?(o||e.push(o=[]),o.push(n)):o=null;return e}}nu.classify=function(e,n,r){e.data||vi(e);var i,a,o,s,u,c,f,l,d,p,h,g=r||{},m=e.data&&e.data.getRecords(),y=!!g.colors;g.color_scheme&&dt("color-scheme is not a valid option, use colors instead"),g.index_field?(i=g.index_field,a=kr(g.field,m)):g.field&&(i=g.field,a=kr(g.field,m)),i&&ti(e.data,i),p=function(e,t){var n;if(e.method)n=e.method;else if(e.breaks)n="breaks";else if(e.index_field)n="indexed";else if(e.categories||"string"==t)n="categorical";else if("number"==t)n="quantile";else if("date"==t||"object"==t)dt("Data type does not support classification:",t);else{if(null===t)return null;dt(void 0===t?"Expected a data field to classify or the non-adjacent option":"Unable to determine which classification method to use.")}return nx.includes(n)||dt("Not a recognized classification method:",n),tx.includes(n)&&"number"!=t&&null!==t&&dt("The",n,"method requires a numerical data field"),n}(g,a),"non-adjacent"==p?("polygon"!=e.geometry_type&&dt("The non-adjacent option requires a polygon layer"),i&&dt("The non-adjacent option does not accept a data field argument")):i||dt("Missing a data field to classify"),"categorical"==p&&(g.categories&&!g.categories.includes("*")||!i||(g.categories=Lr(m,i))),g.classes?(t.isInteger(g.classes)&&g.classes>1!=0||dt("Invalid number of classes:",g.classes,"(expected a value greater than 1)"),l=g.classes):l="indexed"==p&&i?function(e,n){var r=[],i=-1;return e.forEach((function(e){var a=(e||{})[n];!t.isInteger(a)||a<-2?r.push(a):i=Math.max(i,a)})),r.length>0&&dt(`Class index field contains invalid value(s): ${r.slice(0,5)}`),i+1}(m,i):g.breaks?g.breaks.length+1:"categorical"==p&&g.categories?g.categories.length:g.colors&&g.colors.length>1?g.colors.length:g.values&&g.values.length>1?g.values.length:"non-adjacent"==p?5:4,(d=g.continuous?l+1:l)>1==0&&dt("Missing a valid number of values"),s=function(e,n,r){var i,a="categorical"==e||"non-adjacent"==e,o=r.colors&&1==r.colors.length?r.colors[0]:null;if("random"==o){if(a)return function(e){Jb();var n=Xb("Tableau20",20);return t.shuffle(n),(n=Qb(n,e)).slice(0,e)}(n);ht("Randomly selected color ramp:",i=function(e){Jb();var t=$b[e];return t||lt("Unknown color scheme type:",e),t[Math.floor(Math.random()*t.length)]}("sequential"))}else Zb(o)?i=o:o&&!ds(o)?dt("Unrecognized color scheme name:",o):r.colors&&r.colors.forEach(ps);return i?a&&Kb(i)?Xb(i,n):ex(i,n,r.stops):r.colors||r.values?a?function(e,t){return t!=e.length&&dt("Mismatch in number of categories and number of values"),e}(r.colors||r.values,n):function(e,n,r){var i=function(e){var n=e;return e.every(t.parseNumber)&&(n=e.map((function(e){return+e}))),n}(e);return n!=i.length||r.stops?function(e,t,n){if(e.length==t&&!n)return e;for(var r,i,a,o,s=e.length-1,u=[e[0]],c=1;c<t-1;c++)a=(r=c/(t-1)*s)-(i=Math.floor(r)),o=Py(e[i],e[i+1])(a),u.push(o);return u.push(e[e.length-1]),n&&(u=By(u,n)),u}(i,n,r.stops):i}(r.colors||r.values,n,r):function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}(n)}(p,d,g),g.invert&&(s=s.concat().reverse()),y&&ht("Colors:",(h=s).some((e=>t.isString(e)&&0===e.indexOf("rgb(")))?function(e){return e.map((function(e){var t=Sm(e);return t||dt("Unable to parse color:",e),t.formatHex()}))}(h):h),u=function(e){return"null_value"in e?(n=e.null_value,t.isString(n)&&!isNaN(+n)&&(n=+n),"null"===n&&(n=null),n):e.colors?"#eee":e.values?null:-1;var n}(g),null===a?f=function(){return u}:"non-adjacent"==p?f=function(e,n,r){si(e);var i,a,o,s=dv(e,n.arcs),u=0,c=t.range(Kr(e)).map((function(e){var t=s(e)||[];return{nabes:t,colorId:-1,nabeColors:[],uncolored:t.length,saturation:0,common:0}})),f=(i=r.length,a=t.range(i),o=new Uint32Array(i),function(e){return e>=0&&e<i?(o[e]++,t.sortArrayIndex(a,o,!0)):void 0!==e&&lt("Unexpected color index:",e),a}),l=f(),d=function(e){var n=e.concat();return t.sortOn(n,"uncolored",!0),{forEach:function(t){for(var r;n.length>0;)t(r=n.pop()),gv(r,n,e)}}}(c);return d.forEach((function(e){var t=function(e,t,n){for(var r,i=0;i<n.length;i++)if(vv(e,t,r=n[i]))return r;return-1}(e,c,l);-1==t&&(u++,t=l[0]),e.colorId=t,l=f(t)})),u>0&&ht(`Unable to find non-adjacent colors for ${u} ${1==u?"polygon":"polygons"}`),function(e){return r[c[e].colorId]}}(e,n,s):c="indexed"==p?function(e,n,r){var i=e.length,a=Uy(e,n,r);return function(e){var n=t.isInteger(e)&&e>=0&&e<i?e:-1;return a(n)}}(s,u,g):"categorical"==p?cv(s,u,g):tv(s,u,Tr(m,i),p,g),c&&(f=function(e){var t=m[e]||{};return c(t[i])}),o=y?"polyline"==e.geometry_type?"stroke":"fill":"class",g.save_as?o=g.save_as:ht(`Output was saved to "${o}" field (use save-as= to change)`),m.forEach((function(e,t){e[o]=f(t)}))},nu.filterSlivers=function(e,n,r){return"polygon"!=e.geometry_type?0:function(e,n,r){var i=is(e,n,t.extend({sliver_control:1},r)),a=i.filter,o=0;return ar(e.shapes,(function(e,t,n){if(a(e))return o++,null})),ht(t.format("Removed %'d sliver%s using %s",o,t.pluralSuffix(o),i.label)),o}(e,n,r)};var ix=Object.freeze({__proto__:null,clipPolylines:rx});function ax(e,t,n,r,i){var a=n.arcs,o=i||{},s=new Uint8Array(a.size()),u=new Uint8Array(a.size()),c=0,f=0,l=[],d=Co(n,(function(e){var t,n,i=e>=0,a=i?e:~e,o=u[a],c=s[a];i?(t=o,n=c):(t=o>>4,n=c>>4),n&=3;var d=!1;return 3==(t&=3)?1==n||2==n&&"erase"==r||(d=!0):0===t&&3==n&&(l.push(e),d=!0),d&&(3==n&&f++,o=i?jo(o,1,3):jo(o,16,48)),o|=i?4:64,u[a]=o,d}),(function(e){var t=e>=0,n=t?e:~e,r=t?1:16,i=u[n],a=s[n];return a>0&&c++,(i&r)>0||(a&r)>0})),p=function(e,t){t=t&&!e.arcs.isPlanar();var n=new Uint8Array(e.arcs.size()),r=Fu(e,t),i=zo(e,n);return function(t){if(!t)return null;var n=[],a=[];r(t,n,a),n=i(n,"flatten"),a.forEach($n),(a=i(a,"flatten")).forEach($n);var o=function(e,t){for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e}(n,a),s=i(o,"dissolve");return s.length>1&&(s=function(e,t){if(e.length<=1)return e;var n=er(e,t,"polygon"),r=new go(e.map((function(e){return[e]})),t);return e.filter((function(e,t){var i,a=r.findSmallestEnclosingPolygon(e),o=!0;return a>-1&&(i=n[t].area>0,n[a].area>0==i&&(o=!1)),o}))}(s,e.arcs)),s.length>0?s:null}}(n);o.bbox2||(e=e.map(p)),ko(t,a,s,"clip"==r,"erase"==r,!0,17);var h=new go(t,a),g=e.map((function(e,t){return e?function(e,t,n){var r=[],i="clip"==t,o="erase"==t;return ko(e,a,u,!0,!1,!1),ir(e,(function(e){for(var t,a=0,s=e.length;a<s;a++)if(c=0,f=0,t=d(e[a]))if(0===c||0===f){var u=n.pathIsEnclosed(t);(i&&u||o&&!u)&&r.push(t)}else r.push(t)})),No(e,0,u,!0,!0,!0),l.length>0&&(No(l,0,u,!0,!0,!0),l=[]),0===r.length?null:r}(e,r,h):null})),m=function(e){return e.map((function(e){var t=[];return ir(e,(function(e){for(var n,r=!0,i=!1,a=0;a<e.length;a++){if(n=e[a],void 0,0!=(68&u[zt(n)])){r=!1;break}!i&&y(e[a],s)&&(i=!0)}r&&i&&t.push(e)})),t.length>0?t:null}))}(t);return No(t,0,u,!0,!0),h=new go(m,a),e.forEach((function(e,t){var n=e?function(e,t,n){var r=n.findPathsInsideShape(e),i=[];return r?("erase"==t&&r.forEach($n),r.length<=1?i=r:(ko(r,a,u,!0,!1,!0),r.forEach((function(e){for(var t,n=0;n<e.length;n++)(t=d(e[n]))&&i.push(t)}))),i.length>0?i:null):null}(e,r,h):null;n&&(g[t]=(g[t]||[]).concat(n))})),g;function y(e,t){return(17&t[zt(e)])>0}}function ox(e,t,n,r){var i=new go(t,n);return e.reduce((function(e,t){for(var n,a=t?t.length:0,o=[],s=0;s<a;s++)n=i.findEnclosingShape(t[s])>-1,("clip"==r&&n||"erase"==r&&!n)&&o.push(t[s].concat());return e.push(o.length>0?o:null),e}),[])}var sx=Object.freeze({__proto__:null,clipPoints:ox});function ux(e,n,r,i){t.some(e,Hr);var a,o,s,u,c,f,l,d,p,h=i.bbox||i.bbox2;return r&&r.geometry_type&&(r={dataset:n,layer:r,disposable:!0}),h?(c=(u=h)[0],f=u[1],l=u[2],d=u[3],p=[[c,f],[c,d],[l,d],[l,f],[c,f]],d>f&&l>c||dt("Invalid bbox (should be [xmin, ymin, xmax, ymax]):",u),o={arcs:new da([p]),layers:[{shapes:[[[0]]],geometry_type:"polygon"}]},s=o.layers[0]):r?r.layer&&r.dataset?(s=r.layer,o=t.defaults({layers:[s]},r.dataset)):r.layers&&1==r.layers.length&&(s=r.layers[0],o=r):dt("Command requires a source file, layer id or bbox"),n.arcs!=o.arcs?(r&&!r.disposable&&(o.layers[0]=pi(o.layers[0])),ya(a=Sa([n,o]))):((a=t.extend({},n)).layers=n.layers.filter((function(e){return e!=s})),a.layers.push(s)),a}var cx=Object.freeze({__proto__:null,mergeLayersForOverlay:ux});function fx(e,t){var n=e.arcs,r=function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=[],s=[],u=[],c=[];return e.forEachSegment((function(e,t,l,d){var p,h=l[e],g=d[e],m=l[t],y=d[t];lx(h,g,m,y,n,r,i,a)||dx(h,g,m,y,n,r,i,a)||((p=Dn.segmentIntersection(n,a,i,a,h,g,m,y))&&f(o,p,e,t,l,d),(p=Dn.segmentIntersection(n,r,i,r,h,g,m,y))&&f(u,p,e,t,l,d),(p=Dn.segmentIntersection(n,r,n,a,h,g,m,y))&&f(c,p,e,t,l,d),(p=Dn.segmentIntersection(i,r,i,a,h,g,m,y))&&f(s,p,e,t,l,d))})),{cutPoints:c.concat(u,s,o),bboxPoints:px(t,c,o,s,u)};function f(e,t,n,r,i,a){t&&(e.push(l(t[0],t[1],n,r,i,a)),4==t.length&&e.push(l(t[2],t[3],n,r,i,a)))}function l(e,t,n,r,i,a){var o=qu(e,t,n,r,i,a);return Xu(e,t,o[0],o[1])}}(n,t),i=Hu(r.cutPoints,n);n.dedupCoords(),Wu(e,i);var a=function(e){for(var t,n,r=[],i=[],a={geometry_type:"polygon",shapes:[[i]]},o=0,s=e.length-1;o<s;o++)t=e[o],n=e[o+1],r.push([[t.x,t.y],[n.x,n.y]]),i.push(o);return{arcs:new da(r),layers:[a]}}(r.bboxPoints),o=Sa([e,a]),s=o.layers.pop();return e.arcs=o.arcs,e.layers=o.layers,s}function lx(e,t,n,r,i,a,o,s){return e<i&&n<i||e>o&&n>o||t<a&&r<a||t>s&&r>s}function dx(e,t,n,r,i,a,o,s){return e>i&&n>i&&e<o&&n<o&&t>a&&r>a&&t<s&&r<s}function px(e,n,r,i,a){var o={x:e[0],y:e[1]},s={x:e[0],y:e[3]},u={x:e[2],y:e[3]},c={x:e[2],y:e[1]};return n=t.sortOn(n.concat([o,s]),"y",!0),r=t.sortOn(r.concat([s,u]),"x",!0),i=t.sortOn(i.concat([u,c]),"y",!1),a=t.sortOn(a.concat([c,o]),"x",!1),n.concat(r,i,a).reduce((function(e,t){var n=e.length>0?e[e.length-1]:null;return null!==n&&n.x==t.x&&n.y==t.y||e.push(t),e}),[])}var hx=Object.freeze({__proto__:null,divideDatasetByBBox:fx,segmentOutsideBBox:lx,segmentInsideBBox:dx});function gx(e,t,n,r,i){var a=mx(e,t,n,r,i);e.forEach((function(e,t){var n=a[t];e.shapes=n.shapes,e.data=n.data})),Oa(n)}function mx(e,n,r,i,a){var o,s,u,c=t.some(e,Hr);return(a=a||{no_cleanup:!0}).bbox2&&c?yx(e,r,a):(s=(o=ux(e,r,n,a)).layers[o.layers.length-1],c?(u=Vu(o,a),r.arcs=o.arcs,s=fc(s=t.defaults({data:null},s),o,{quiet:!0,silent:!0})):u=new ja(o.arcs),vx(e,s,u,i,a))}function yx(e,t,n){return vx(e,fx(t,n.bbox2),new ja(t.arcs),"clip",n)}function vx(e,t,n,r,i){return si(t,"Requires a polygon clipping layer"),e.reduce((function(e,a){return"slice"==r?e=e.concat(function(e,t,n,r){return nu.splitLayer(t,r.id_field,{no_replace:!0}).map((function(t,i){var a=bx(e,t,n,"clip",r);return a.name=function(e,t,n){return"slice-"+(t?e.data.getRecords()[0][t]:n+1)}(t,r.id_field,i),a}))}(a,t,n,i)):e.push(bx(a,t,n,r,i)),e}),[])}function bx(e,t,n,r,i){var a,o,s,u=n.arcs,c=e.shapes?e.shapes.length:0,f=0;return 0===c?e:(e===t&&dt("Can't clip a layer with itself"),"point"==e.geometry_type?o=ox(e.shapes,t.shapes,u,r):"polygon"==e.geometry_type?o=ax(e.shapes,t.shapes,n,r,i):"polyline"==e.geometry_type?o=rx(e.shapes,t.shapes,n,r):dt("Invalid target layer:",e.name),s={name:e.name,geometry_type:e.geometry_type,shapes:o,data:e.data},i.remove_slivers&&"polygon"==s.geometry_type&&(f=function(e,t,n){var r=as(n,ss(e,n),1),i=new Uint8Array(n.size()),a=0;return Gn(t.shapes,i),ar(e.shapes,(function(e){for(var t=0,n=0,o=0,s=e&&e.length||0;o<s;o++)i[zt(e[o])]>0?n++:t++;if(n>0&&t>0&&r(e))return a++,null})),a}(s,t,u)),nu.filterFeatures(s,u,{remove_empty:!0,verbose:!1}),s.data&&(s.data=s.data.clone()),(a=c-s.shapes.length)&&f&&ht(xx(a,f)),s)}function xx(e,n){var r=e?t.format("%,d null feature%s",e,t.pluralSuffix(e)):"",i=n?t.format("%,d sliver%s",n,t.pluralSuffix(n)):"";return r||i?t.format("Removed %s%s%s",r,r&&i?" and ":"",i):""}nu.clipLayers=function(e,t,n,r){return mx(e,t,n,"clip",r)},nu.eraseLayers=function(e,t,n,r){return mx(e,t,n,"erase",r)},nu.clipLayer=function(e,t,n,r){return nu.clipLayers([e],t,n,r)[0]},nu.eraseLayer=function(e,t,n,r){return nu.eraseLayers([e],t,n,r)[0]},nu.sliceLayers=function(e,t,n,r){return mx(e,t,n,"slice",r)},nu.sliceLayer=function(e,t,n,r){return nu.sliceLayers([e],t,n,r)};var _x=Object.freeze({__proto__:null,clipLayersInPlace:gx,clipLayers:mx,clipLayersByBBox:yx,clipLayersByLayer:vx,getClipMessage:xx});function wx(e){var t,n=e.nodata||"white",r=e.precision?Uo(e.precision):null;return e.random||e.colors&&e.colors.length||dt("Missing colors= parameter"),e.random?t=function(e){return e&&e.length||(e="#ccc,#888,#444".split(",")),function(t){var n=e.length,r=void 0===t?Math.floor(Math.random()*n):function(e){for(var t=String(e),n=5381,r=t.length;r>0;)n=33*n^t.charCodeAt(--r);return Math.abs(n)}(t)%n;return e[r]}}(e.colors):e.breaks?(e.colors.length!=e.breaks.length+1&&dt("Number of colors should be one more than number of class breaks"),t=function(e,t,n,r){var i=rv(e,r),a=Ry(t,n);return function(e){return a(i(e))}}(e.breaks,e.colors,n,r)):e.categories?(e.colors.length!=e.categories.length&&dt("Number of colors should be equal to the number of categories"),t=cv(e.colors,n,e)):dt("Missing categories= or breaks= parameter"),t}nu.cluster=function(e,n,r){si(e);var i=function(e,n,r){var i,a,o,s,u,c,f,l=function(e){var t=e.max_width||1/0,n=e.max_height||1/0,r=e.max_area||1/0;return function(e,i){var a=e.area+i.area,o=Dn.distance2D(e.centroid.x,e.centroid.y,i.centroid.x,i.centroid.y),s=e.bounds.clone().mergeBounds(i.bounds);return(a>r||s.width()>t||s.height()>n)&&(o=-1),o}}(r),d=e.shapes.length,p=r.pct?t.parsePercent(r.pct):1,h=Math.round(d*p),g=r.group_by||null,m=e.shapes.map((function(t,r){var i=g&&e.data.getRecordAt(r)[g]||null;return{ids:[r],area:Dn.getShapeArea(t,n),bounds:n.getMultiShapeBounds(t),centroid:Dn.getShapeCentroid(t,n),group:i,friends:[]}})),y=[],v={};for(g&&!e.data&&dt("Missing attribute data table"),pv(e.shapes,n).forEach((function(e,t){var n,r,i=m[e[0]],a=m[e[1]];i.group===a.group&&((n={ids:e}).score=x(n),n.score<0||(r=y.length,i.friends.push(r),a.friends.push(r),y.push(n)))}));h-- >0&&(i=b());)c=void 0,f=void 0,a=(u=i).ids,o=void 0,s=void 0,o=m[a[0]],s=m[a[1]],o.bounds.mergeBounds(s.bounds),o.area+=s.area,o.ids=o.ids.concat(s.ids),function(e,t){var n=e.area/(e.area+t.area),r=e.centroid,i=t.centroid;r.x=r.x*n+i.x*(1-n),r.y=r.y*n+i.y*(1-n)}(o,s),m[a[0]]=null,m[a[1]]=null,o.friends=function(e){for(var t,n={},r=[],i=0;i<e.length;i++)(t=e[i])in n==0&&null!==y[t]&&(r.push(t),n[t]=!0);return r}(o.friends.concat(s.friends)),c=o,f=m.length,m[f]=c,function(e,t,n){for(var r,i,a=0,o=e.length;a<o;a++)i=e[a],w((r=y[i]).ids,t)&&(y[i]=_(r,t,n))}(c.friends,u.ids,f);return m.filter(Boolean).reduce((function(e,t,n){for(var r=t.ids,i=0;i<r.length;i++)e[r[i]]=n;return e}),[]);function b(){var e,t,n,r=-1,i=1/0;for(t=0,n=y.length;t<n;t++)null!==(e=y[t])&&e.score<i&&(i=e.score,r=t);return-1==r?null:(e=y[r],y[r]=null,e)}function x(e){return l(m[e.ids[0]],m[e.ids[1]])}function _(e,t,n){var r,i=e.ids[0],a=e.ids[1];return t[0]!=i&&t[1]!=i||(i=n),t[0]!=a&&t[1]!=a||(a=n),i==a?null:(e.ids=[i,a],(r=function(e){var t=e.ids[0],n=e.ids[1];return n<t&&(t=n,n=e.ids[0]),t+","+n}(e))in v?null:(v[r]=!0,e.score=x(e),e.score<0?null:e))}function w(e,t){return e[0]===t[0]||e[0]===t[1]||e[1]===t[0]||e[1]===t[1]}}(e,n,r);return $r(e,r.id_field||"cluster",i),e},nu.colorizer=function(e){var t;e.name||dt("Missing required name= parameter"),t=e.name,/^(stroke|stroke-width|stroke-dasharray|stroke-opacity|fill|fill-opacity|opacity|r|class)$/.test(t)&&dt('"'+e.name+'" is a reserved name'),a("defs")[e.name]=wx(e)};var Sx=Object.freeze({__proto__:null,getColorizerFunction:wx});function Ax(e){return e.includes("this.geojson")}function Ix(e,n){var r=!1,i={},a=bc(di(e),n,{},!0);return i.get=function(e){return a[e]},i.set=function(e,n){r=!0,t.isString(e)&&(e=JSON.parse(e)),a[n]=mc.toFeature(e)},i.done=function(){if(r)return Dp({type:"FeatureCollection",features:a})},i}function Mx(e,t,n,r){var i=t.data.getRecords(),a=jx(e,t,n,r),o=function(e,t){var n=t.data.getRecords();return function(t){var r=n[t];return!!r&&Ex(r[e])}}(e,t),s={},u=0;return t.shapes.forEach((function(e,t){if(o(t)){var n=a(t);n.group&&function(e,t){var n,r=t[e.group];if(r){r.shapes.push(e.shape);for(var i=0,a=e.values.length;i<a;i++)n=r.values.indexOf(e.values[i]),r.weights[n]+=e.weights[i]}else t[e.group]={shapes:[e.shape],weights:e.weights,values:e.values}}(n,s)}})),Object.keys(s).forEach((function(t){var n,r,a=s[t],o=Px(a);n=a.shapes,r=o,n.forEach((function(t){u++,i[t][e]=r}))})),u>0&&(u+=Mx(e,t,n,r)),u}function Px(e){var t=Math.max.apply(null,e.weights),n=e.weights.indexOf(t);return e.values[n]}function Ex(e){return!e&&0!==e}function jx(e,t,n,r){var i,a=n.isPlanar(),o=t.data.getRecords();function s(t,r){var s,u,c=o[t][e];Ex(c)||(s=Dn.calcPathLen([r],n,!a),-1==(u=i.values.indexOf(c))?(i.values.push(c),i.weights.push(s)):i.weights[u]+=s)}return function(e){return i={shape:e,weights:[],values:[],group:""},r(e,s),i.group=i.values.concat().sort().join("~"),i}}function Ox(e,n){var r=function(e,t){var n,r,i,a={isMax:function(e){return e===r.max},isMin:function(e){return e===r.min},isMode:function(e){return r.modes.indexOf(e)>-1}};return Object.defineProperty(a,"target",{get:function(){return i},enumerable:!0}),n=Js(e,{data:t},null,{context:a,returns:!0}),function(e,t,a){return r=a,i=t,n(e)}}(n,e),i=null;return function(e){return t.some(["isMax","isMin","isMode"],(function(t){return e.indexOf(t)>-1}))}(n)&&(i=function(e,t){var n,r,i,a;return a=Js(e,{data:t},null,{context:{isMax:function(e){e>r&&(r=e)},isMin:function(e){e<i&&(i=e)},isMode:function(e){n||(n=[]),n.push(e)}}}),function(e){var t;r=-1/0,i=1/0,n=null;for(var o=0;o<e.length;o++)a(e[o]);return t=n?eu(n):null,{max:r,min:i,modes:t?t.modes:null,margin:t?t.margin:null}}}(n,e)),function(e,t){var n,a,o=i?i(e):null,s=[];for(a=0;a<e.length;a++)!0===(n=r(e[a],t,o))?s.push(e[a]):!1!==n&&dt('"where" expression must return true or false');return s}}nu.comment=function(){},nu.dashlines=function(e,t,n){var r=Wi(t),i=a("defs");oi(e),i.splitFeature=function(e,t){var n=t.dash_length?Zo(t.dash_length,e):0,r=t.gap_length?Zo(t.gap_length,e):0;n>0==0&&dt("Missing required dash-length parameter"),r>=0==0&&dt("Invalid gap-length option");var i=function(e,t,n,r){var i,a,o,s,u=bg(r.planar?null:e),c=Qi(e)?Xt:Vt;function f(e){i&&a.push(e),n>0&&(o=s*((i=!i)?t:n))}return function(e){var l,d,p,h=0,g=e[0],m=[g];s=r.scaled?function(e,t,n){var r=n/(e+t),i=Math.floor(r),a=n/(i*(e+t)),o=n/(Math.ceil(r)*(e+t)),s=o;return a<1/o&&i>0&&(s=a),s}(t,n,function(e,t){for(var n=0,r=1,i=e.length;r<i;r++)n+=t(e[r-1][0],e[r-1][1],e[r][0],e[r][1]);return n}(e,c)):1,o=s*((i=!(n>0))?t:n),i||(o*=.5),a=[];for(var y=1,v=e.length;y<v;y++)if(p=g,g=e[y],!((l=c(p[0],p[1],g[0],g[1]))<=0)){for(;h+l>=o;)(d=(o-h)/l)>.999&&y==v-1&&(d=1),p=d<1?u(p[0],p[1],g[0],g[1],d):g,m.push(p),f(m),m=d<1?[p]:[],h=0,l*=1-d;m.push(g),h+=l}return h>0&&m.length>1&&f(m),a}}(e,n,r,t);return function(e){var t=e.geometry;return t?("LineString"==t.type&&(t.type="MultiLineString",t.coordinates=[t.coordinates]),"MultiLineString"!=t.type&&lt("Unexpected geometry:",t.type),t.coordinates=t.coordinates.reduce((function(e,t){try{var n=i(t);e=e.concat(n)}catch(e){throw console.error(e),e}return e}),[]),e):e}}(r,n),nu.evaluateEachFeature(e,t,"this.geojson = splitFeature(this.geojson)",n),delete i.splitFeature},nu.dataFill=function(e,n,r){var i=r.field;i||dt("Missing required field= parameter"),ti(e,i),"polygon"!=e.geometry_type&&dt("Target layer must be polygon type");var a,o,s,u=dv(e,n),c=(s=e.data.getRecords().map((function(e){return Ex(e[i])})),function(e){return s[e]});a=Mx(i,e,n,u),function(e,t,n,r,i){var a=jx(e,t,n,r),o=t.data.getRecords();t.shapes.forEach((function(t,n){if(i(n)){var r=a(n);if(!(r.values.length<2)){var s=o[n][e],u=Px(r);s!=u&&(o[n][e]=u)}}}))}(i,e,n,u,c),r.contiguous&&(o=function(e,t,n,r,i){var a=t.data.getRecords(),o={},s=new Uint8Array(t.shapes.length),u=null,c=0,f=i.weight_field||null;return f&&ti(t,f),t.shapes.forEach((function(e,t){d(t)})),Object.keys(o).forEach((function(e){var t,n,r,i=o[e];i.length<2||(n=-1/0,r=-1,i.forEach((function(e,t){e.weight>n&&(r=t,n=e.weight)})),-1!=(t=r)&&i.filter((function(e,n){return n!=t})).forEach(l))})),c>0&&Mx(e,t,n,r),c;function l(t){c++,t.shapes.forEach((function(t){a[t][e]=null}))}function d(i){if(1!=s[i]){var c=a[i][e],l=!1;if(!Ex(c)){if(u){if(c!=u.value)return}else l=!0,u={value:c,shapes:[],weight:0},c in o==0&&(o[c]=[]),o[c].push(u);u.weight+=f?a[i][f]:Dn.getShapeArea(t.shapes[i],n),u.shapes.push(i),s[i]=1,r(i).forEach(d),l&&(u=null)}}}}(i,e,n,u,r)),ht("Filled",a,"empty polygons"+t.pluralSuffix(a)),o>0&&ht("Removed",o,"non-contiguous polygon group"+t.pluralSuffix(o))},nu.define=function(e){e.expression||dt("Missing an assignment expression");var t=a("defs");Js(e.expression,{},null,{no_warn:!0})(null,t)},nu.dissolve2=function(e,t,n){return e.forEach(si),Vu(t,n),e.map((function(e){return Hr(e)?fc(e,t,n):e}))};var Fx=Object.freeze({__proto__:null,getJoinFilter:Ox});function kx(e,t,n,r){return Nx({data:e},t,n,r)}function Nx(e,n,r,i){var a,o,s,u,c,f,l,d,p,h,g,m,y,v=e.data,b=!!i.duplication,x=n.getRecords(),_=v.getRecords(),w=i.prefix||"",S=[],A=Dx(v.getFields(),n.getFields(),i),I=i.sum_fields||[],M=t.difference(A,I),P=new Uint32Array(x.length),E=0,j=0,O=[],F=0,k={};for(b&&(i.calc&&dt("duplication and calc options cannot be used together"),m=v.clone().getRecords(),y=e.shapes||[]),i.where&&(f=Ox(n,i.where)),i.calc&&(l=su(n,i.calc)),h=_.length,d=0;d<h;d++){for(s=_[d],(u=r(d))&&f&&(F+=u.length,F-=(u=f(u,s)).length),p=0,c=0,g=u?u.length:0;p<g;p++)a=x[o=u[p]],c>0&&b&&(s=Er(m[d]),_.push(s),y.push(nr(y[d]))),0===c||b?M.length>0&&Tx(s,a,M,w):1==c&&(M.length>0&&!w&&Bx(s,a,M,O),j++),I.length>0&&Lx(s,a,I,w),P[o]++,c++;l&&l(u,s),c>0?E++:s&&(i.unmatched&&S.push(t.extend({},s)),zx(s,M,I,w))}return function(e,n,r,i,a,o,s){var u=n-e;e>0!=0?(ht(t.format("Joined data from %'d source record%s to %'d target record%s",r,t.pluralSuffix(r),e,t.pluralSuffix(e))),u>0&&ht(t.format("%d target record%s received no data",u,t.pluralSuffix(u))),r<i&&ht(t.format("%d/%d source records could not be joined",i-r,i)),a>0&&ht(t.format("%d/%d source records were skipped",a,i)),o>0&&(ht(t.format("%d/%d target records were matched by multiple source records (many-to-one relationship)",o,n)),s.length>0&&ht(t.format("Inconsistent values were found in field%s [%s] during many-to-one join. Values in the first joining record were used.",t.pluralSuffix(s.length),s.join(","))))):ht("No records could be joined")}(E,h,function(e){for(var t=0,n=0,r=e.length;n<r;n++)e[n]>0&&t++;return t}(P),x.length,F,j,O),i.unjoined&&(k.unjoined={name:"unjoined",data:new Vr(x.filter((function(e,t){return 0===P[t]})))}),i.unmatched&&(k.unmatched={name:"unmatched",data:new Vr(S)}),k}function Cx(e){e.forEach((function(e){/:(str|num)/.test(e)&&dt("Unsupported use of type hints. Use string-fields= or field-types= options instead")}))}function zx(e,t,n,r){Tx(e,{},t,r),Lx(e,{},n,r)}function Tx(e,t,n,r){var i,a;r=r||"";for(var o=0,s=n.length;o<s;o++)a=r+(i=n[o]),Object.prototype.hasOwnProperty.call(t,i)?e[a]=t[i]:Object.prototype.hasOwnProperty.call(e,a)||(e[a]=null)}function Lx(e,t,n,r){var i,a;r=r||"";for(var o=0;o<n.length;o++)e[a=r+(i=n[o])]=(e[a]||0)+(t[i]||0)}function Bx(e,t,n,r){for(var i,a=0,o=n.length;a<o;a++)e[i=n[a]]!==t[i]&&-1===r.indexOf(i)&&r.push(i)}function Dx(e,n,r){var i;if(r.fields?r.fields.indexOf("*")>-1?i=n:Cx(i=r.fields):r.calc?i=[]:(i=n,r.keys&&(i=t.difference(i,[r.keys[1]]))),!r.force&&!r.prefix){var a=t.intersection(i,e);a.length>0&&(ht('Same-named fields not joined without the "force" flag:',a),i=t.difference(i,a))}return i}var Rx=Object.freeze({__proto__:null,joinTables:kx,joinTableToLayer:Nx,validateFieldNames:Cx,updateUnmatchedRecord:zx,findCollisionFields:Bx,getFieldsToJoin:Dx});function Ux(){return new qx("max")}function qx(e){var n,r,i,a=t.expandoBuffer(Int32Array),o=t.expandoBuffer(Int32Array),s="max"==e?function(e,t){var i=r[e],a=r[t];return n[i]<n[a]}:function(e,t){var i=r[e],a=r[t],o=n[i],s=n[a];return o>s||o===s&&i>a},u=0;function c(e){for(var t=d(e);t>e;)f(e,t),t=d(e=t)}function f(e,t){var n=r[e];l(e,r[t]),l(t,n)}function l(e,t){i[t]=e,r[e]=t}function d(e){var t=2*e+1,n=t+1,r=u;return t<r&&s(e,t)&&(e=t),n<r&&s(e,n)&&(e=n),e}this.init=function(e){var t;for(n=e,u=e.length,r=a(u),i=o(u),t=0;t<u;t++)l(t,t);for(t=u-2>>1;t>=0;t--)c(t)},this.size=function(){return u},this.updateValue=function(e,t){var r=i[e];n[e]=t,r>=0&&r<u||lt("Out-of-range heap index."),c(function(e){for(var t;e>0&&!s(e,t=e-1>>1);)f(e,t),e=t;return e}(r))},this.popValue=function(){return n[this.pop()]},this.getValue=function(e){return n[e]},this.peek=function(){return r[0]},this.peekValue=function(){return n[r[0]]},this.pop=function(){var e;return u<=0&&lt("Tried to pop from an empty heap."),e=r[0],l(0,r[--u]),c(0),e}}function Gx(e,t,n,r){return 0===n?[]:0===r.evenness?function(e,t,n){for(var r=t.getMultiShapeBounds(e),i=[],a=0;a<n;a++)i.push(Vx(e,t,r));return i}(e,t,n):function(e,t,n,r){var i=r.evenness>=0?Math.min(r.evenness,1):1,a=Dn.getPlanarShapeArea(e,t);if(a>0==0)return[];var o=t.getMultiShapeBounds(e),s=Math.round(n*o.area()/a);r.progressive&&(s=Math.ceil(s/6));for(var u=new Jx(o,s,i),c=[],f=0;f<n;f++)c.push($x(e,t,u));return u.done(),c}(e,t,n,r)}function Vx(e,t,n){for(var r,i,a=0;++a<100;)if(fn(r=n.xmin+Math.random()*n.width(),i=n.ymin+Math.random()*n.height(),e,t))return[r,i];return null}function $x(e,t,n){for(var r,i=0;++i<100;)if((r=n.getPoint())&&fn(r[0],r[1],e,t))return r;return null}function Jx(e,n,r){var i,a,o,s=e.xmin,u=e.ymin,c=e.width(),f=e.height(),l=.9*n*(.5*(r-1)+1),d=Math.round(Math.sqrt(l*c/f))||1,p=Math.ceil(d*f/c),h=c,g=d*p,m=-1,y=function(e){for(var t=[],n=0;n<e;n++)t.push([]);return t}(g),v=h/d*.7*r;function b(){var e;for(i||(i=t.range(g),t.shuffle(i));++m<g;)if(N(e=F(i[m])))return e}function x(e){var t=function(e){var t=z(e);return T(e)*d+t}(e);return y[t].push(e),e}function _(e,t,n){var r=L(t,n);if(-1!=r){var i=a[r],s=o.getValue(r);O(e,i)<s*s&&w(r)}}function w(e){var t=S(e);o.updateValue(e,t)}function S(e){var t=D(e),n=A(B(e),t,0,0,1);return a[e]=n,n.pop()}function A(e,t,n,r,i){for(var a,o,s,u,c,f=Math.pow(3,i),l=0,d=0;d<3;d++)for(var p=0;p<3;p++)(c=P(l,s=I(e,t,n+d,r+p,f),e,t))>l&&(l=c,u=s,a=d,o=p);return 2==i?(u.push(l),u):A(e,t,3*(n+a),3*(r+o),i+1)}function I(e,t,n,r,i){return[((n+.5)/i+e)/d*c+s,((r+.5)/i+t)/p*f+u]}this.done=function(){},this.getPoint=function(){return 1===r?(e=b())?x(e):(a||function(){var e=[];a=[];for(var t=0;t<g;t++)e.push(S(t));(o=new Ux).init(e)}(),function(){var e=o.peek(),t=a[e];return x(t),function(e,t){var n=D(t),r=B(t);w(t),_(e,r+1,n),_(e,r,n+1),_(e,r-1,n),_(e,r,n-1),_(e,r+1,n+1),_(e,r-1,n+1),_(e,r-1,n-1),_(e,r+1,n-1)}(t,e),v=o.peekValue(),t}()):0===r?k():function(){var e=Math.ceil(Math.pow(g,.8)),t=10*g,n=0,r=b();if(r)return x(r);for(;n++<t;){if(N(r=k()))return x(r);n%e==0&&(v*=.9)}return null}();var e};var M=[[0,0],[0,-1],[-1,0],[1,0],[0,1],[-1,1],[1,-1],[-1,-1],[1,1]];function P(e,t,n,r){for(var i,a,o,s=1/0,u=0;u<9;u++){if((a=j(t,n+(i=M[u])[0],r+i[1]))<e*e)return 0;a<s&&(s=a)}return o=Math.sqrt(s),Math.min(o,E(t,n,r))}function E(e,t,n){if(t>0&&n>0&&t<d-1&&n<p-1)return 1/0;var r=e[0],i=e[1];return 3*Math.min(r-s,s+c-r,i-u,u+f-i)}function j(e,t,n){for(var r,i=1/0,a=L(t,n),o=a>-1?y[a]:[],s=0;s<o.length;s++)(r=O(e,o[s]))<i&&(i=r);return i}function O(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function F(e){var t=D(e),n=B(e);return[(Math.random()+n)/d*c+s,(Math.random()+t)/p*f+u]}function k(){return F(Math.floor(Math.random()*g))}function N(e){var t=z(e),n=T(e);return!(C(e,t,n)||function(e,t,n){return E(e,t,n)<v}(e,t,n)||C(e,t+1,n)||C(e,t,n+1)||C(e,t-1,n)||C(e,t,n-1)||C(e,t+1,n+1)||C(e,t-1,n+1)||C(e,t-1,n-1)||C(e,t+1,n-1))}function C(e,t,n){var r=L(t,n);return-1!=r&&function(e,t,n){for(var r=n*n,i=0;i<t.length;i++)if(O(e,t[i])<r)return!0;return!1}(e,y[r],v)}function z(e){var t=e[0]-s,n=Math.floor(t/c*d);return n<0&&(n=0),n>=d&&(n=d-1),n}function T(e){var t=e[1]-u,n=Math.floor(t/f*p);return n<0&&(n=0),n>=p&&(n=p-1),n}function L(e,t){return e<0||t<0||e>=d||t>=p?-1:t*d+e}function B(e){return e%d}function D(e){return Math.floor(e/d)}}function Yx(e,t,n){var r={},i=n.save_as||"fill",a=n.colors||n.values;if(a?(r[i]=a[e],r.r=n.r||1.3):n.r&&(r.r=n.r),n.copy_fields)for(var o=0;o<n.copy_fields.length;o++)r[n.copy_fields[o]]=t[n.copy_fields[o]];return r}nu.divide=function(e,n,r,i){e.forEach(oi);var a=ux(e,n,r,i),o=Vu(a,i),s=a.layers.pop();si(s),n.arcs=a.arcs,e.forEach((function(e){!function(e,n,r,i){var a,o,s,u=new go(n.shapes,r.arcs),c=e.data?e.data.getRecords():[],f=[],l=[],d=[];function p(e){for(var t,n,r,i,c=[],f=[],l=[],d=null,p=0,h=e.length;p<h;p++)i=e[p],(n=(t=u.findShapesEnclosingArc(zt(i))).sort().join(","))===d?r.push(i):(r=[i],c.push(r),f.push(n),l.push(t)),d=n;!function(e,t,n){for(var r,i,u=0;u<e.length;u++)i=t[u],-1==(r=o.indexOf(i))?(o.push(i),a.push([e[u]]),s.push(n[u])):a[r].push(e[u])}(c,f,l)}e.shapes.forEach((function(e,n){var r=c[n]||{};if(!e)return f.push(null),void l.push(r);a=[],o=[],s=[],ir(e,p),a.forEach((function(e,n){f.push(e),l.push(n>0?t.extend({},r):r),d.push(s[n])}))})),e.shapes=f,e.data=new Vr(l),kx(e.data,n.data,(function(e){return d[e]||[]}),i)}(e,s,o,i)}))},nu.dots=function(e,n,r){si(e),Array.isArray(r.fields)||dt("Missing required fields parameter"),Yr(e)&&(r.fields.forEach((function(t,n){ti(e,t)})),(r.copy_fields||[]).forEach((function(t){ti(e,t)}))),Array.isArray(r.colors)&&r.colors.forEach(ps);var i=e.data?e.data.getRecords():[],a=[],o=[];e.shapes.forEach((function(e,s){var u=i[s];if(u)for(var c=function(e,n,r,i){var a={shapes:[],attributes:[]};if(!e)return a;var o=function(e){var t=[];return e.forEach((function(e,n){for(;e-- >0;)t.push(n)})),t}(i.fields.map((function(e){var t=r[e]||0;return i.per_dot>0&&(t=Math.round(t/i.per_dot)),t}))),s=function(e,n,r,i){for(var a=e.length>1?Kl(e,n):[e],o=function(e,n,r){if(1===e.length)return[r];var i=e.map((function(e){return Dn.getPlanarShapeArea(e,n)})),a=t.sum(i),o=r;return i.map((function(e,t){var n=e/a,r=Math.round(o*n);return o-=r,a-=e,r}))}(a,n,r),s=[],u=0;u<a.length;u++)s=s.concat(Gx(a[u],n,o[u],i));return s}(e,n,o.length,i);t.shuffle(o);for(var u,c,f,l,d=-1,p=!!i.multipart,h=0;h<s.length;h++)(f=s[h])&&(u=o[h],3===f.length&&i.debug&&(u=f.pop()),p&&u==d||(d=u,a.shapes.push(c=[]),l=Yx(u,r,i),a.attributes.push(l)),c.push(f));return a}(e,n,u,r),f=0,l=c.shapes.length;f<l;f++)a.push(c.shapes[f]),o.push(c.attributes[f])}));var s={geometry_type:"point",shapes:a,data:new Vr(o)};return li(s,e,null,r),[s]},nu.drop2=function(e,t,n){t.forEach((function(t){nu.drop(e,t.layers,t.dataset,n)}))},nu.drop=function(e,t,n,r){var i=!1;t.forEach((function(t){var a=t.data&&r.fields,o=a&&Fr(a,t.data.getFields()),s=!a&&!r.geometry&&!r.holes||o&&r.geometry;r.geometry&&(i|=Hr(t),delete t.shapes,delete t.geometry_type),r.holes&&"polygon"==t.geometry_type&&Ou(t,n.arcs),s?e.deleteLayer(t,n):o?delete t.data:a&&r.fields.forEach(t.data.deleteField,t.data)})),i&&qa(n)},nu.evaluateEachFeature=function(e,t,n,r){var i,a,o=Kr(e),s=t.arcs,u={geojson_editor:Ax(n)?Ix(e,t):null};o>0&&!e.data&&(e.data=new Vr(o)),r&&r.where&&(a=Gs(r.where,e,s)),i=Js(n,e,s,u);for(var c=0;c<o;c++)a&&!a(c)||i(c);var f=u.geojson_editor?u.geojson_editor.done():null;f&&Va(e,t,f)};var Wx={};function Hx(e,t){return t.split(",").map((function(t){var n=Number(t),r=Number(e);return t?r/n:""})).reverse().join(",")}nu.external=function(e){var t,n;e.module||dt('Missing required "module" parameter'),io.isFile(e.module)?t=e.module:io.isFile(e.module+".js")?t=e.module+".js":n=e.module,t&&(t=lr("path").join(process.cwd(),t));try{lr(t||n)(SA)}catch(e){dt("Unable to load external module:",e.message)}},nu.registerCommand=function(e,n){var r={name:e,options:n.options||[]};r.options.push({name:"target"}),t.defaults(r,n),function(e){"function"!=typeof e.command&&dt('Expected "command" parameter function'),e.target||dt('Missing required "target" parameter')}(r),Wx[e]=r},nu.runExternalCommand=function(e,t){var n=e.name,r=Wx[n];r||dt("Unsupported command:",n);var i=r.target,a=function(e,t,n){var r=new dp,i=r.command(e);return(t.options||[]).forEach((function(e){i.option(e.name,e)})),r.parseArgv(["-"+e].concat(n))[0]}(n,r,e._),o=t.findCommandTargets(a.target||"*"),s=o[0];s||dt("Missing a target"),"layer"==i&&(1!=s.layers.length||o.length>1)&&dt("This command only supports targeting a single layer"),o.length>1&&dt("Targetting layers from multiple datasets is not supported"),"layer"==i?r.command(s.layers[0],s.dataset,a.options):"layers"==i&&r.command(s.layers,s.dataset,a.options)},nu.frame=function(e,n,r){var i,a,o,s;+r.width>0==0&&+r.pixels>0==0&&dt("Missing a width or area"),r.width&&r.height&&((r=t.extend({},r)).aspect_ratio=Hx(r.width,r.height)),Ei(a=Ba(o=nu.rectangle(n,r)))?dt("Frames require projected, not geographical coordinates"):Wi(o)||ht("Warning: missing projection data. Assuming coordinates are meters and k (scale factor) is 1"),(i=Dc(a,r))[0]>0==0&&dt("Missing a valid frame width"),i[1]>0==0&&dt("Missing a valid frame height"),s={info:{},layers:[{name:r.name||"frame",data:new Vr([{width:i[0],height:i[1],bbox:a.toArray(),type:"frame"}])}]},e.addDataset(s)},Fc.frame=function(e){var n=.5,r=Lf([[[n,n],[n,e.height-n],[e.width-n,e.height-n],[e.width-n,n],[n,n]]]);return t.extend(r.properties,{fill:"none",stroke:e.stroke||"black","stroke-width":e["stroke-width"]||1}),[r]};var Xx=Object.freeze({__proto__:null,getAspectRatioArg:Hx});function Qx(e,t,n){var r=new jt(e),i="point"==t.geometry_type?function(e){return function(t){return e.containsPoint(t[0],t[1])?t:null}}(r):function(e,t){var n=e.toArray(),r=n[0],i=n[1],a=n[2],o=n[3];return function(n){if(!e.intersects(t.getSimpleShapeBounds(n)))return null;var s,u,c,f,l=!1,d=t.getShapeIter(n);for(d.hasNext()&&(s=d.x,u=d.y);d.hasNext();)if(c=s,f=u,!lx(s=d.x,u=d.y,c,f,r,i,a,o)){if(dx(s,u,c,f,r,i,a,o)){l=!0;break}if(Dn.segmentIntersection(r,o,a,o,s,u,c,f)||Dn.segmentIntersection(r,i,a,i,s,u,c,f)||Dn.segmentIntersection(r,i,r,o,s,u,c,f)||Dn.segmentIntersection(a,i,a,o,s,u,c,f)){l=!0;break}}return!l&&Dn.testPointInRing(r,i,n,t)&&(l=!0),l?n:null}}(r,n);return i}function Zx(e,t,n){var r=Qx(e,t,n);return function(e){var n=t.shapes[e];if(!n)return!1;for(var i=0;i<n.length;i++)if(r(n[i]))return!0;return!1}}nu.filterGeom=function(e,t,n){Wr(e)||dt("Layer is missing geometry"),n.bbox&&function(e,t,n){var r=Qx(n.bbox,e,t);ar(e.shapes,r)}(e,t,n),nu.filterFeatures(e,t,{remove_empty:!0,verbose:!1})};var Kx=Object.freeze({__proto__:null,getBBoxIntersectionTest:Zx,findShapesIntersectingBBox:function(e,t,n){for(var r=Zx(e,t,n),i=[],a=0;a<t.shapes.length;a++)r(a)&&i.push(a);return i}});function e_(e,t){return e&&t&&function(n){return e(n)&&t(n)}||e||t}function t_(e,t){return function(n){return Dn.countVerticesInPath(n,t)<=e}}function n_(e,t,n){for(var r=0,i=e.length;r<i;r++)if(n.arcIntersectsBBox(zt(e[r]),t))return!0;return!1}function r_(e,t,n){for(var r,i,a=n.getSimpleShapeBounds2(e),o=0,s=t.length;o<s;o++)if((r=t[o])&&r!=e&&n_(r,a,n)&&(i=n.getVertex(r[0],0),Dn.testPointInRing(i.x,i.y,e,n)))return!0;return!1}function i_(e){return(e||[]).reduce((function(e,n){var r=n.split("="),i=t.trimQuotes(r[0]),a=r.length>1?t.trimQuotes(r[1]):i;return a&&i||dt("Invalid name assignment:",n),e[a]=i,e}),{})}function a_(e){var t=Object.keys(e);return function(n){for(var r,i={},a=0,o=t.length;a<o;a++)r=t[a],i[e[r]]=n[r];return i}}function o_(e,t,n,r){var i=c_(e,t,n,r);return u_(e,n),Nx(e,n.data,i,r)}function s_(e,t,n,r){var i=f_(e,t,n);return u_(e,t),Nx(e,t.data,i,r)}function u_(e,t){e.data||(e.data=new Vr(e.shapes.length)),t.data||dt("Can't join a layer that is missing attribute data")}function c_(e,t,n,r){var i=f_(n,e,t),a=[],o=!!r.first_match;return n.shapes.forEach((function(e,t){for(var n,r=i(t),s=r?r.length:0,u=0;u<s&&((n=r[u])in a?a[n].push(t):a[n]=[t],!o);u++);})),function(e){return a[e]||null}}function f_(e,t,n,r){var i=new go(t.shapes,n),a=e.shapes;return function(e){var t=a[e],n=t?i.findEnclosingShapes(t[0]):[];return n.length>0?n:null}}nu.filterFeatures=function(e,n,r){var i,a,o,s=e.data?e.data.getRecords():null,u=e.shapes||null,c=Kr(e),f=u?[]:null,l=s?[]:null,d=fi(e,r),p=!!r.invert;return r.expression&&(i=Gs(r.expression,e,n)),r.ids&&(i=e_(i,(a=r.ids,o=new Set(a),function(e){return o.has(e)}))),r.remove_empty&&(i=e_(i,function(e,t){var n=e.shapes;return"polygon"==e.geometry_type?function(e,t){return function(n){return!!e[n]&&Dn.getPlanarShapeArea(e[n],t)>0}}(n,t):function(e){return!!n[e]}}(e,n))),r.bbox&&(i=e_(i,Zx(r.bbox,e,n))),i||dt("Missing a filter criterion"),t.repeat(c,(function(e){var t=i(e);p&&(t=!t),!0===t?(u&&f.push(u[e]||null),s&&l.push(s[e]||null)):!1!==t&&dt("Expression must return true or false")})),d.shapes=f,d.data=l?new Vr(l):null,r.no_replace&&(d=di(d)),!1!==r.verbose&&ht(t.format("Retained %,d of %,d features",Kr(d),c)),d},nu.filterIslands=function(e,n,r){var i=t.extend({sliver_control:0},r),a=n.arcs,o=0;"polygon"==e.geometry_type&&(i.min_area||i.min_vertices?(o+=function(e,t,n){var r=0,i=new Uint8Array(t.size());Gn(e.shapes,i);return ar(e.shapes,(function(e,a,o){if(1==e.length&&1===i[zt(e[0])]&&(!n||n(e))&&!r_(e,o,t))return r++,null})),r}(e,a,i.min_area?is(e,n,i).filter:t_(i.min_vertices,a)),i.remove_empty&&nu.filterFeatures(e,a,{remove_empty:!0,verbose:!1}),ht(t.format("Removed %'d island%s",o,t.pluralSuffix(o)))):ht("Missing a criterion for filtering islands; use min-area or min-vertices"))},nu.filterIslands2=function(e,n,r){var i=t.extend({sliver_control:0},r),a=n.arcs,o=0;"polygon"==e.geometry_type&&(i.min_area||i.min_vertices?(o+=function(e,t,n){var r=0,i=new Uint8Array(t.size());Gn(e.shapes,i);return ar(e.shapes,(function(e,a,o){if(1==e.length&&1===i[zt(e[0])]&&(!n||n(e))&&!r_(e,o,t))return r++,null})),r}(e,a,i.min_area?is(e,n,i).filter:t_(i.min_vertices,a)),i.remove_empty&&nu.filterFeatures(e,a,{remove_empty:!0,verbose:!1}),ht(t.format("Removed %'d island%s",o,t.pluralSuffix(o)))):ht("Missing a criterion for filtering islands; use min-area or min-vertices"))},nu.filterFields=function(e,t){var n=e.data;if(ni(n,t=t||[]),n){var r=i_(t);e.data.update(a_(r))}},nu.renameFields=function(e,n){var r=i_(n);ni(e.data,Object.keys(r)),t.defaults(r,i_(e.data.getFields())),e.data.update(a_(r))},nu.filterPoints=function(e,n,r){ai(e),r.group_interval>0==0&&dt("Expected a positive group_interval parameter");for(var i,a,o,s,u,c,f=og(n,r.group_interval),l=kt(e),d=Zh.from(l).triangles,p=new Uint8Array(l.length),h=0,g=d.length;h<g;h+=3)s=d[h],u=d[h+1],c=d[h+2],i=l[s],a=l[u],o=l[c],f(i,a)&&f(a,o)&&f(i,o)&&(p[s]=1,p[u]=1,p[c]=1);!function(e,n,r){var i=e.data?e.data.getRecords():null,a=e.shapes||null,o=Kr(e),s=a?[]:null,u=i?[]:null;t.repeat(o,(function(e){var t=1==p[e];!0===t?(a&&s.push(a[e]||null),i&&u.push(i[e]||null)):!1!==t&&dt("Expression must return true or false")})),e.shapes=s,e.data=u?new Vr(u):null}(e)};var l_=Object.freeze({__proto__:null,joinPointsToPolygons:o_,joinPolygonsToPoints:s_,prepJoinLayers:u_,getPolygonToPointsFunction:c_});function d_(e,t){var n,r=[],i=[],a=[],o=0;return e.forEach((function(e,u){!function(e,t){var u,c,f,l,d=!0,p=0;for(n=0;e.hasNext();){if(!1===t(s,u=e.x,c=e.y,f,l,p++)){d=!1;break}f=u,l=c}if(d&&1==n&&(ht("An invalid arc was created"),d=!1),d)r.push(n);else{for(;n-- >0;)i.pop(),a.pop();r.push(0),o++}}(e,t)})),e.updateVertexData(r,i,a),o;function s(e){e&&(i.push(e[0]),a.push(e[1]),n++)}}function p_(e){var t=[],n=[];function r(e,t){for(var r=0;r<t.length;r++)e.push([n.length]),n.push(t[r])}function i(t){for(var n=[],r=e.arcs.getShapeIter(t);r.hasNext();)n.push([r.x,r.y]);return n}this.done=function(){e.layers=t,n.length&&(e.arcs=new da(n),ya(e))},this.editLayer=function(n,a){var o=n.geometry_type;if(e.layers.indexOf(n)!=t.length&&lt("Layer was edited out-of-order"),o){var s=n.shapes.map((function(e,t){for(var n,s,u=[],c=0,f=e?e.length:0;c<f;c++)s="point"==o?e[c]:i(e[c]),n=a(s,c,e),Array.isArray(n)&&("point"==o?u.push(n):"polygon"!=o&&"polyline"!=o||r(u,n||[]));return u.length>0?u:null}));t.push(Object.assign(n,{shapes:s}))}else t.push(n)}}function h_(e,t,n){if(function(e){for(var t,n,r,i=0,a=1,o=e.length;a<o;a++)n=e[a-1],r=e[a],(t=Dn.distanceSq(n[0],n[1],r[0],r[1]))>i&&(i=t);return Math.sqrt(i)}(e)<t)return e;n||(n=g_(t));for(var r,i,a=[e[0]],o=1,s=e.length;o<s;o++)r=e[o-1],i=e[o],Dn.distance2D(r[0],r[1],i[0],i[1])>t+1e-4&&m_(a,n(r,i)),a.push(i);return a}function g_(e){return function(t,n){for(var r=[],i=Dn.distance2D(t[0],t[1],n[0],n[1]),a=Math.round(i/e)-1,o=(n[0]-t[0])/(a+1),s=(n[1]-t[1])/(a+1),u=1;u<=a;u++)r.push([t[0]+o*u,t[1]+s*u]);return r}}function m_(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}function y_(e,n){var r,i=function(e,n){var r=Un(e),i=e.getBounds(),a=function(e,n,r){for(var i=[.1,.2,.3,.4,.5,.6,.7,.8,.9],a=[],o=0;o<i.length;o++)for(var s=0;s<i.length;s++)a.push([i[o],i[s]]);var u=a.map((function(t){var i=e.xmin+e.width()*t[0],a=e.ymin+e.height()*t[1],o=r(i,a),s=r(i+n[0],a+n[1]);return o&&s?Dn.distance2D(o[0],o[1],s[0],s[1]):1/0})).filter((function(e){return e<1/0}));return u.length>0?t.findMedian(u):1/0}(i,r,n),o=function(e,t){var n=t(e.centerX(),e.centerY()),r=t(e.centerX(),e.ymin),i=t(e.xmax,e.centerY());return n&&r&&i?(Dn.distance2D(n[0],n[1],r[0],r[1])+Dn.distance2D(n[0],n[1],i[0],i[1]))/5e3:1/0}(i,n),s=Math.min(a,o);return s==1/0&&lt("Densification error"),s}(e,n),a=i*i*25;return d_(e,(function(e,t,o,s,u,c){var f=r;if(!(r=n(t,o)))return!1;c>0&&Dn.distanceSq(r[0],r[1],f[0],f[1])>a&&v_(s,u,f[0],f[1],t,o,r[0],r[1],n,i).forEach(e),e(r)}))}function v_(e,t,n,r,i,a,o,s,u,c,f){var l=(e+i)/2,d=(t+a)/2,p=u(l,d);if(p)return f=f||[],Dn.pointSegDistSq2(p[0],p[1],n,r,o,s)>c*c*.25&&Dn.distance2D(e,t,i,a)>.01&&(v_(e,t,n,r,l,d,p[0],p[1],u,c,f),f.push(p),v_(l,d,p[0],p[1],i,a,o,s,u,c,f)),f}function b_(e,t,n){var r=Ei(e);return n.offset&&(e=function(e,t,n){var r=ts(e,n,t);return t.padBounds(r[0],r[1],r[2],r[3]),t}(n.offset,e,t)),e.area()>0==0?null:(n.aspect_ratio&&(e=x_(n.aspect_ratio,e)),r&&(e=ji(e)),e)}function x_(e,t){var n,r,i=String(e).split(",").map(parseFloat),a=t.width()/t.height();return 1==i.length?i.push(i[0]):i[0]>i[1]&&i.reverse(),n=i[0],r=i[1],n||r?(n||(n=-1/0),r||(r=1/0),a<n?t.fillOut(n):a>r&&t.fillOut(r),t):t}function __(e,t){var n=t||{},r=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]];return n.interval>0&&(r=h_(r,n.interval)),"polyline"==n.geometry_type?{type:"LineString",coordinates:r}:{type:"Polygon",coordinates:[r]}}nu.fuzzyJoin=function(e,n,r,i){var a=r?r.layer:null;a&&Xr(a)||dt("Missing a point layer to join from"),ti(a,i.field),si(e),i.dedup_points&&nu.uniq(a,null,{expression:'this.x + "~" + this.y + "~" + this.properties['+JSON.stringify(i.field)+"]",verbose:!1}),function(e,n,r,i){var a=i.field,o=c_(e,n,r,{first_match:!0}),s=function(e,t){var n=e.data.getRecords();return function(e){for(var r,i=[],a=0;a<e.length;a++)r=n[e[a]],i.push(r[t]);return i}}(r,a),u=[],c=[],f=[];if(e.shapes.forEach((function(e,t){var l=o(t)||[],d=eu(s(l),!0),p=d.margin>0?d.modes[0]:null;null===p&&d.modes.length>1&&(p=function(e,t,n,r,i,a){var o=e.map((function(){return 0}));n.forEach((function(n){var s=t.shapes[n],u=t.data.getRecordAt(n)[r],c=e.indexOf(u);if(-1!==c){var f=function(e,t,n){var r=e[0];return Dn.getPointToShapeDistance(r[0],r[1],t,n)}(s,i,a);o[c]+=f}}));var s=Math.max.apply(null,o);return e[o.indexOf(s)]}(d.modes,r,l,a,e,n)),f[t]=d.count||0,i.no_dropouts&&c.push(d),u.push(p)})),$r(e,"join-count",f),$r(e,a,u),nu.dataFill(e,n,{field:a,weight_field:"join-count",contiguous:i.contiguous}),i.no_dropouts){var l=function(e,n,r){var i=Lr(n.data.getRecords(),r),a=Lr(e.data.getRecords(),r);return t.difference(i,a)}(e,r,a);l.length>0&&function(e,n,r,i){var a=e.data.getRecords(),o=[],s=[];r.map((function(e){var t=function(e,t){var n=-1,r=0;return t.forEach((function(t,i){var a=t.values.indexOf(e),o=a>-1?t.counts[a]:0;o>r&&(n=i,r=o)})),n}(e,i);t>-1&&-1===s.indexOf(t)?(a[t][n]=e,s.push(t)):o.push(e)})),ht("Restored",s.length,"dropout value"+t.pluralSuffix(s.length)),o.length>0&&ht("Failed to restore dropout value(s):",o.join(", "))}(e,a,l,c)}}(e,n,a,i)},nu.rectangles=function(e,n,r){Wr(e)||dt("Layer is missing geometric shapes");var i=Wi(n),a=e.data?e.data.getRecords():null,o={type:"FeatureCollection",features:e.shapes.map((function(t){var a="point"==e.geometry_type?Ft(t):n.arcs.getMultiShapeBounds(t);return(a=b_(a,i,r))?__(a.toArray(),r):null})).map((function(e,n){var i=a&&a[n]||null;return i&&r.no_replace&&(i=t.extend({},i)),{type:"Feature",properties:i,geometry:e}}))},s=Dp(o,{}),u=xa(n,[s]);return li(u[0],e,null,r),u},nu.rectangle2=function(e,t){var n=e.layers.map((function(n){var r=nu.rectangle({layer:n,dataset:e.dataset},t);return li(r.layers[0],n,null,t),t.no_replace||(r.layers[0].name=n.name||r.layers[0].name),r}));return xa(e.dataset,n)},nu.rectangle=function(e,t){var n,r,i;e?(n=yi(e.layer,e.dataset.arcs),i=e.dataset.info,r=Wi(e.dataset)):t.bbox&&(n=new jt(t.bbox),r=$i("wgs84")),(n=n&&b_(n,r,t))&&n.hasBounds()||dt("Missing rectangle extent");var a=Dp(__(n.toArray(),t),{});return a.layers[0].name=t.name||"rectangle",i&&Yi(a,i),a};var w_=Object.freeze({__proto__:null,applyAspectRatio:x_,convertBboxToGeoJSON:__});function S_(e,t){return t*Math.PI/180*function(e){return e.a*Math.sqrt(1-(e.es||0))}(e)}function A_(e){return e.params.proj.param}function I_(e){return!M_(e,"cassini,gnom,bertin1953,chamb,ob_tran,tpeqd,healpix,rhealpix,ocea,omerc,tmerc,etmerc")&&!function(e){return M_(e,"aeqd,gnom,laea,mil_os,lee_os,gs48,alsk,gs50,nsper,tpers,ortho,qsc,stere,ups,sterea")}(e)}function M_(e,t){return t.split(",").includes(A_(e))}function P_(e,t){var n=(e[0]||0)*Rt,r=(e[1]||0)*Rt,i=(e[2]||0)*Rt;return function(e){return e[0]*=Rt,e[1]*=Rt,(t?j_:E_)(e,n,r,i),e[0]*=Ut,e[1]*=Ut,e}}function E_(e,t,n,r){return 0!=t&&O_(e,t),0===n&&0===r||F_(e,n,r,!1),e}function j_(e,t,n,r){return 0===n&&0===r||F_(e,n,r,!0),0!=t&&O_(e,-t),e}function O_(e,t){var n=e[0]+t;n>Math.PI?n-=2*Math.PI:n<-Math.PI&&(n+=2*Math.PI),e[0]=n}function F_(e,t,n,r){var i,a=Math.cos(t),o=Math.sin(t),s=Math.cos(n),u=Math.sin(n),c=Math.cos(e[1]),f=Math.cos(e[0])*c,l=Math.sin(e[0])*c,d=Math.sin(e[1]);r?(i=d*s-l*u,e[0]=Math.atan2(l*s+d*u,f*a+i*o),e[1]=Math.asin(i*a-f*o)):(i=d*a+f*o,e[0]=Math.atan2(l*s-i*u,f*a-d*o),e[1]=Math.asin(i*s+l*u))}function k_(e,t){Qi(Wi(e))||dt("Command requires a lat-long dataset."),Array.isArray(t.rotation)&&t.rotation.length||dt("Invalid rotation parameter");var n=P_(t.rotation,t.invert),r=new p_(e);e.arcs&&e.arcs.flatten(),e.layers.forEach((function(e){var i=e.geometry_type;r.editLayer(e,function(e,t,n){var r;return"point"==e?function(e){return e.forEach(t),e}:"polyline"==e?function(e){return(e=h_(e,.5)).forEach(t),Ug(e)}:"polygon"==e?function(e,i,a){var o;if(function(e){for(var t=0,n=e.length;t<n;t++)if(!Rg(e[t]))return!1;return!0}(e)?e=h_(e,.5):(e.forEach(Lg),(e=h_(e=function(e){if(!function(e){for(var t=0,n=e.length;t<n;t++)if(Rg(e[t]))return!0;return!1}(e))return e;var t,n,r,i=[],a=!1;e.pop(),t=e[e.length-1],n=e[0];for(var o=1,s=e.length;o<=s;o++)(r=o==s?i[0]:e[o])&&((a||Dg(t,n))&&Dg(n,r)?a=!0:(!0===a&&(a=!1),i.push(n),t=n),n=r);return i.length>0&&i.push(i[0].concat()),i}(e),.5,(o=g_(.5),function(e,t){var n;return n=Bg(e)||Bg(t)?[]:Dg(e,t)?function(e,t,n){var r,i,a=[],o=e[1]<t[1];e[0]!=t[0]&&lt("Expected an edge segment"),o?(r=e[1],i=t[1]):(r=t[1],i=e[1]);for(var s=Math.floor(r/n)*n+n;s<i;)a.push([e[0],s]),s+=n;return o||a.reverse(),a}(e,t,.5):Yg(e,t)?[]:o(e,t),n}))).forEach(t)),0===i&&(r=[]),!(e.length<4))return zg(e[0],Cg(e))||lt("Open polygon ring"),r.push(e),i==a.length-1?n.debug?r:Gg(r):void 0;vt("Short ring",e)}:null}(i,n,t))})),r.done(),t.debug||(ya(e),Q_(e))}function N_(e,t){for(var n=t.arcs,r=qn(e.shapes,n),i=[],a=[],o=0,s=n.size();o<s;o++)r(o)&&(i.push({arcid:o}),a.push([[o]]));return{geometry_type:"polyline",data:new Vr(i),shapes:a}}function C_(e,t){for(var n,r=t.arcs,i={type:"FeatureCollection",features:[]},a=qn(e.shapes,r),o=0,s=r.size();o<s;o++)a(n=o)&&r.forEachArcSegment(n,u);function u(e,t,r,a){var o=r[e],s=a[e],u=r[t],c=a[t];i.features.push({type:"Feature",properties:{arc:n,i1:e,i2:t,x1:o,y1:s,x2:u,y2:c},geometry:{type:"LineString",coordinates:[[o,s],[u,c]]}})}var c=Sa([t,Dp(i,{})]);return t.arcs=c.arcs,c.layers.pop()}function z_(e){var t=[];return Nt(e,(function(e){t.push(e.concat())})),{type:"LineString",coordinates:t}}function T_(e,n,r){var i,a=(r=r||{}).where?Vs(r.where,e,n):null,o=r.each?function(e,t,n){var r,i=fv(t.shapes,n)((function(e,t){a(e,t,r)})),a=$s(e,t,n);return function(e,t){return r=e,i(t[0][0]),e}}(r.each,e,n):null,s=fv(e.shapes,n,{filter:a}),u=t.isArray(r.fields)?r.fields:[],c=0,f=[],l=[];return u.length>0&&!e.data&&dt("Missing a data table"),d(function(e,t){return D_(e,t((function(e,t){return-1==t?String(e):null})))}(e.shapes,s),"outer"),u.forEach((function(t){var n=e.data.getRecords();ti(e,t),d(D_(e.shapes,s((function(e,r){var i=n[e],a=n[r];return i&&a&&i[t]!==a[t]?e+"-"+r:null}))),t)})),d(B_(e.shapes,s),"inner"),li(i=L_(f,l),e,null,r),i;function d(e,n){var r=e.map((function(e,t){var r={RANK:c,TYPE:n};return o&&o(r,e),r}));f=t.merge(e,f),l=t.merge(r,l),c++}}function L_(e,t){return{geometry_type:"polyline",shapes:e,data:t?new Vr(t):null}}function B_(e,t){return D_(e,t((function(e,t){return t>-1?e+"-"+t:null})))}function D_(e,t){var n,r=[],i={},a=null,o=null;return Qn(e,(function(e){var s,u,c=e.arcId,f=t(c);f&&(u=f in i?i[f]:null,s=f==o&&e.shapeId==a.shapeId&&e.partId==a.partId,u?s?u[u.length-1].push(c):u.push([c]):(u=[[c]],i[f]=u,r.push(u)),e.i==n.arcs.length-1&&u.length>1&&u[0][0]==n.arcs[0]&&(u[0]=u.pop().concat(u[0]))),a=e,o=f}),(function(e){n=e})),r}nu.rotate=k_,nu.lines=function(e,n,r){return(r=r||{}).callouts?(ii(e),function(e,t,n){var r=e.data?e.data.getRecords():null,i=yi(e).width()/50,a=function(e){return[e,[e[0]+i,e[1]]]},o=xa(t,[Dp({type:"FeatureCollection",features:e.shapes.map((function(e,t){return{type:"Feature",properties:r?r[t]:null,geometry:{type:"MultiLineString",coordinates:e.map(a)}}}))})]);return li(o[0],e.name,null,n),o}(e,n,r)):"point"==e.geometry_type?function(e,n,r){var i=Dp(r.groupby?function(e,n,r){var i=[],a=cu([n],e.data),o=t.defaults({fields:[n]},r),s=lu(e.data.getRecords(),a,o);return e.shapes.forEach((function(e,t){var n=a(t);n in i==0&&(i[n]=[]),i[n].push(e)})),{type:"FeatureCollection",features:i.map((function(e,t){return{type:"Feature",properties:s[t],geometry:e.length>1?z_(e):null}}))}}(e,r.groupby,r):z_(e.shapes)),a=xa(n,[i]);return li(a[0],e,null,r),a}(e,n,r):r.segments?[C_(e,n)]:r.arcs?[N_(e,n)]:"polygon"==e.geometry_type?T_(e,n.arcs,r):void si(e,"Command requires a polygon or point layer")};var R_=Object.freeze({__proto__:null,polygonsToLines:T_,createLineLayer:L_,extractInnerLines:B_});function U_(e,t,n){var r;return M_(t,"stere,sterea,ups,ortho,gnom,laea,nsper,tpers")||n.clip_angle||t.clip_angle?r=function(e,t,n){var r,i,a=n.clip_angle||t.clip_angle||("nsper"==(i=A_(r=t))?function(e){var t=parseFloat(e.params.h.param);return!t||t<0?0:180*Math.acos(e.a/(e.a+t))/Math.PI*.995}(r):"tpers"==i?(ht("Automatic clipping is not supported for the Tilted Perspective projection"),0):{gnom:60,laea:179,ortho:89.9,stere:142,sterea:142,ups:10.5}[i]||0);if(!a)return null;yt(`Using clip angle of ${+a.toFixed(2)} degrees`);var o=function(e,t){return S_(e,t)}(e,a),s=function(e){var t=180/Math.PI;return[e.lam0*t,e.phi0*t]}(t);return t.clip_angle=a,Dp(Hg(s,o,null,n))}(e,t,n):(M_(t,"merc,bertin1953")||n.clip_bbox)&&(r=G_(t,n)),r||null}function q_(e,t,n){var r=U_(e,t,n);return r||(r=G_(t,{clip_bbox:[-180,-90,180,90]})),X_(r,e,t,{no_clip:!1,quiet:!0}),r}function G_(e,t){var n,r,i=t.clip_bbox||V_(e),a="bertin1953"==(r=A_(n=e))?[-16.5,-42]:"tmerc"!=r&&"utm"!=r&&"etmerc"!=r||0===n.lam0?null:[180*n.lam0/Math.PI];i||lt("Missing expected clip bbox.");var o=Dp(__(i,t=Object.assign({interval:.5},t)));return a&&k_(o,{rotation:a,invert:!0}),o}function V_(e){var t=.001,n=[-179,-90,179,90];return{tmerc:n,utm:n,etmerc:n,merc:[-180,-89,180,89],lcc:[-180,-89,180,89],bertin1953:[-180+t,-90+t,180-t,90-t]}[A_(e)]}function $_(e,t){var n,r,i,a,o;return e in lr("mproj").internal.pj_list==0?e:(i=["lcc","aea"].includes(e),a=["tmerc","etmerc"].includes(e),n="+proj="+e,(i||a)&&(r=function(e){return Qi(Wi(e))||dt("Expected unprojected data"),Ba(e).toArray()}(t),o=qo(r),ht(`Converted "${e}" to "${n+=" "+(a?Y_(r,o):J_(r,o))}"`)),n)}function J_(e,t){var n=(e[0]+e[2])/2,r=e[3]-e[1],i=e[1]+1/6*r,a=e[1]+5/6*r;return`+lon_0=${n.toFixed(t)} +lat_1=${i.toFixed(t)} +lat_2=${a.toFixed(t)}`}function Y_(e,t){var n=(e[0]+e[2])/2,r=(e[1]+e[3])/2;return`+lon_0=${n.toFixed(t)} +lat_0=${r.toFixed(t)}`}var W_=Object.freeze({__proto__:null,expandProjDefn:$_,getConicParams:J_,getCenterParams:Y_});function H_(e,t){var n,r,i={};return/\.prj$/i.test(e)?((n=jh(e,{}))&&(i.prj=n.info.prj,i.crs=ta(i.prj)),i):t&&(r=t.findSingleLayer(e))?(n=r.dataset,i.crs=Wi(n),i.prj=n.info.prj,i):(i.crs=$i(e),i)}function X_(e,n,r,i){var a=Li(n,r),o=0,s=0,u=function(e,n,r,i){if(!Qi(n)||i.no_clip)return!1;var a,o,s,u=function(e,t,n){var r,i=Oi(180*n.lam0/Math.PI);return!!(e.arcs&&(r=n,I_(r)&&0!==r.lam0)&&function(e,t){var n=0;return e.arcs.forEachSegment((function(e,r,i,a){var o=i[e],s=i[r];(o<=t&&s>=t||o>=t&&s<=t)&&n++})),n>0}(e,i))&&(function(e,t){var n=e.layers.filter(Hr);0!==n.length&&gx(n,Dp(__([t-1e-8,-91,t+1e-8,91],{interval:.5})),e,"erase")}(e,i),Oa(e),!0)}(e,0,r),c=!1,f=(M_(o=r,"merc,lcc")&&(s=V_(o)),s);return f?function(e,n){Ja(e,(function(e,r){return[t.clamp(e,n[0],n[2]),t.clamp(r,n[1],n[3])]}))}(e,f):a=function(e,t,n){return U_(e,t,n)}(n,r,i),a&&(gx(e.layers,a,e,"clip"),c=!0),u||c}(e,n,r,i);e.layers.forEach((function(e){Xr(e)&&(s+=Z_(e,a))})),e.arcs&&(o=i.densify?y_(e.arcs,a):ew(e.arcs,a)),u&&Q_(e),o>0&&!i.quiet&&ht(`Removed ${o} ${1==o?"path":"paths"} containing unprojectable vertices.`),s>0&&!i.quiet&&ht(`Removed ${s} unprojectable ${1==s?"point":"points"}.`),e.info.crs=r}function Q_(e){hc(e.layers.filter((e=>"polygon"==e.geometry_type)),e,{allow_overlaps:!0,rebuild_topology:!0,no_arc_dissolve:!0,quiet:!0,verbose:!1}),Oa(e)}function Z_(e,t){var n=0;return ar(e.shapes,(function(e){var r=t(e[0],e[1]);return r||n++,r})),n}function K_(e,t){for(var n,r=e.getVertexData(),i=r.xx,a=r.yy,o=r.zz,s=e.getRetainedInterval(),u=0,c=i.length;u<c;u++)(n=t(i[u],a[u]))||lt("Unprojectable point:",i[u],a[u]),i[u]=n[0],a[u]=n[1];e.updateVertexData(r.nn,i,a,o),e.setRetainedInterval(s)}function ew(e,t){return d_(e,(function(e,n,r,i,a,o){var s=t(n,r);if(!s)return!1;e(s)}))}nu.proj=function(e,n,r){var i,a;r.init&&((i=H_(r.init,n)).crs||dt("Unknown projection source:",r.init),Yi(e,i)),r.match?a=H_(r.match,n):r.crs&&(a=H_($_(r.crs,e))),a&&function(e,n,r){var i,a,o=Wa(),s=[],u={info:e.info||{}};if((a=n.crs)||dt("Missing projection data"),!Da(e))return e.info.crs=a,void(e.info.prj=n.prj);(i=Wi(e))||dt("Unable to project -- source coordinate system is unknown"),Ui(i,a)?ht("Source and destination CRS are the same"):(e.arcs&&(e.arcs.flatten(),u.arcs=o?e.arcs.getCopy():e.arcs),u.layers=e.layers.map((function(e){return o&&(s.push(e),e=pi(e)),e})),X_(u,i,a,r||{}),e.info.prj=n.prj,e.arcs=u.arcs,s.forEach((function(e,n){t.extend(e,u.layers[n])})))}(e,a,r)};var tw=Object.freeze({__proto__:null,getCrsInfo:H_,projectDataset:X_,cleanProjectedLayers:Q_,projectPointLayer:Z_,projectArcs:K_,projectArcs2:ew});function nw(e,n,r){var i=r.interval||10;[5,10,15,30,45].includes(i)||dt("Invalid interval:",i),e.lam0,Math.PI;var a=i>10?1:.5,o=i,s=i,u=Math.round(360/o),c=Math.round(180/s)+1,f=t.range(u,-180+o,o),l=t.range(c,-90,s),d=[],p=[],h=function(e){return I_(e)}(e)?function(e){var t=function(e){return 0===e.lam0?180:Oi(180*e.lam0/Math.PI)}(e);return 180==t?[-180,180]:[t-2e-8,t+2e-8]}(e):null;return f.forEach((function(e){h&&(g(e,h[0])||g(e,h[1]))||m(e,e%90==0)})),h&&!n&&(m(h[0],!0),m(h[1],!0)),l.forEach((function(e){!function(e){var t=h_([[-180,e],[180,e]],a);p.push(iw(t,{type:"parallel",value:e}))}(e)})),{type:"FeatureCollection",features:d.concat(p)};function g(e,t){return Math.abs(e-t)<i/5}function m(e,t){var n=s<=15?s:0;y(e,-90+n,90-n),t&&n>0&&(y(e,-90,-90+n),y(e,90-n,90))}function y(e,t,n){var r=h_([[e,t],[e,n]],a);d.push(iw(r,{type:"meridian",value:rw(e)}))}}function rw(e){return+e.toFixed(3)||0}function iw(e,t){return{type:"Feature",properties:t,geometry:{type:"LineString",coordinates:e}}}function aw(e){return!!cw(e).inControlBlock}function ow(e){var t=cw(e);t.inControlBlock=!0,t.active=!0,t.complete=!0}function sw(e){var t=cw(e);t.inControlBlock=!0,t.active=!1}function uw(e){return!!cw(e).complete}function cw(e){return e.control||(e.control={})}function fw(e,t){!uw(e)&&function(e,t){return!t.expression||function(e,t,n){var r,i=n.layer||n.target||null,o=t.findCommandTargets(i),s=1==o.length&&1==o[0].layers.length;0===o.length&&i&&dt("Layer not found:",i),r=s?Ds(o[0].layers[0],o[0].dataset.arcs):function(e){var t={},n=Ls(e);return ws(t,{name:r,data:r,type:r,size:r,empty:r,bbox:r}),t.field_exists=r,t.field_type=r,t.field_includes=r,t;function r(){throw Error(`This expression requires a single target layer; Received ${n} layers.`)}}(o),r.global=a("defs")||{};var u=Object.assign({returns:!0},n),c=Ws(e,u);return r.layer_exists=function(e,n){return 0!==t.findCommandTargets(e,n).length},r.file_exists=function(e){return io.isFile(e)},function(){try{return c.call(r,{},r)}catch(t){dt(t.name,"in expression ["+e+"]:",t.message)}}}(t.expression,e,t)()}(e.catalog,t)?ow(e):sw(e)}function lw(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=dw(e.charCodeAt(n));return t}function dw(e){return e>=4352&&(e<=4447||9001==e||9002==e||e>=11904&&e<=42191&&12351!=e||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65135||e>=65280&&e<=65376||e>=65504&&e<=65510||e>=131072&&e<=196605||e>=196608&&e<=262141)?2:1}function pw(e,t){var n=Kr(e),r={geometry_type:e.geometry_type,feature_count:n,null_shape_count:0,null_data_count:e.data?hw(e.data.getRecords()):n};return e.shapes&&e.shapes.length>0&&(r.null_shape_count=function(e){for(var t=0,n=0;n<e.length;n++)e[n]&&0!==e[n].length||t++;return t}(e.shapes),r.bbox=yi(e,t.arcs).toArray(),r.proj4=Bi(t)),r}function hw(e){for(var t=0,n=0;n<e.length;n++)e[n]||t++;return t}function gw(e,n){return e.data&&0!==e.data.size()&&0!==e.data.getFields().length?"\nAttribute data\n"+function(e,n){var r=Rr(e.getFields(),"ascending"),i=r.map((function(t){return e.getReadOnlyRecordAt(n||0)[t]})),a=i.reduce((function(e,n){return t.isNumber(n)&&(e=Math.max(e,yw(n))),e}),0),o=["Field"].concat(r),s=i.reduce((function(e,t){return e.push(vw(t,a)),e}),[n>=0?"Value":"First value"]),u=mw(o),c=mw(s),f=(t.rpad("",u+2,"-")+"+"+t.rpad("",c+2,"-")).substr(0,50)+"\n",l=f;return o.forEach((function(e,n){var r=lw(e);l+=" "+e+t.rpad("",u-r," ")+" | "+s[n]+"\n",0===n&&(l+=f)})),l+f}(e.data,n):"Attribute data: [none]\n"}function mw(e){return e.reduce((function(e,t){var n=lw(t);return n>e?n:e}),0)}function yw(e){return t.isNumber(e)?(t.formatNumber(e)+".").indexOf("."):0}function vw(e,n){var r;return r=t.isNumber(e)?t.lpad("",n-yw(e)," ")+t.formatNumber(e):t.isString(e)?function(e){var t={"\n":"\\n","\r":"\\r","\t":"\\t"};return e=e.replace(/[\r\t\n]/g,(function(e){return e in t?t[e]:""})),"'"+e+"'"}(e):t.isDate(e)?t.formatDateISO(e)+" (Date)":t.isObject(e)?JSON.stringify(e):String(e),"string"!=typeof r&&(r="["+typeof e+"]"),r}nu.graticule=function(e,t){var n,r,i=t.polygon?"polygon":"graticule";return e&&!Zi(e)?((r=Wi(e))||dt("Coordinate system is unknown, unable to create a graticule"),n=t.polygon?function(e,t){return q_($i("wgs84"),e,t)}(r,t):function(e,t){var n=$i("wgs84"),r=function(e,t,n){var r=U_(e,t,{});return r&&(X_(r,e,t,{no_clip:!1,quiet:!0}),r.layers[0].geometry_type="polyline"),r||null}(n,e),i=Dp(nw(e,!!r,t));return X_(i,n,e,{no_clip:!1}),r&&(i=function(e,t){var n=Sa([e,t]),r=n.layers.pop(),i=n.layers[0],a=i.data.getRecords();return r.shapes.forEach((function(e){i.shapes.push(e),a.push({type:"outline",value:null})})),n}(i,r)),ya(i),hc(i.layers,i,{verbose:!1}),i}(r,t)):n=t.polygon?function(e){var t=$i("wgs84");return q_(t,t,e)}(t):function(e){return Dp(nw($i("wgs84"),!1,e))}(t),n.layers[0].name=i,n},nu.if=function(e,t){aw(e)&&dt("Nested -if commands are not supported."),fw(e,t)},nu.elif=function(e,t){aw(e)||dt("-elif command must be preceded by an -if command."),fw(e,t)},nu.else=function(e){aw(e)||dt("-else command must be preceded by an -if command."),uw(e)?sw(e):ow(e)},nu.endif=function(e){aw(e)||dt("-endif command must be preceded by an -if command."),function(e){e.control=null}(e)},nu.ignore=function(e,t,n){n.empty&&ei(e)&&pt("Layer is empty, stopping processing")},nu.include=function(e){var r,i,o;if(e.file||dt("Missing name of a JS file to load"),io.checkFileExists(e.file,e.input),"string"==typeof(r=io.readFile(e.file,"utf8",e.input))){/^\s*\{[\s\S]*\}\s*$/.test(r)||dt("Expected a JavaScript object containing key:value pairs");try{(o=Qs()).require=n(451),i=Function("ctx","with(ctx) {return ("+r+");}").call({},o)}catch(e){dt(e.name,"in JS source:",e.message)}}else"object"==typeof r&&(i=r);t.extend(a("defs"),i)},nu.printInfo=function(e){var n="";e.forEach((function(e,r){var i="Layer:    "+(e.layer.name||"[unnamed layer]"),a=gw(e.layer),o=function(e){return Math.max.apply(null,e.split("\n").map((function(e){return lw(e)})))}(a),s=Math.min(Math.max(i.length,o),50);n+="\n",n+=t.lpad("",s,"=")+"\n",n+=i+"\n",n+=t.lpad("",s,"-")+"\n",n+=function(e,n){var r=pw(e,n),i="";return i+="Type:     "+(r.geometry_type||"tabular data")+"\n",i+=t.format("Records:  %,d\n",r.feature_count),r.null_shape_count>0&&(i+=t.format("Nulls:     %'d",r.null_shape_count)+"\n"),r.geometry_type&&r.feature_count>r.null_shape_count&&(i+="Bounds:   "+r.bbox.join(",")+"\n",i+="CRS:      "+r.proj4+"\n"),i+"Source:   "+(ui(0,n)||"n/a")+"\n"}(e.layer,e.dataset),n+=a})),ht(n)};var bw=Object.freeze({__proto__:null,getLayerData:pw,getAttributeTableInfo:gw,formatTableValue:vw});function xw(e,n,r,i){var a=ux([e],n,r,i),o=Vu(a,i),s=a.layers.pop();n.arcs=a.arcs,u_(e,s);var u=new sc({geometry_type:"polygon",shapes:e.shapes.concat(s.shapes)},o,{flat:!1}),c=t.extend({},i),f=function(e,n,r,i){var a,o,s,u=(o=e.shapes.length,s=n.shapes.length,function(e){for(var t,n=[],r=0;r<e.length;r++)(t=e[r]-o)>=0&&t<s&&n.push(t);return n});return i.largest_overlap&&(a=function(e,n,r){var i=r.nodes.arcs,a=e.shapes.length;return function(e,n){var o=r.getTileIdsByShapeId(e),s=0,u=-1;return n.forEach((function(e,n){var c=r.getTileIdsByShapeId(e+a),f=function(e){for(var t=0,n=0;n<e.length;n++)t+=Dn.getShapeArea(r.mosaic[e[n]],i);return t}(t.intersection(o,c));f>=s&&(u=e,s=f)})),-1==u&&lt("Geometry error"),[u]}}(e,0,r)),function(e){for(var n,o=r.getTileIdsByShapeId(e),s=[],c=0;c<o.length;c++)n=r.getSourceIdsByTileId(o[c]),n=u(n),s=s.length>0?s.concat(n):n;return(s=t.uniq(s)).length>1&&i.largest_overlap&&(s=a(e,s)),s}}(e,s,u,i),l=Nx(e,s.data,f,c);return i.interpolate&&(i.duplication&&dt("duplication and interpolate options cannot be used together"),function(e,t,n,r){var i=function(e,t,n,r){var i=r.planar?Dn.getPlanarShapeArea:Dn.getShapeArea,a=e.shapes.length,o=n.mosaic,s=n.nodes.arcs,u=o.map((function(e,t){return{area:i(e,s),weight:0,sourceId:-1}}));return t.shapes.forEach((function(e,t){for(var r,o=n.getTileIdsByShapeId(t+a),c=i(e,s),f=0;f<o.length;f++)(r=u[o[f]]).sourceId>-1||(r.weight=r.area/c,r.sourceId=t)})),u}(e,t,n,r),a=r.interpolate,o=t.data.getRecords();e.data.getRecords().forEach((function(e,t){var r,s,u=n.getTileIdsByShapeId(t),c=[];for(r=0;r<u.length;r++)c.push(i[u[r]]);for(r=0;r<a.length;r++)e[s=a[r]]=_w(s,c,o)}))}(e,s,u,i)),l}function _w(e,t,n){for(var r,i,a=0,o=0;o<t.length;o++)-1!=(r=t[o]).sourceId&&(i=n[r.sourceId],a+=r.weight*i[e]);return a}function ww(e){var t=/^([nsew+-]?)([0-9.]+)[d°]? ?([0-9.]*)['′]? ?([0-9.]*)["″]? ?([nsew]?)$/i.exec(e.trim()),n=NaN;return t&&(n=+(t[2]||"0")+ +(t[3]||"0")/60+ +(t[4]||"0")/3600,(/[sw-]/i.test(t[1])||/[sw]/i.test(t[5]))&&(n=-n)),n}function Sw(e,t,n){for(var r=n.getVertexData(),i=r.xx,a=r.yy,o=[],s=0,u=i.length;s<u;s++)i[s]==e&&a[s]==t&&o.push(s);return o}function Aw(e,t){var n=t.getVertexData();return[n.xx[e],n.yy[e]]}function Iw(e,t){for(var n=t.getVertexData(),r=n.ii,i=n.nn,a=0,o=r.length;a<o;a++)if(e===r[a]+i[a]-1)return!0;return!1}function Mw(e,t){for(var n=t.getVertexData().ii,r=0,i=n.length;r<i;r++)if(e===n[r])return!0;return!1}function Pw(e,t,n,r){var i=r.getVertexData();i.xx[n]=e,i.yy[n]=t}function Ew(e,t,n,r,i){for(var a,o,s,u,c=i?Dn.greatCircleDistance:Dn.distance2D,f=1/0,l=0;l<n.length;l++)for(u=r.getShapeIter(n[l]);u.hasNext();)(s=c(e,t,u.x,u.y))<f&&(f=s,a=u.x,o=u.y);return f<1/0?{x:a,y:o}:null}nu.inlay=function(e,t,n,r){var i=ux(e,n,t,r),a=i.layers[i.layers.length-1];si(a),e.forEach(si);var o={layer:di(a),dataset:i},s=nu.eraseLayers(e,o,i,r).map((function(e){var t=di(a),n=nu.mergeLayers([e,t],{force:!0})[0];return n.name=e.name,n}));return n.arcs=i.arcs,s},nu.innerlines=function(e,t,n){n=n||{},si(e);var r=n.where?Vs(n.where,e,t):null,i=fv(e.shapes,t,{filter:r}),a=B_(e.shapes,i),o=L_(a,null);return 0===a.length&&ht("No shared boundaries were found"),li(o,e,null,n),o},nu.inspect=function(e,n,r){var i,a=function(e,n,r){var i,a=Kr(e),o=[];return r.expression||dt("Missing a JS expression for selecting a feature"),i=Gs(r.expression,e,n),t.repeat(a,(function(e){var t=i(e);!0===t?o.push(e):!1!==t&&dt("Expression must return true or false")})),o}(e,n,r);i=1==a.length?function(e,n,r){var i="Feature "+e+"\n";return i+=function(e,n,r){var i,a,o=n.shapes?n.shapes[e]:null,s=n.geometry_type;return o&&s?(a="Geometry\n  Type: "+s+"\n","point"==s?a+="  Points: "+o.length+"\n":"polyline"==s?a+="  Parts: "+o.length+"\n":"polygon"==s&&(i=function(e,t){for(var n,r={rings:e.length,cw:0,ccw:0,area:0},i=0;i<e.length;i++)(n=Dn.getPlanarPathArea(e[i],t))>0?r.cw++:n<0&&r.ccw++,r.area+=n;return t.isPlanar()||(r.sph_area=Dn.getSphericalShapeArea(e,t)),r}(o,r),a+=t.format("  Rings: %d cw, %d ccw\n",i.cw,i.ccw),a+="  Planar area: "+i.area+"\n",i.sph_area&&(a+="  Spherical area: "+i.sph_area+" sq. meters\n")),a):"Geometry: [null]\n"}(e,n,r),i+gw(n,e)}(a[0],e,n):t.format("Expression matched %d feature%s. Select one feature for details",a.length,t.pluralSuffix(a.length)),ht(i)};var jw=Object.freeze({__proto__:null,findNearestVertices:function(e,t,n){var r=Ew(e[0],e[1],t,n);return Sw(r.x,r.y,n)},snapVerticesToPoint:function(e,t,n,r){e.forEach((function(e){Pw(t[0],t[1],e,n)})),r&&n.transformPoints((function(){}))},snapPointToArcEndpoint:function(e,t,n){var r,i,a;t.forEach((function(e){Mw(e,n)?r=Aw(e+1,n):Iw(e,n)&&(r=Aw(e-1,n))})),r&&(i=r[0]-e[0],a=r[1]-e[1],Math.abs(i)>Math.abs(a)?e[1]=r[1]:e[0]=r[0])},findVertexIds:Sw,getVertexCoords:Aw,vertexIsArcEnd:Iw,vertexIsArcStart:Mw,setVertexCoords:Pw,findNearestVertex:Ew});function Ow(e,t,n){if(!e)return null;var r=e.map((function(e){return function(e,t){var n,r=en(e,t,!1)/2,i=0;return Xn(e,t,(function(e,t,a,o){var s=a[e],u=o[e],c=a[t],f=o[t];if(!n){if(r>0==0)return[s,u];var l,d=Vt(s,u,c,f);i+d>=r&&(n=[s+(l=(r-i)/d)*(c-s),u+l*(f-u)]),i+=d}})),n||lt("Geometry error"),n}(e,t)}));return r}function Fw(e,t,n){var r=n.inner?Ms:Dn.getShapeCentroid;return e.shapes.map((function(e){var n=r(e,t);return n?[[n.x,n.y]]:null}))}function kw(e){var n;if(t.isFiniteNumber(e))return e;if(t.isString(e)&&""!==e){if(n=+e,t.isFiniteNumber(n))return n;if(n=ww(e),t.isFiniteNumber(n))return n}return NaN}function Nw(e){var n=/^(lng|long?|longitude|x)$/i;return t.find(e,(function(e){return n.test(e)}))}function Cw(e){var n=/^(lat|latitude|y)$/i;return t.find(e,(function(e){return n.test(e)}))}function zw(e,t){return e||dt("Layer is missing a data table"),t.x&&t.y&&e.fieldExists(t.x)&&e.fieldExists(t.y)||dt("Missing x,y data fields"),e.getRecords().map((function(e){var n=kw(e[t.x]),r=kw(e[t.y]);return isNaN(n)||isNaN(r)?null:[[n,r]]}))}nu.createPointLayer=function(e,n,r){var i,a,o=fi(e,r),s=n.arcs;r.intersections?(function(e){var t=e.getFilteredPointCount(),n=e.size(),r=t-n,i=Bu(e),a=Math.ceil(i/10),o=10*i,s=Du(e);console.log("points:",t,"arcs:",n,"segs:",r),[a,i,o,s].forEach((function(t){console.time(t+" stripes"),Cu(e,{stripes:t}),console.timeEnd(t+" stripes")}))}(s),o=e):r.interpolated?o.shapes=function(e,t,n){var r,i=Ko(n.interval,Wi(t));return i>0==0&&dt("Invalid interpolation interval:",n.interval),"polyline"!=e.geometry_type&&dt("Expected a polyline layer"),e.shapes.map((function(e,t){return r=[],e&&e.forEach(a),r.length>0?r:null}));function a(e){var n=function(e,t,n){var r,i,a,o,s,u=t.getShapeIter(e),c=t.isPlanar()?Dn.distance2D:Dn.greatCircleDistance,f=[],l=0;for(u.hasNext()&&(f.push([u.x,u.y]),r=u.x,i=u.y);u.hasNext();){for(a=c(r,i,u.x,u.y);l+a>=n;)o=(n-l)/a,s=vg(r,i,u.x,u.y,o),l=0,f.push(s),a=c(r=s[0],i=s[1],u.x,u.y);l+=a,r=u.x,i=u.y}return l>0&&f.push([r,i]),f}(e,t.arcs,i);r=r.concat(n)}}(e,n,r):r.vertices?o.shapes=function(e,t,n){var r,i;return"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&dt("Expected a polygon or polyline layer"),e.shapes.map((function(e,t){return r=[],i={},(e||[]).forEach(a),r.length>0?r:null}));function a(e){for(var n=t.getShapeIter(e);n.hasNext();)o=void 0,(o=(a=n).x+"~"+a.y)in i==0&&(i[o]=!0,r.push([a.x,a.y]));var a,o}}(e,s):r.vertices2?o.shapes=function(e,t,n){var r;return"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&dt("Expected a polygon or polyline layer"),e.shapes.map((function(e,t){return r=[],(e||[]).forEach(i),r.length>0?r:null}));function i(e){for(var n=t.getShapeIter(e);n.hasNext();)r.push([n.x,n.y])}}(e,s):r.endpoints?o.shapes=function(e,t){var n,r;return"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&dt("Expected a polygon or polyline layer"),e.shapes.map((function(e,t){return n=[],r={},(e||[]).forEach(a),n.length>0?n:null}));function i(e){var t=e.x+"~"+e.y;t in r==0&&(r[t]=!0,n.push([e.x,e.y]))}function a(e){for(var n=0;n<e.length;n++)i(t.getVertex(e[n],0)),i(t.getVertex(e[n],-1))}}(e,s):r.x||r.y?o.shapes=zw(e.data,r):"polygon"==e.geometry_type?o.shapes=Fw(e,s,r):r.midpoints?(oi(e),o.shapes=function(e,t,n){return e.shapes.map((function(e){return Ow(e,t)}))}(e,s)):"polyline"==e.geometry_type?o.shapes=function(e,t,n){return e.shapes.map((function(e){var n=function(e,t,n){var r=!t.isPlanar(),i=e?1==e.length?e[0]:function(e,t,n){var r=0,i=null;return e.forEach((function(e){var a=Dn.calcPathLen(e,t,n);a>r&&(r=a,i=e)})),i}(e,t,r):null;if(!i)return null;var a=t.getSimpleShapeBounds(i);return Ew(a.centerX(),a.centerY(),[i],t,r)}(e,t);return n?[[n.x,n.y]]:null}))}(e,s):e.geometry_type?dt("Expected a polygon or polyline layer"):o.shapes=(i=e.data,a=i?i.getFields():[],zw(i,{x:Nw(a),y:Cw(a)})),o.geometry_type="point";var u=o.shapes.reduce((function(e,t){return t||e++,e}),0);return u>0&&ht(t.format("%,d of %,d points are null",u,o.shapes.length)),e.data&&(o.data=r.no_replace?e.data.clone():e.data),o};var Tw=Object.freeze({__proto__:null,pointsFromPolygons:Fw,coordinateFromValue:kw,findXField:Nw,findYField:Cw});function Lw(e,t){return{geometry_type:"point",shapes:Fw(e,t.arcs,{inner:!0}),data:e.data}}function Bw(e,t){return{geometry_type:"point",shapes:e.shapes.map((function(e){return Ow(e,t.arcs)})),data:e.data}}function Dw(e){e.point_method||dt('The "point-method" flag is required for polyline-polygon joins')}class Rw{constructor(e=[],t=Uw){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(n(r,a)>=0)break;t[e]=a,e=i}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,i=t[e];for(;e<r;){let r=1+(e<<1),a=t[r];const o=r+1;if(o<this.length&&n(t[o],a)<0&&(r=o,a=t[o]),n(a,i)>=0)break;t[e]=a,e=r}t[e]=i}}function Uw(e,t){return e<t?-1:e>t?1:0}var qw=Math.PI/180;function Gw(e,t,n,r){var i=r.minLng,a=r.maxLng,o=r.minLat,s=r.maxLat;if(e>=i&&e<=a)return t<o?$w((t-o)*qw):t>s?$w((t-s)*qw):0;var u=Math.min($w((e-i)*qw),$w((e-a)*qw)),c=function(e,t){var n=1-2*t;return n<=0?e>0?90:-90:Math.atan(Math.tan(e*qw)/n)/qw}(t,u);return c>o&&c<s?Jw(u,n,t,c):Math.min(Jw(u,n,t,o),Jw(u,n,t,s))}function Vw(e,t){return e.dist-t.dist}function $w(e){var t=Math.sin(e/2);return t*t}function Jw(e,t,n,r){return t*Math.cos(r*qw)*e+$w((n-r)*qw)}function Yw(e,t,n,r,i){return Jw($w((e-n)*qw),i,t,r)}function Ww(e,t,n){ai(e);var r=kt(e),i=n.max_distance?Zo(n.max_distance,t):.001,a=function(e,t,n){var r=!!t&&Qi(t),i=t&&t.to_meter||1;return r?function(t){return function(e,t,n,r,i,a){var o=1,s=[];void 0===r&&(r=1/0),void 0!==i&&(o=$w(i/6371));for(var u,c,f,l=new Rw([],Vw),d={left:0,right:e.ids.length-1,axis:0,dist:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90},p=Math.cos(n*qw);d;){if((u=d.right)-(c=d.left)<=e.nodeSize)for(var h=c;h<=u;h++)f=e.points[e.ids[h]],l.push({i:e.ids[h],item:f,dist:Yw(t,n,e.coords[2*h],e.coords[2*h+1],p)});else{var g=c+u>>1,m=e.coords[2*g],y=e.coords[2*g+1];f=e.points[e.ids[g]],l.push({i:e.ids[g],item:f,dist:Yw(t,n,m,y,p)});var v=(d.axis+1)%2,b={left:c,right:g-1,axis:v,minLng:d.minLng,minLat:d.minLat,maxLng:0===d.axis?m:d.maxLng,maxLat:1===d.axis?y:d.maxLat,dist:0},x={left:g+1,right:u,axis:v,minLng:0===d.axis?m:d.minLng,minLat:1===d.axis?y:d.minLat,maxLng:d.maxLng,maxLat:d.maxLat,dist:0};b.dist=Gw(t,n,p,b),x.dist=Gw(t,n,p,x),l.push(b),l.push(x)}for(;l.length&&l.peek().item;){var _=l.pop();if(_.dist>o)return s;if(s.push(_.i),s.length===r)return s}d=l.pop()}return s}(e,t[0],t[1],1/0,n/1e3)}:function(t){return e.within(t[0],t[1],n/i)}}(new(lr("kdbush"))(r),t,i),o=new Su(r.length);this.lookupByMultiPoint=function(e){var t,n,r,i,s=[];for(n=0,i=e?e.length:0;n<i;n++)for(t=e[n],s=a(t),r=0;r<s.length;r++)o.setId(s[r]);return s=o.getIds(),o.clear(),s}}function Hw(e,t,n){var r=n.keys,i=r[0],a=r[1],o=function(e,t,n,r){e||dt("Target layer is missing an attribute table"),n||dt("Source layer is missing an attribute table");var i,a,o=e.getRecords(),s=n.getRecords(),u=function(e,t){for(var n,r={},i=0,a=e.length;i<a;i++)(n=e[i][t])in r==0?r[n]=i:Array.isArray(r[n])?r[n].push(i):r[n]=[r[n],i];return r}(s,r);return 0==s.length?function(e){return[]}:(ti(n,r,"External table is missing a field named:"),ti(e,t,"Target layer is missing key field:"),i=kr(r,n.getRecords()),a=kr(t,o),Xw(r,i),Xw(t,a),i!=a&&dt("Join keys have mismatched data types:",a,"and",i),function(e){var n=o[e],r=n?n[t]:null,i=null;return n&&r in u&&(i=u[r],Array.isArray(i)||(i=[i])),i})}(e.data,i,t,a);return Cx(r),Nx(e,t,o,n)}function Xw(e,t){t&&"object"!=t||dt("["+e+"] field has an unsupported data type. Expected string or number.")}nu.join=function(e,n,r,i){var a,o,s;r&&r.dataset||dt("Missing a joinable data source"),i.keys?(2!=i.keys.length&&dt("Expected two key fields: a target field and a source field"),r.layer.data||dt("Source layer is missing attribute data"),s=Hw(e,r.layer.data,i)):(r.layer.data||vi(r.layer),Hi([n,r.dataset]),a=r.layer.geometry_type,o=e.geometry_type,"point"==a&&"polygon"==o?s=o_(e,n.arcs,r.layer,i):"polygon"==a&&"point"==o?s=s_(e,r.layer,r.dataset.arcs,i):"point"==a&&"point"==o?s=function(e,t,n,r){var i=function(e,t,n,r){var i=e.shapes,a=new Ww(t,n,r);return function(e){var t=a.lookupByMultiPoint(i[e]);return t.length>0?t:null}}(e,t,n,r);return u_(e,t),Nx(e,t.data,i,r)}(e,r.layer,Wi(n),i):"polygon"==a&&"polygon"==o?s=function(e,t,n,r){return r.point_method?function(e,t,n,r){var i,a,o=n.layer,s=n.dataset;return e.shapes.length>o.shapes.length?(a=s_(i=Lw(e,t),o,s.arcs,r),e.data=i.data):(i=Lw(o,s),a=o_(e,t.arcs,i,r)),a}(e,t,n,r):xw(e,t,n,r)}(e,n,r,i):"polyline"==a&&"polygon"==o?s=function(e,t,n,r){Dw(r);var i=Bw(n.layer,n.dataset);return o_(e,t.arcs,i,r)}(e,n,r,i):"polygon"==a&&"polyline"==o?s=function(e,t,n,r){Dw(r);var i=Bw(e,t),a=s_(i,n.layer,n.dataset.arcs,r);return e.data=i.data,a}(e,n,r,i):dt(t.format("Unable to join %s geometry to %s geometry",a||"null",o||"null"))),s.unmatched&&n.layers.push(s.unmatched),s.unjoined&&n.layers.push(s.unjoined)};var Qw=Object.freeze({__proto__:null,joinAttributesToFeatures:Hw});function Zw(e,n,r){var i={},a=n?Wi(n):null;return r.interval?i.interval=Ko(r.interval,a):dt("Missing required interval option"),r.bbox?i.bbox=r.bbox:n?(n=t.defaults({layers:e},n),i.bbox=Ba(n).toArray()):dt("Missing grid bbox"),i.width=i.bbox[2]-i.bbox[0],i.height=i.bbox[3]-i.bbox[1],i.type=r.type||"square",i}function Kw(e){var t=[];return e.forEach((function(e){e.forEach((function(e){t.push({type:"Point",coordinates:e})}))})),{type:"GeometryCollection",geometries:t}}function eS(e){var t,n,r,i,a,o,s,u,c,f,l=[],d=e.length-2;for(s=0;s<d;s++)for(u=(f=s%2==0)?0:2,c=f?0:-1;t=e[s][u],n=e[s+1][u+c],r=e[s+2][u],i=e[s+2][u+1],a=e[s+1][u+2+c],o=e[s][u+1],i&&a;u+=3)l.push({type:"Polygon",coordinates:[[t,n,r,i,a,o,t]]});return{type:"GeometryCollection",geometries:l}}function tS(e){for(var t,n,r=e.interval,i=Math.sqrt(3)*r/2,a=r/2,o=e.width+2*r,s=e.height+2*i,u=-i,c=[];u<s;){for(t=c.length%2==0?0:-a,n=[],c.push(n);t<o;)n.push([t,u]),t+=r;u+=i}return c}function nS(e){for(var t,n,r=0,i=[],a=e.interval,o=e.width+a,s=e.height+a;r<s;){for(t=0,n=[],i.push(n);t<o;)n.push([t,r]),t+=a;r+=a}return i}function rS(e,t){var n=function(e){var t={Point:function(e){var t=e.coordinates;return[t[0],t[1],t[0],t[1]]},Polygon:function(e){return e.coordinates[0].reduce((function(e,t){return e?(n(e,t[0],t[1]),e):[t[0],t[1],t[0],t[1]]}),null)}};return e.geometries.reduce((function(e,r){var i=(0,t[r.type])(r);return e?(n(e,i[0],i[1]),n(e,i[2],i[3]),e):i}),null);function n(e,t,n){t<e[0]&&(e[0]=t),n<e[1]&&(e[1]=n),t>e[2]&&(e[2]=t),n>e[3]&&(e[3]=n)}}(e);!function(e,t,n){e.geometries.forEach((function(e){"Point"==e.type&&(e.coordinates=[e.coordinates[0]+t,e.coordinates[1]+n]),"Polygon"==e.type&&(e.coordinates[0]=e.coordinates[0].map((function(e){return[e[0]+t,e[1]+n]})))}))}(e,(t[2]+t[0])/2-(n[2]+n[0])/2,(t[3]+t[1])/2-(n[3]+n[1])/2)}function iS(e,t,n){for(var r,i,a=[],o=0,s=0;s<e.length;s++)(r=t[s])>0!=0&&(o+=r,a.push(e[s]));return i={weight:o},n&&n(a,i),i}function aS(e,t,n,r,i){for(var a,o=[],s=t*Math.sqrt(1/Math.PI),u=t*t,c=0;c<r.length;c++)a=oS(e,s,n[r[c]],i)/u,o.push(a);return o}function oS(e,t,n,r){var i=Vt(e[0],e[1],n[0],n[1]);if(i>=t+r)return 0;var a=t*t,o=r*r,s=(a-o+i*i)/(2*i),u=i-s;return i<=Math.abs(t-r)?Math.PI*Math.min(a,o):a*Math.acos(s/t)-s*Math.sqrt(a-s*s)+o*Math.acos(u/r)-u*Math.sqrt(o-u*u)}function sS(e,t,n){var r=n.circles?function(e,t){var n=t.cell_margin>0?t.cell_margin:1e-6;return Qg(e,t.interval/2*(1-n),20,xg)}(t.idxToPoint(e),n):function(e,t){var n=t.interval*(t.cell_margin||0),r=e[0]+n,i=e[1]+n,a=e[2]-n,o=e[3]-n;return[[r,i],[r,o],[a,o],[a,i],[r,i]]}(t.idxToBBox(e),n);return{type:"Polygon",coordinates:[r]}}function uS(e,t,n,r){var i=n.colRowToIdx(e,t);i>-1&&r.setId(i)}function cS(e,t,n){return[(Math.floor(e/n)-1)*n,(Math.ceil(t/n)+1)*n]}function fS(e,t,n){var r=t-e,i=(Math.ceil(r/n)*n-r)/2+n;return[e-i,t+i]}function lS(e){return Array.isArray(e)&&t.isObject(e[0])?e.map((function(e){return{name:e.name,options:Object.assign({},e.options)}})):(t.isString(e)&&(e=rp(e)),hp().parseArgv(e))}function dS(e){var t=e.replace(/^mapshaper\b/,"").trim();return hp(),t.split(/\n+/g).map((function(e){return/^[a-z][\w-]*/.exec(e=e.trim())&&(e="-"+e),e})).join(" ")}nu.mosaic=function(e,t,n){var r=e[0];(!r||e.length>1)&&dt("Command takes a single target layer"),si(r);var i,a=new sc(r,Vu(t,n),{flat:!1}),o=a.mosaic,s={name:"name"in r?r.name:void 0,shapes:o,geometry_type:"polygon"};return n.calc&&(i=du(r.data.getRecords(),a.getSourceIdsByTileId,o.length,n),s.data=new Vr(i)),[s]},nu.polygonGrid=function(e,n,r){Ji(n);var i,a,o,s=(i=Zw(e,n,r),"square"==i.type?a=function(e){for(var t,n,r,i,a=[],o=0,s=e.length-1;o<s;o++)for(var u=0,c=e[o].length-1;u<c;u++)t=e[o][u],n=e[o+1][u],r=e[o+1][u+1],i=e[o][u+1],a.push({type:"Polygon",coordinates:[[t,n,r,i,t]]});return{type:"GeometryCollection",geometries:a}}(nS(i)):"hex"==i.type?a=eS(tS(i)):"hex2"==i.type?(a=eS(tS(function(e){var n=e.bbox;return t.defaults({width:e.height,height:e.width,bbox:[n[1],n[0],n[3],n[2]]},e)}(i))),a.geometries.forEach((function(e){e.coordinates[0]=e.coordinates[0].map((function(e){return[e[1],e[0]]}))}))):dt("Unsupported grid type"),rS(a,i.bbox),ya(o=Dp(a,{})),o);return s.info=n.info,li(s.layers[0],null,"grid",r),r.debug&&s.layers.push(nu.pointGrid2(e,n,r)),s},nu.pointGrid2=function(e,t,n){var r,i=Zw(e,t,n);"square"==i.type?r=Kw(nS(i)):"hex"==i.type?r=Kw(tS(i)):dt("Unsupported grid type"),rS(r,i.bbox);var a=Dp(r,{});return n.name&&(a.layers[0].name=n.name),a.layers[0]},nu.pointGrid=function(e,t){var n,r,i=function(e,t){var n={},r=e?Wi(e):null;return t.interval?n.interval=Ko(t.interval,r):t.rows>0&&t.cols>0&&(n.rows=t.rows,n.cols=t.cols),t.bbox?n.bbox=t.bbox:n.bbox=e?Ba(e).toArray():[-180,-90,180,90],n}(e,t),a=(n=function(e){var t,n,r,i,a,o,s,u,c,f=e.bbox,l=f[2]-f[0],d=f[3]-f[1],p=[];for(e.interval>0?(i=e.interval,a=e.interval,n=Math.round(l/i)-1,r=Math.round(d/a)-1,o=f[0]+(l-n*i)/2,s=f[1]+(d-r*a)/2):e.rows>0&&e.cols>0&&(i=l/(n=e.cols),a=d/(r=e.rows),o=f[0]+i/2,s=f[1]+a/2),i>0!=0&&a>0!=0||dt("Invalid grid parameters"),c=s;c<=f[3];){for(u=o,p.push(t=[]);u<=f[2];)t.push([u,c]),u+=i;c+=a}return p}(i),r=[],n.forEach((function(e,t){for(var n=0;n<e.length;n++)r.push([e[n]])})),{geometry_type:"point",shapes:r});return li(a,null,"grid",t),a},nu.pointToGrid=function(e,t,n){e.forEach(ii),n.interval>0==0&&dt("Expected a non-negative interval parameter"),n.radius;var r=Ba(t).toArray(),i=[t],a=e.map((function(e){hi(e)>0&&dt("This command requires single points");var t=function(e,t,n){for(var r,i,a=kt(e),o=n.interval,s=function(e,t,n){var r=n&&n.aligned?function(e,t){var n=cS(e[0],e[2],t),r=cS(e[1],e[3],t);return[n[0],r[0],n[1],r[1]]}(e,t):function(e,t){var n=fS(e[0],e[2],t),r=fS(e[1],e[3],t);return[n[0],r[0],n[1],r[1]]}(e,t),i=r[0],a=r[1],o=r[2]-i,s=r[3]-a,u=Math.round(o/t),c=Math.round(s/t);function f(e){var t=e[0]-i;return Math.floor(t/o*u)}function l(e){var t=e[1]-a;return Math.floor(t/s*c)}function d(e,t){return e<0||t<0||e>=u||t>=c?-1:t*u+e}function p(e){return e%u}function h(e){return Math.floor(e/u)}return{size:function(){return[u,c]},cells:function(){return u*c},pointToCol:f,pointToRow:l,colRowToIdx:d,pointToIdx:function(e){return d(f(e),l(e))},idxToCol:p,idxToRow:h,idxToBBox:function(e){var n=p(e),r=h(e);return[i+n*t,a+r*t,i+(n+1)*t,a+(r+1)*t]},idxToPoint:function(e){return[i+(p(e)+.5)*t,a+(h(e)+.5)*t]}}}(t,o,n),u=function(e){var t=e.interval*Math.sqrt(1/Math.PI);return e.radius>0?e.radius:t}(n),c=function(e,t,n){var r=lr("flatbush"),i=new Su(t.cells()),a=new r(e.length),o=[];return e.forEach((function(e){!function(e,t,n){var r=n.pointToIdx(e),i=n.idxToCol(r),a=n.idxToRow(r);uS(i+1,a+1,n,t),uS(i+1,a,n,t),uS(i+1,a-1,n,t),uS(i,a+1,n,t),uS(i,a,n,t),uS(i,a-1,n,t),uS(i-1,a+1,n,t),uS(i-1,a,n,t),uS(i-1,a-1,n,t)}(e,i,t),a.add.apply(a,function(e,t){return[e[0]-t,e[1]-t,e[0]+t,e[1]+t]}(e,n))})),a.finish(),function(e){if(!i.hasId(e))return o;var n=t.idxToBBox(e);return a.search.apply(a,n)}}(a,s,u),f={type:"FeatureCollection",features:[]},l=n.calc?su(e.data,n.calc):null,d=0,p=s.cells();d<p;d++)(r=c(d)).length&&(i=iS(r,aS(s.idxToPoint(d),o,a,r,u),l)).weight>.05!=0&&(i.id=d,f.features.push({type:"Feature",properties:i,geometry:sS(d,s,n)}));return Dp(f,{})}(e,r,n),a=t.layers[0];return i.push(t),li(a,e,"grid",n),a})),o=Sa(i);return ya(o),t.arcs=o.arcs,a},nu.polygons=function(e,t,n){return e.forEach(oi),Vu(t,n),e.map((function(e){return"polyline"!=e.geometry_type&&dt("Expected a polyline layer"),n.from_rings?function(e,t){var n=t.arcs,r=0;return ar(e.shapes,(function(e){return Dn.pathIsClosed(e,n)?e:(r++,null)})),r>0&&ht("Removed",r,"open "+(1==r?"ring":"rings")),e.geometry_type="polygon",mo(e,n),e}(e,t):function(e,t,n){var r=nc(function(e,t,n){var r=n.gap_tolerance?Ko(n.gap_tolerance,Wi(t)):0,i=t.arcs,a=qn(e.shapes,i),o=new ja(t.arcs,a),s=function(e,t){return e.findDanglingEndpoints().filter((function(n){return Dn.calcPathLen([n.arc],e.arcs)>t}))}(o,r);if(0===s.length)return o;var u=function(e,t){for(var n=[],r=0,i=e.size();r<i;r++)n.push(t(r)?[[r]]:null);return n}(i,a),c=new go(u,i),f=s.reduce((function(e,t){var n=function(e,t,n,r){var i=zt(e.arc),a=null;return t.forEach((function(t){var o;t!=i&&(o=Dn.getPointToPathInfo(e.point[0],e.point[1],[t],n))&&o.distance<=r&&(!a||o.distance<a.distance)&&(a=o)})),a}(t,c.findPointEnclosureCandidates(t.point,r),i,r);return n&&e.push(function(e,t,n){var r,i,a,o=n.getVertex(t,-1),s=[o.x,o.y],u=n.getVertex(t,-2),c=[u.x,u.y],f=e.segment[0],l=e.segment[1],d=Dn.findClosestPointOnSeg(s[0],s[1],f[0],f[1],l[0],l[1]);return i=f,a=l,(r=d)[0]==i[0]&&r[1]==i[1]||r[0]==a[0]&&r[1]==a[1]||(d=function(e,t){var n=Dn.distance2D(e[0],e[1],t[0],t[1]),r=(n+1e-6)/n;return[e[0]+r*(t[0]-e[0]),e[1]+r*(t[1]-e[1])]}(c,d),Dn.segmentIntersection(c[0],c[1],d[0],d[1],f[0],f[1],l[0],l[1])||(d=function(e,t,n){return Dn.distance2D(e[0],e[1],t[0],t[1])<Dn.distance2D(e[0],e[1],n[0],n[1])?t:n}(c,f,l))),{arc:t,point:d}}(n,t.arc,i)),e}),[]);return t.arcs=function(e,t){var n=e.getVertexData();return t.forEach((function(t){var r=e.indexOfVertex(t.arc,-1);n.xx[r]=t.point[0],n.yy[r]=t.point[1]})),e.updateVertexData(n.nn,n.xx,n.yy,n.zz),e}(i,f),Vu(t,{})}(e,t,n));return{geometry_type:"polygon",name:e.name,shapes:r.mosaic}}(e,t,n)}))},nu.print=function(e){mt(e||"")},nu.renameLayers=function(e,n,r){n&&n.join("").indexOf("=")>-1?function(e,n){var r=function(e){return(e||[]).reduce((function(e,n){var r=n.split("="),i=t.trimQuotes(r[0]),a=t.trimQuotes(r[1]||"");return a||dt("Invalid name assignment:",n),e[a]=i,e}),{})}(e);n.forEachLayer((function(e){r[e.name]&&(e.name=r[e.name])}))}(n,r):function(e,t){var n=e&&e.length||0,r="",i="";t.forEach((function(a,o){o<n&&(r=e[o]),r&&n<t.length&&o>=n-1&&(i=(i||0)+1),a.name=r+i}))}(n,e)};var pS=Object.freeze({__proto__:null,parseCommands:lS,standardizeConsoleCommands:dS,parseConsoleCommands:function(e){var t,n=["i","include","require","external"];return(t=lS(dS(e))).forEach((function(e){var t=n.indexOf(e.name);t>-1&&dt("The -"+n[t]+" command cannot be run in the browser")})),t}});function hS(e,n){var r,i,o,s,u,c=Qs();1==n.length&&((u=pw(s=(o=n[0]).layers[0],o.dataset)).layer=s,u.dataset=o.dataset,i=u,Object.defineProperty(c,"target",{value:i})),t.extend(c,a("defs"));try{r=Function("ctx","with(ctx) {return ("+e+");}").call({},c)}catch(e){dt(e.name,"in JS source:",e.message)}return r}function gS(e){var t=2*e.size(),n=new ja(e).size();return e.getPointCount()-t+n}nu.run=function(e,t,n,r){var i;n.include&&nu.include({file:n.include}),n.commands||dt("Missing commands parameter"),(i=hS(n.commands,t))?bA(lS(i),e,r):r(null)},nu.require=function(e,t){var n,r,i,o=a("defs");t.module||dt("Missing module name or path to module"),io.isFile(t.module)?n=t.module:io.isFile(t.module+".js")?n=t.module+".js":r=t.module,n&&(n=lr("path").join(process.cwd(),n));try{i=lr(n||r)}catch(e){dt(e)}r||t.alias?o[t.alias||r]=i:Object.assign(o,i),t.init&&hS(t.init,e)},nu.shape=function(e,t){var n,r;return t.coordinates?n=function(e){var t,n,r,i,a=[],o=e.offsets||[],s=e.coordinates;for(s.length>=2==0&&dt("Invalid coordinates parameter."),n=0;n<s.length;n+=2)r=s[n],i=s[n+1],a.push([r,i]);for(n=0;n<o.length;n+=2)r+=o[n],i+=o[n+1],a.push([r,i]);return mc.pathIsRing(a)?t="Polygon":e.closed&&a.length>=3?(t="Polygon",a.push(a[0])):t="LineString",{type:t,coordinates:"Polygon"==t?[a]:a}}(t):"circle"==t.type?n=function(e){return e.radius>0==0&&e.radius_angle>0==0&&dt("Missing required radius parameter."),Hg(e.center||[0,0],e.radius||S_($i("wgs84"),e.radius_angle),null,{geometry_type:e.geometry||"polygon"})}(t):"rectangle"==t.type&&t.bbox?n=function(e){var t=e.bbox,n=t[0],r=t[1],i=t[2],a=t[3],o=[],s="polyline"==e.geometry?"LineString":"Polygon";return u(n,r,n,a),u(n,a,i,a),u(i,a,i,r),u(i,r,n,r),o.push([n,r]),{type:s,coordinates:"Polygon"==s?[o]:o};function u(e,t,n,r){for(var i=n-e,a=r-t,s=Math.ceil(Math.max(Math.abs(i)/.5,Math.abs(a)/.5)),u=i/s,c=a/s,f=0;f<s;f++)o.push([e+f*u,t+f*c])}}(t):dt("Missing coordinates parameter"),r=Dp(n,{}),t.rotation&&function(e,t,n){var r=function(e,t){var n=P_(e,t);return function(e,t){return n([e,t])}}(t,n);e.layers.filter(Xr).forEach((function(e){Z_(e,r)})),e.arcs&&K_(e.arcs,r)}(r,t.rotation),r.layers[0].name=t.name||t.type||"shape",r};var mS={};function yS(e){var n,r=Cu(e),i=vS(e,r),a=r.length,o=i.length,s=a>o?a-o:0;a>0&&(n=t.format("Repaired %'i intersection%s",s,t.pluralSuffix(s)),o>0&&(n+=t.format("; %'i intersection%s could not be repaired",o,t.pluralSuffix(o))),ht(n))}function vS(e,t){for(;bS(e,t)>0;)t=Cu(e);return t}function bS(e,n){var r,i,a,o,s=e.getVertexData(),u=e.getRetainedInterval(),c=0,f=0;for(i=xS(n,u,s.zz),t.sortOn(i,"z",!0);i.length>0;)for(1==(r=SS(a=i.pop(),u,s.xx,s.yy,s.zz)).length&&(r=wS(r[0],u,s.zz),c++),o=0;o<r.length;o++)_S(i,r[o]);return++f>5e5?(yt("Caught an infinite loop at intersection:",a),0):c}function xS(e,t,n){return e.reduce((function(e,r){var i=function(e,t,n){var r=Yn(n,t,e.a[0],e.a[1]),i=Yn(n,t,e.b[0],e.b[1]);return-1==r&&-1==i?null:-1==i||-1!=r&&n[r]>n[i]?{a:e.a,b:e.b,z:n[r]}:{a:e.b,b:e.a,z:n[i]}}(r,t,n);return null!==i&&e.push(i),e}),[])}function _S(e,t){for(var n=e.length;n>0&&!(e[n-1].z<=t.z);)e[n]=e[n-1],n--;e[n]=t}function wS(e,t,n){for(var r=[],i=e.a[0],a=e.a[1],o=e.z,s=i+1;s<=a;s++)n[s]!=o&&s!=a||(r.push({a:[i,s],b:e.b,z:o}),s!=a&&(n[s]=t),i=s);return r.length<2&&lt("Error in unwindIntersection()"),r}function SS(e,t,n,r,i){var a=function(e,t,n,r,i){var a=AS(e.a,t,n,0,i);return a.concat(AS(e.b,t,n,0,i))}(e,t,n,0,i);return xS(Ru(a,n,r),t,i)}function AS(e,t,n,r,i){var a,o,s,u=[];e[0]<=e[1]?(a=e[0],o=e[1]):(a=e[1],o=e[0]),s=a;for(var c=a+1;c<=o;c++)i[c]>=t&&(n[s]<n[c]?u.push(s,c):u.push(c,s),s=c);return u}mS.getArcCalculator=function(e,n){var r=new qx,i=t.expandoBuffer(Int32Array),a=t.expandoBuffer(Int32Array),o=n?function(t,n,r,i,a,o){return e(i[t],a[t],o[t],i[n],a[n],o[n],i[r],a[r],o[r])}:function(t,n,r,i,a){return e(i[t],a[t],i[n],a[n],i[r],a[r])};return function(e,t,s,u){var c,f,l,d,p=e.length,h=i(p),g=a(p),m=-1/0;for(u&&!n?lt("[visvalingam] Received z-axis data for 2D simplification"):!u&&n?lt("[visvalingam] Missing z-axis data for 3D simplification"):e.length>t.length&&lt("[visvalingam] Incompatible data arrays:",e.length,t.length),l=0;l<p;l++)d=l+1,c=(f=l-1)<0||d>=p?1/0:o(f,l,d,t,s,u),e[l]=c,g[l]=d,h[l]=f;for(r.init(e);r.size()>0&&(c=e[l=r.pop()])!==1/0;)c<m?e[l]=m:m=c,f=h[l],d=g[l],f>0&&(c=o(h[f],f,d,t,s,u),r.updateValue(f,c)),d<p-1&&(c=o(f,d,g[d],t,s,u),r.updateValue(d,c)),g[f]=d,h[d]=f}},mS.standardMetric=Dn.triangleArea,mS.standardMetric3D=Dn.triangleArea3D,mS.getWeightedMetric=function(e){var t=mS.getWeightFunction(e);return function(e,n,r,i,a,o){var s=Dn.triangleArea(e,n,r,i,a,o),u=Dn.cosine(e,n,r,i,a,o);return t(u)*s}},mS.getWeightedMetric3D=function(e){var t=mS.getWeightFunction(e);return function(e,n,r,i,a,o,s,u,c){var f=Dn.triangleArea3D(e,n,r,i,a,o,s,u,c),l=Dn.cosine3D(e,n,r,i,a,o,s,u,c);return t(l)*f}},mS.getWeightCoefficient=function(e){return e&&t.isNumber(e&&e.weighting)?e.weighting:.7},mS.getWeightFunction=function(e){var t=mS.getWeightCoefficient(e);return function(e){return-e*t+1}},mS.weight=function(e){return.7*-e+1},mS.getEffectiveAreaSimplifier=function(e){var t=e?mS.standardMetric3D:mS.standardMetric;return mS.getPathSimplifier(t,e)},mS.getWeightedSimplifier=function(e,t){var n=t?mS.getWeightedMetric3D(e):mS.getWeightedMetric(e);return mS.getPathSimplifier(n,t)},mS.getPathSimplifier=function(e,t){return mS.scaledSimplify(mS.getArcCalculator(e,t))},mS.scaledSimplify=function(e){return function(t,n,r,i){e(t,n,r,i);for(var a=1,o=t.length-1;a<o;a++)t[a]=.65*Math.sqrt(t[a])}};var IS=Object.freeze({__proto__:null,postSimplifyRepair:yS,repairIntersections:vS}),MS={};function PS(e,t){t.forEach((function(t){"polygon"==t.geometry_type&&function(e,t){t.forEach((function(t){ES(e,t)}))}(e,t.shapes)}))}function ES(e,t){for(var n,r,i=0,a=t?t.length:0,o=0;o<a;o++)(r=e.getSimpleShapeBounds(t[o]).area())>i&&(n=t[o],i=r);n&&0!==n.length?function(e,t){var n,r=e.getRetainedInterval();for(e.setRetainedInterval(1/0),n=Dn.getPlanarPathArea(t,e);n<=1e-10;){if(0===jS(e,t)){yt("[protectMultiRing()] Failed on ring:",t);break}n=Dn.getPlanarPathArea(t,e)}e.setRetainedInterval(r)}(e,n):yt("[protectShape()] Invalid shape:",t)}function jS(e,t){for(var n,r,i,a,o,s,u=0,c=e.getVertexData(),f=0;f<t.length;f++)(r=t[f])<0&&(r=~r),s=(o=c.ii[r])+c.nn[r]-1,-1!=(i=Yn(c.zz,1/0,o,s))&&(a=c.zz[i])>u&&(u=a,n=r);return u>0?(s=(o=c.ii[n])+c.nn[n]-1,OS(c.zz,u,1/0,o,s)):0}function OS(e,t,n,r,i){for(var a=0,o=r;o<=i;o++)e[o]===t&&(e[o]=n,a++);return a}MS.metricSq3D=Dn.pointSegDistSq3D,MS.metricSq=Dn.pointSegDistSq,MS.calcArcData=function(e,t,n,r){var i=e.length,a=!!r;e[0]=e[i-1]=1/0,i>2&&function i(o,s,u,c){var f,l,d=t[o],p=n[o],h=t[s],g=n[s];a&&(f=r[o],l=r[s]);for(var m,y=0,v=0,b=0,x=0,_=o+1;_<s;_++)(m=a?MS.metricSq3D(t[_],n[_],r[_],d,p,f,h,g,l):MS.metricSq(t[_],n[_],d,p,h,g))>=y&&(y=m,v=_);return c<y&&(y=c),v-o>1&&(b=i(o,v,u+1,y)),s-v>1&&(x=i(v,s,u+1,y)),1==u&&d==h&&p==g&&(y=Math.max(b,x)),e[v]=Math.sqrt(y),y}(0,i-1,1,Number.MAX_VALUE)};var FS=Object.freeze({__proto__:null,keepEveryPolygon:PS,protectShape:ES,replaceInArray:OS});function kS(e,n){var r=e.arcs;n.keep_shapes&&PS(r,e.layers),!n.no_repair&&r.getRetainedInterval()>0&&yS(r),n.stats&&function(e,n){var r=TS(n),i={dp:"Ramer-Douglas-Peucker",visvalingam:"Visvalingam",weighted_visvalingam:"Weighted Visvalingam"}[r]||"Unknown",a=CS(e,n),o=function(e,n){var r,i=n?function(e,t,n,r,i,a){var o=[],s=[],u=[];return Dn.convLngLatToSph([e,n,i],[t,r,a],o,s,u),Dn.pointSegDistSq3D(o[0],s[0],u[0],o[1],s[1],u[1],o[2],s[2],u[2])}:Dn.pointSegDistSq,a=n?Dn.signedAngleSph:Dn.signedAngle,o=0,s=0,u=0,c=0,f=0,l=-1,d=-1,p=[],h=[],g=e.getVertexData().zz;return e.forEachSegment((function(e,t,n,r){var m,y,v,b,x,_,w,S,A;if(m=n[e],y=r[e],v=n[t],b=r[t],e==d&&((S=a(n[l],r[l],m,y,v,b))>Math.PI&&(S=2*Math.PI-S),isNaN(S)||h.push(180*S/Math.PI)),l=e,d=t,g[e]<1/0&&s++,!((w=t-e-1)<1))if(o+=w,m==v&&y==b)u++;else{for(x=0;++e<t;)A=i(n[e],r[e],m,y,v,b),x=Math.max(x,A);_=Math.sqrt(x),f+=_,p.push(_),c=Math.max(c,_)}})),r={angleMean:0,displacementMean:0,displacementMax:c,collapsedRings:u,removed:o,retained:s,uniqueCount:gS(e),removableCount:o+s},h.length>0&&(r.angleMean=t.sum(h)/h.length,r.angleQuartiles=[t.findValueByPct(h,.75),t.findValueByPct(h,.5),t.findValueByPct(h,.25)]),p.length>0&&(r.displacementMean=f/p.length,r.displacementQuartiles=[t.findValueByPct(p,.75),t.findValueByPct(p,.5),t.findValueByPct(p,.25)]),r}(e,a),s=(o.removed+o.collapsedRings)/o.uniqueCount||0,u=o.removed/o.removableCount||0,c=o.angleQuartiles,f=o.displacementQuartiles,l=["Simplification statistics"];l.push(t.format("Method: %s (%s) %s",i,a?"spherical":"planar","weighted_visvalingam"==r?"(weighting="+mS.getWeightCoefficient(n)+")":"")),l.push(t.format("Removed vertices: %,d",o.removed+o.collapsedRings)),l.push(t.format("   %.1f% of %,d unique coordinate locations",100*s,o.uniqueCount)),l.push(t.format("   %.1f% of %,d filterable coordinate locations",100*u,o.removableCount)),l.push(t.format("Simplification threshold: %.4f %s",e.getRetainedInterval(),a?"meters":"")),l.push(t.format("Collapsed rings: %,d",o.collapsedRings)),l.push("Displacement statistics"),l.push(t.format("   Mean displacement: %.4f",o.displacementMean)),l.push(t.format("   Max displacement: %.4f",o.displacementMax)),f&&l.push(t.format("   Quartiles: %.2f, %.2f, %.2f",f[0],f[1],f[2])),l.push("Vertex angle statistics"),l.push(t.format("   Mean angle: %.2f degrees",o.angleMean)),c&&l.push(t.format("   Quartiles: %.2f, %.2f, %.2f",c[0],c[1],c[2])),ht(l.join("\n   "))}(r,n),e.info=t.defaults({simplify:n},e.info)}function NS(e,n){return n=n||{},t.defaults({method:TS(n),spherical:CS(e.arcs,n)},n)}function CS(e,t){return!t.planar&&!e.isPlanar()}function zS(e,n){var r=function(e){var t;return"dp"==e.method?t=MS.calcArcData:"visvalingam"==e.method?t=mS.getEffectiveAreaSimplifier(e.spherical):"weighted_visvalingam"==e.method?t=mS.getWeightedSimplifier(e,e.spherical):dt("Unsupported simplify method:",e.method),t}(n);e.setThresholds(new Float64Array(e.getPointCount())),n.spherical?(function(e,n){var r=t.expandoBuffer(Float64Array),i=t.expandoBuffer(Float64Array),a=t.expandoBuffer(Float64Array);e.forEach3((function(e,t,o,s){var u=e.length,c=r(u),f=i(u),l=a(u);Dn.convLngLatToSph(e,t,c,f,l),n(o,c,f,l)}))}(e,r),BS(e)):function(e,t){e.forEach3((function(e,n,r,i){t(r,e,n)}))}(e,r),n.lock_box&&function(e){var t=1e-14,n=e.getBounds();n.padBounds(-t,-t,-t,-t),LS(e,n.toArray(),!0)}(e)}function TS(e){var t=e.method;return(!t||"weighted"==t||"visvalingam"==t&&e.weighting)&&(t="weighted_visvalingam"),t}function LS(e,t,n){var r=e.getBounds().toArray();!0!==Dn.containsBounds(t,r)&&e.forEach3((function(e,r,i){for(var a,o,s=n?1/0:0,u=0,c=i.length;u<c;u++)a=e[u],o=r[u],(a>=t[2]||a<=t[0]||o<=t[1]||o>=t[3])&&(0===s&&(s=DS(i)),i[u]!==1/0&&(i[u]=s))}))}function BS(e){LS(e,Pi(1e-12),!1)}function DS(e){for(var t,n=0,r=0,i=e.length;r<i;r++)(t=e[r])>n&&t<1/0&&(n=t);return n}function RS(e){var n,r,i;return t.isNumber(e)?(r=e,i=e):t.isString(e)&&(n=e.split(/[x ,]/),r=Number(n[0])||0,i=2==n.length?Number(n[1])||0:r),r>=0&&i>=0&&r+i>0||dt("Invalid simplify resolution:",e),[r,i]}function US(e,t,n,r){return 0!==e&&n/r>e/t||0===t?n/e:r/t}function qS(e,t,n){return US(e,t,Dn.degreesToMeters(n.width())*Math.cos(n.centerY()*Dn.D2R),Dn.degreesToMeters(n.height()))}function GS(e,t,n){var r=Wi(t);return CS(t.arcs,n)?Zo(e,r):Ko(e,r)}function VS(e,t,n){var r=RS(e),i=t.getBounds();return.5*(CS(t,n)?qS(r[0],r[1],i):US(r[0],r[1],i.width(),i.height()))}nu.simplify=function(e,n){var r=e.arcs;if(r&&0!==r.size()){if(zS(r,n=NS(e,n)),n.percentage||0===n.percentage)r.setRetainedPct(t.parsePercent(n.percentage));else if(n.interval||0===n.interval)r.setRetainedInterval(GS(n.interval,e,n));else if(n.resolution)r.setRetainedInterval(VS(n.resolution,r,n));else{if(n.presimplify)return;dt("Missing a simplification amount")}kS(e,n)}};var $S=Object.freeze({__proto__:null,finalizeSimplification:kS,getStandardSimplifyOpts:NS,useSphericalSimplify:CS,simplifyPaths:zS,getSimplifyMethod:TS,protectWorldEdges:BS,parseSimplifyResolution:RS,calcPlanarInterval:US,calcSphericalInterval:qS,convertSimplifyInterval:GS,convertSimplifyResolution:VS});function JS(e,t){var n;return t?(e={name:e.name,data:e.data},n=Gs(t,e,null),function(e){var t=n(e);return String(t)}):function(e){return function(t){return(e&&e.name||"split")+"-"+(t+1)}}(e)}nu.sortFeatures=function(e,n,r){var i=Kr(e),a=!r.descending,o=Gs(r.expression,e,n),s=[];t.repeat(i,(function(e){s.push(o(e))}));var u=t.getSortedIds(s,a);e.shapes&&t.reorderArray(e.shapes,u),e.data&&t.reorderArray(e.data.getRecords(),u)},nu.snap=function(e,n){var r=0,i=0,a=e.arcs,o=a&&a.getBounds();o&&o.hasBounds()||dt("Dataset is missing path data"),n.precision?Vo(e,n.precision):r=n.interval?Ko(n.interval,Wi(e)):wn(o.toArray()),a.flatten(),r>0&&n.endpoints?(i=In(a,r),ht(t.format("Snapped %s endpoint%s",i,t.pluralSuffix(i)))):r>0&&(i=An(a,r),ht(t.format("Snapped %s point%s",i,t.pluralSuffix(i)))),(i>0||n.precision)&&(a.dedupCoords(),ya(e))},nu.splitLayer=function(e,n,r){var i,a,o,s=r||{},u=s.no_replace?di(e):e,c=u.data?u.data.getRecords():null,f=u.shapes,l={},d=[];return s.ids?(a=s.ids,o=new Set(a),i=function(e){return o.has(e)?"1":"2"}):i=JS(u,n),t.repeat(Kr(u),(function(e){var t,n=i(e);n in l==0?(l[n]=d.length,t={geometry_type:u.geometry_type,name:n,data:c?new Vr:null,shapes:f?[]:null},d.push(t)):t=d[l[n]],f&&t.shapes.push(f[e]),c&&t.data.getRecords().push(c[e])})),d};var YS=Object.freeze({__proto__:null,getSplitNameFunction:JS});nu.stop=function(e){!function(e){cw(e).stopped=!0}(e)},nu.svgStyle=function(e,t,n){var r;e.data||vi(e),n.where&&(r=Gs(n.where,e,t.arcs)),Object.keys(n).forEach((function(t){var i=t.replace("_","-");if(mf(i)){var a=xf(n[t].trim(),i,e);Jr(e).getRecords().forEach((function(e,t){r&&!r(t)?i in e==0&&(e[i]=void 0):e[i]=a(t)}))}}))};var WS=Uo(.01);function HS(e){return e.fill||"magenta"}function XS(e){return 0===e.radius||0===e.length||0===e.r?0:e.radius||e.length||e.r||5}function QS(e,n){var r=e&&t.isNumber(e[0]),i=!r&&e&&Array.isArray(e[0]);if(r)return n(e);for(var a=0;a<e.length;a++)i&&QS(e[a],n)}function ZS(e){QS(e,(function(e){e[1]=-e[1]}))}function KS(e,t,n){QS(e,(function(e){e[0]=e[0]*t+n[0],e[1]=e[1]*t+n[1]}))}function eA(e,t){if(t){var n=Yc(t,1,[0,0],[0,0]);QS(e,(function(e){var t=n(e[0],e[1]);e[0]=t[0],e[1]=t[1]}))}}function tA(e,t){var n="stick"==t,r=e.direction||0,i=e["stem-taper"]||0,a=e["stem-curve"]||0,o=function(e,t){var n=Math.max(e.radius||e.length||e.r||0,0),r=1,i=function(e){var t,n=(t=e["head-angle"]||40,1/Math.tan(Math.PI*t/180/2)/2),r={stemWidth:e["stem-width"]||2,stemLen:e["stem-length"]||0,headWidth:e["head-width"],headLen:e["head-length"]};return r.headWidth||(r.headLen?r.headWidth=r.headLen/n:r.headWidth=3*r.stemWidth),r.headLen||(r.headLen=r.headWidth*n),r}(e);return n>=0&&(r=function(e,t,n){var r=n["min-stem-ratio"]>=0?n["min-stem-ratio"]:0,i=n["stem-length"]||0,a=1-r,o=t/e,s=1;return o>a?s=a/o:i+t>e&&(s=e/(i+t)),s||0}(n,i.headLen,e),i.stemWidth*=r,i.headWidth*=r,i.headLen*=r,i.stemLen=t?n:n-i.headLen),i.headWidth<i.stemWidth&&dt("Arrow head must be at least as wide as the stem."),i}(e,n);if(!o)return null;var s,u,c,f,l,d=o.stemLen,p=o.headLen,h=o.headWidth/2,g=o.stemWidth/2,m=g*(1-i);if(a){r>0&&(a=-a);var y=Math.abs(a)/180*Math.PI,v=a>0?1:-1,b=m*Math.cos(y),x=m*Math.sin(y)*-v;if(f=d*Math.sin(y/2)*v,l=d*Math.cos(y/2),n)u=nA(-b,-x,f,l);else{var _=nA(-b,-x,-g+f,l),w=nA(b,x,g+f,l);u=_.concat(w.reverse())}}else f=0,l=d,u=n?[[0,0],[0,d]]:[[-m,0],[m,0]];return n?c=[u,s=[[-h+f,d-p],[f,d],[h+f,d-p]]]:(s=[[g+f,l],[h+f,l],[f,p+l],[-h+f,l],[-g+f,l]],(c=u.concat(s)).push(u[0].concat()),c=[c]),"end"==e.anchor?KS(c,1,[-f,-l-p]):"middle"==e.anchor&&KS(c,1,[.5*-f,.5*-l-.25*p]),eA(c,r),e.flipped&&ZS(c),c}function nA(e,t,n,r){if(t>r)return[[e*r/t,r]];for(var i=n-e,a=r-t,o=a-(a*a-i*i)/(2*a),s=Math.sqrt(i*i+a*a)/2,u=Math.PI-2*Math.asin(s/o),c=180*u/Math.PI,f=o/Math.tan(u/2),l=n>e?1:-1,d=Math.round(c/5)+2,p=u/(d+1),h=[[n,r]],g=1;g<=d;g++){var m=g*p/2,y=Math.sin(m),v=y*f*2,b=y*v,x=Math.cos(m)*v;h.push([n-b*l,r-x])}return h.push([e,t]),h}function rA(e){var t,n,r=XS(e),i=+e.sides||{circle:72,triangle:3,square:4,pentagon:5,hexagon:6,heptagon:7,octagon:8,nonagon:9,decagon:10}[e.type]||4,a=i%2==1,o=[];if(r>0==0)return null;i>=3==0&&dt(`Invalid number of sides (${i})`),("b"==e.orientation||e.flipped||e.rotated)&&(a=!a),n=a?0:.5;for(var s=0;s<i;s++)t=(s+n)/i*360,o.push(xg(0,0,t,r));return o.push(o[0].concat()),[o]}function iA(e){var n=Array.isArray(e)?e:ip(e);return t.genericSort(n,!0),t.uniq(n)}nu.symbols=function(e,n,r){ai(e);var i,a=r.no_replace?di(e):e,o=!!r.geographic;o&&(Ji(n),i=r.pixel_scale||function(e,t){var n=yi(e);return(n.width()||n.height()||1e3)/800}(a));var s,u,c=Jr(a).getRecords(),f=vf(a,r),l=a.shapes.map((function(e,n){if(!e)return null;var a=f(n),s=c[n]||{};if(o||"circle"!=a.type)if(o||"ring"!=a.type){var u,l="Polygon";if("arrow"==a.type&&"stick"==r.arrow_style?(u=function(e){return tA(e,"stick")}(a),l="MultiLineString"):"arrow"==a.type?u=function(e){return tA(e,"standard")}(a):"ring"==a.type?(u=function(e){for(var n,r,i=iA(e.radii||"2"),a=[],o=t.isOdd(i.length),s=0;s<i.length;s++)n=rA({type:"circle",radius:i[s]}),(!o||s>0)&&(r=n,(n=rA({type:"circle",radius:i[++s]})).push(r[0])),a.push(n);return a}(a),l="MultiPolygon"):u="star"==a.type?function(e){var t,n,r=XS(e),i=e.points||e.sides&&e.sides/2||5,a=2*i,o=function(e){var t=360/e,n=function(e){var t=Math.ceil(e/2)-2;return function(e,t){return 180-360/e*(t+1)}(e,Math.floor((t+1)/2))}(e),r=Math.PI/180*t/2,i=Math.PI/180*n/2;return Math.tan(i)/(Math.tan(i)+Math.tan(r))/Math.cos(r)}(i)*r,s="b"==e.orientation||e.flipped||e.rotated?0:1,u=[];if(r>0==0)return null;i<5&&dt(`Invalid number of points for a star (${i})`);for(var c=0;c<a;c++)n=c%2==0?o:r,t=(c+s)/a*360,u.push(xg(0,0,t,n));return u.push(u[0].concat()),[u]}(a):rA(a),!u)return null;if(eA(u,+a.rotation||0),o||ZS(u),+r.scale&&KS(u,+r.scale,[0,0]),o)return KS(u,i,e[0]),a.fill&&(s.fill=a.fill),a.stroke&&(s.stroke=a.stroke),function(e,t){return{type:t,coordinates:e}}(u,l);s["svg-symbol"]=function(e,t,n){var r,i;return"MultiPolygon"==n||"Polygon"==n?r={type:"polygon",fill:HS(t),coordinates:"Polygon"==n?e:Tf(e)}:"LineString"==n||"MultiLineString"==n?r={type:"polyline",stroke:(i=t,i.stroke||i.fill||"magenta"),"stroke-width":t["stroke-width"]||2,coordinates:"LineString"==n?[e]:e}:lt("Unsupported type:",n),function(e){QS(e,(function(e){e[0]=WS(e[0]),e[1]=WS(e[1])}))}(r.coordinates),r}(u,a,l)}else s["svg-symbol"]=function(e,n){var r=+n.scale||1,i=iA(e.radii||"2").map((function(e){return e*r})),a=t.isOdd(i.length),o=HS(e),s=[];a&&s.push({type:"circle",fill:o,r:i.shift()});for(var u=0;u<i.length;u+=2)s.push({type:"circle",fill:"none",stroke:o,"stroke-width":Ro(i[u+1]-i[u]),r:Ro(.5*i[u+1]+.5*i[u])});return{type:"group",parts:s}}(a,r);else s["svg-symbol"]=function(e,t){var n=XS(e);return+t.scale&&(n*=+t.scale),{type:"circle",fill:HS(e),r:n}}(a,r)}));return o?(u=function(e,t){var n=e.map((function(e,n){return t[n],{type:"Feature",properties:t[n]||null,geometry:e}}));return Dp({type:"FeatureCollection",features:n})}(l,c),(s=$a(e,n,u,r)).data=a.data):s=a,[s]};var aA=Object.freeze({__proto__:null});function oA(e,t,n){for(var r,i=0;i<e.length;i++)if((r=e[i])>=t&&r<t+n)return r-t;return-1}function sA(e,t,n){for(var r=0;r<t.length;r++)e.push(n?n[t[r]]:null)}function uA(e,t,n){return Gs(e,t,n)}function cA(e,n,r){var i,a,o,s,u,c=iu(e,n,r),f=[];return t.isBoolean(c)||dt("Expression must evaluate to true or false"),c?(a=yi(e,n),i=function(e,n,r){var i,a,o=e.data?e.data.getRecords():null,s=e.shapes;i={geometry_type:e.geometry_type,shapes:[],data:o?[]:null},a={geometry_type:e.geometry_type,shapes:[],data:o?[]:null};var u=r&&r.width()>r.height(),c=s.map((function(e){var t=n.getMultiShapeBounds(e);return u?t.centerX():t.centerY()})),f=t.range(c.length);return f.sort((function(e,t){return c[e]-c[t]})),f.forEach((function(e,t){var n=t<s.length/2?i:a;n.shapes.push(s[e]),o&&n.data.push(o[e])})),o&&(i.data=new Vr(i.data),a.data=new Vr(a.data)),[i,a]}(e,n,a),(o=i[0]).shapes.length>1&&o.shapes.length<e.shapes.length?t.merge(f,cA(o,n,r)):f.push(o),(s=i[1]).shapes.length>1&&s.shapes.length<e.shapes.length?t.merge(f,cA(s,n,r)):f.push(s)):f.push(e),u=JS(e),f.forEach((function(n,r){n.name=u(r),t.defaults(n,e)})),f}function fA(e,n,r){var i,a,o,s,u,c,f,l,d,p,h=e.name,g=e.options;if(function(e,t){return!!function(e){return!0===cw(e).stopped}(t)||!function(e){return["if","elif","else","endif"].includes(e)}(e)&&aw(t)&&!function(e){return!!cw(e).active}(t)}(h,n))return m(null);n||(n=new Dh),n.startCommand(e);try{if(tc.start(),"rename-layers"==h?f=(u=n.catalog.findCommandTargets(g.target||"*")).reduce((function(e,t){return e.concat(t.layers)}),[]):"o"==h?u=n.catalog.findCommandTargets(g.target||g.combine_layers&&"*"):function(e){return"rotate"==e||"info"==e||"proj"==e||"drop"==e||"target"==e||"if"==e||"elif"==e||"else"==e||"endif"==e}(h)?u=n.catalog.findCommandTargets(g.target):((u=n.catalog.findCommandTargets(g.target)).length>1&&("merge-layers"==h||"union"==h)&&(u=wa(u,n.catalog)),1==u.length?(l=(c=u[0].dataset).arcs,f=u[0].layers,n.catalog.setDefaultTarget(f,c)):u.length>1&&dt("This command does not support targetting layers from different datasets")),0===u.length&&(g.target&&dt(t.format("Missing target: %s\nAvailable layers: %s",g.target,Lh(n.catalog))),!function(e){return"graticule"==e||"i"==e||"help"==e||"point-grid"==e||"shape"==e||"rectangle"==e||"include"==e||"print"==e||"comment"==e||"if"==e||"elif"==e||"else"==e||"endif"==e||"stop"==e}(h)))throw new xt("No data is available");if(g.source&&(i=Ch(kh(g.source,u),n.catalog,g)),"affine"==h)nu.affine(f,c,g);else if("alpha-shapes"==h)o=lA(nu.alphaShapes,f,c,g);else if("buffer"==h)o=lA(nu.buffer,f,c,g);else if("data-fill"==h)lA(nu.dataFill,f,l,g);else if("cluster"==h)lA(nu.cluster,f,l,g);else if("calc"==h)lA(nu.calc,f,l,g);else if("classify"==h)lA(nu.classify,f,c,g);else if("clean"==h)nu.cleanLayers(f,c,g);else if("clip"==h)o=nu.clipLayers(f,i,c,g);else if("colorizer"==h)o=nu.colorizer(g);else if("comment"==h);else if("dashlines"==h)lA(nu.dashlines,f,c,g);else if("define"==h)nu.define(g);else if("dissolve"==h)o=lA(nu.dissolve,f,l,g);else if("dissolve2"==h)o=nu.dissolve2(f,c,g);else if("divide"==h)nu.divide(f,c,i,g);else if("dots"==h)o=lA(nu.dots,f,l,g);else if("drop"==h)nu.drop2(n.catalog,u,g);else if("each"==h)lA(nu.evaluateEachFeature,f,c,g.expression,g);else if("erase"==h)o=nu.eraseLayers(f,i,c,g);else if("explode"==h)o=lA(nu.explodeFeatures,f,l,g);else if("external"==h)nu.external(g);else if("filter"==h)o=lA(nu.filterFeatures,f,l,g);else if("filter-fields"==h)lA(nu.filterFields,f,g.fields);else if("filter-geom"==h)lA(nu.filterGeom,f,l,g);else if("filter-islands"==h)lA(nu.filterIslands,f,c,g);else if("filter-islands2"==h)lA(nu.filterIslands2,f,c,g);else if("filter-points"==h)lA(nu.filterPoints,f,c,g);else if("filter-slivers"==h)lA(nu.filterSlivers,f,c,g);else if("frame"==h)nu.frame(n.catalog,i,g);else if("fuzzy-join"==h)lA(nu.fuzzyJoin,f,l,i,g);else if("graticule"==h)n.catalog.addDataset(nu.graticule(c,g));else if("help"==h)hp().printHelp(e.options.command);else if("i"==h)g.replace&&(n.catalog=new Th),(c=nu.importFiles(e.options))&&(n.catalog.addDataset(c),o=c.layers);else if("if"==h||"elif"==h)nu[h](n,g);else if("else"==h||"endif"==h)nu[h](n);else if("ignore"==h)lA(nu.ignore,f,c,g);else if("include"==h)nu.include(g);else if("info"==h)nu.printInfo(ks(u));else if("inlay"==h)o=nu.inlay(f,i,c,g);else if("inspect"==h)lA(nu.inspect,f,l,g);else if("innerlines"==h)o=lA(nu.innerlines,f,l,g);else if("join"==h)lA(nu.join,f,c,i,g);else if("lines"==h)o=lA(nu.lines,f,c,g);else if("merge-layers"==h)o=nu.mergeAndFlattenLayers(f,c,g);else if("mosaic"==h)o=nu.mosaic(f,c,g);else{if("o"==h)return s=xd(u,g),g.final&&(n.catalog=new Th),void ao(s,g,m);if("point-grid"==h)o=[nu.pointGrid(c,g)],c||n.catalog.addDataset({layers:o});else if("point-to-grid"==h)o=nu.pointToGrid(f,c,g);else if("grid"==h)a=nu.polygonGrid(f,c,g);else if("points"==h)o=lA(nu.createPointLayer,f,c,g);else if("polygons"==h)o=nu.polygons(f,c,g);else if("print"==h)nu.print(e._.join(" "));else{if("proj"==h)return void zi(g,(function(){n.resumeCommand();var e=null;try{u.forEach((function(e){nu.proj(e.dataset,n.catalog,g)}))}catch(t){e=t}m(e)}));if("rectangle"==h)i||g.bbox||0===u.length?n.catalog.addDataset(nu.rectangle(i,g)):o=nu.rectangle2(u[0],g);else if("rectangles"==h)o=lA(nu.rectangles,f,c,g);else if("rename-fields"==h)lA(nu.renameFields,f,g.fields);else if("rename-layers"==h)nu.renameLayers(f,g.names,n.catalog);else if("require"==h)nu.require(u,g);else if("rotate"==h)u.forEach((function(e){nu.rotate(e.dataset,g)}));else{if("run"==h)return void nu.run(n,u,g,m);"scalebar"==h?nu.scalebar(n.catalog,g):"shape"==h?n.catalog.addDataset(nu.shape(c,g)):"shapes"==h?o=lA(nu.shapes,f,c,g):"simplify"==h?g.variable?nu.variableSimplify(f,c,g):nu.simplify(c,g):"slice"==h?o=nu.sliceLayers(f,i,c,g):"snap"==h?nu.snap(c,g):"sort"==h?lA(nu.sortFeatures,f,l,g):"split"==h?o=lA(nu.splitLayer,f,g.expression,g):"stop"==h?nu.stop(n):"split-on-grid"==h?o=lA(nu.splitLayerOnGrid,f,l,g):"stitch"==h?nu.stitch(c):"style"==h?lA(nu.svgStyle,f,c,g):"symbols"==h?o=lA(nu.symbols,f,c,g):"subdivide"==h?o=lA(nu.subdivideLayer,f,l,g.expression):"target"==h?nu.target(n.catalog,g):"union"==h?o=nu.union(f,c,g):"uniq"==h?lA(nu.uniq,f,l,g):nu.runExternalCommand(e,n.catalog)}}}"name"in g&&o&&o.forEach((function(e){e.name=g.name})),a?(n.catalog.addDataset(a),o=a.layers,f&&!g.no_replace&&f.forEach((function(e){n.catalog.deleteLayer(e,c)}))):o&&c&&o!=c.layers&&(g.no_replace?(d=o,p=f||[],t.some(p,(function(e){return d.indexOf(e)>-1}))&&lt("Command returned invalid output"),c.layers=c.layers.concat(o)):(Ga(c,f,o),("clip"==h||"erase"==h||"rectangle"==h||"rectangles"==h||"filter"==h&&g.cleanup)&&!g.no_cleanup&&Oa(c)),g.apart?n.catalog.setDefaultTargets(Ca(c,o).map((function(e){return{dataset:e,layers:e.layers.concat()}}))):n.catalog.setDefaultTarget(o,c)),c&&Ua(c)}catch(e){return m(e)}function m(e){n.endCommand(),yt("-",tc.stop()),r(e,e?null:n)}m(null)}function lA(e,n){var r=t.toArray(arguments).slice(2);return n.reduce((function(n,i){var a=e.apply(null,[i].concat(r));return t.isArray(a)?n=n.concat(a):a&&n.push(a),n}),[])}function dA(e){var t=gA.apply(null,arguments);if(yA(e,t,(function(e){t.callback(e)})),t.promise)return t.promise}function pA(e){var t=gA.apply(null,arguments),n=t.callback,r=t.output=[];if(yA(e,t,(function(e){return e?n(e):t.legacy?n(null,vA(r)):n(null,mA(r))})),t.promise)return t.promise}function hA(e){var t,n=gA.apply(null,arguments),r=lr("path").join("/","bin/mapshaper"),i=parseFloat(n.options.xl)||8;if(i<1||i>64)return bt(t=new Error("Unsupported heap size:"+i+"GB")),n.callback(t),n.promise;ft()||(e+=" -quiet");var a=Math.round(1e3*i),o=[process.execPath,"--max-old-space-size="+a,r,e].join(" "),s=lr("child_process").exec(o,{},(function(e,t,r){n.callback(e)}));return s.stdout.pipe(process.stdout),s.stderr.pipe(process.stderr),n.promise?n.promise:void 0}function gA(e,n,r){var i={options:{}};return t.isFunction(n)?i.callback=n:t.isFunction(r)?(i.callback=r,i.legacy=n&&null!=ud(n),i.input=n):i.promise=new Promise((function(e,t){i.callback=function(n,r){n?t(n):e(r)}})),!i.legacy&&t.isObject(n)&&(n.xl?i.options=n:i.input=n),i}function mA(e){return e.reduce((function(e,t){return e[t.filename]=t.content,e}),{})}function yA(e,n,r){var i,a=n.output||null,o=n.input;try{i=lS(e)}catch(e){return bt(e),r(e)}if(n.legacy&&(ht("Warning: deprecated input format"),i=function(e,n){var r=t.find(e,(function(e){return"i"==e.name})),i=t.find(e,(function(e){return"o"==e.name}));return r||(r={name:"i",options:{}},e.unshift(r)),r.options.files=["__input__"],r.options.input={__input__:n},i||e.push({name:"o",options:{}}),e}(i,o),o=null),0===i.length)return r(new xt("No commands to run"));if(0===(i=_A(i)).length)return u(null);i.forEach((function(e){var t;"i"!=(t=e.name)&&"join"!=t&&"erase"!=t&&"clip"!=t&&"include"!=t||!o||(e.options.input=o),"o"==e.name&&a&&(e.options.output=a)}));var s=function(e){var n=e[0],r=n.options;return"i"!=n.name||r.stdin||r.merge_files||r.combine_files||!r.files||r.files.length<2?[e]:r.files.map((function(n){var i=[{name:"i",options:t.defaults({files:[n],replace:!0},r)}];return i.push.apply(i,e.slice(1)),i}))}(i);function u(e,t){e=xA(e),r(e,t)}t.reduceAsync(s,null,(function(e,t,n){bA(t,new Dh,(function(e,t){e=xA(e),n(e,t)}))}),u)}function vA(e){return e.length>1?t.pluck(e,"content"):1==e.length?e[0].content:null}function bA(e,n,r){if(Wa()||"o"!=e[e.length-1].name||(e[e.length-1].options.final=!0),n||(n=new Dh),e=function(e,t){var n={VERBOSE:!1,QUIET:!1,DEBUG:!1},r=t.filter((function(e){if("verbose"==e.name)n.VERBOSE=!0;else if("quiet"==e.name)n.QUIET=!0;else{if("debug"!=e.name)return!0;n.DEBUG=!0}return!1}));return e.initSettings(n),r}(n,e),Wa()||function(){var e=/^--max-old-space-size=([0-9]+)$/,t=process.execArgv.find((function(t){return e.test(t)}));t&&ht("Allocating",e.exec(t)[1]/1e3,"GB of heap memory")}(),0===(e=_A(e)).length)return r(null);t.reduceAsync(e,n,(function(e,t,n){fA(t,e,n)}),r)}function xA(e){return e&&bt(e),e&&"NonFatalError"==e.name?null:e}function _A(e){return e.filter((function(e){if("version"==e.name)mt("0.6.5");else if("encodings"==e.name)Mr();else if("colors"==e.name)Jb(),mt("Built-in color schemes (from d3):"),mt("Categorical\n"+St($b.categorical)),mt("\nSequential\n"+St($b.sequential)),mt("\nDiverging\n"+St($b.diverging)),mt("\nMulti-hue/rainbow\n"+St($b.rainbow));else{if("projections"!=e.name)return!0;Ki()}return!1}))}nu.target=function(e,t){var n=(t.type||"").toLowerCase().replace("linestring","polyline"),r=t.target||"*",i=e.findCommandTargets(r,n);n&&-1=="polygon,polyline,point".split(",").indexOf(n)&&dt("Invalid layer type:",t.type),0===i.length&&dt("No layers were matched (pattern: "+r+(n?" type: "+n:"")+")"),(t.name||""===t.name)&&(i[0].layers[0].name=t.name),e.setDefaultTargets(i)},nu.union=function(e,n,r){e.length<2&&dt("Command requires at least two target layers"),e.forEach(si);var i=Vu(n,r),a=[],o=[],s=[];e.forEach((function(e,t){var n=e.data?e.data.getFields():[];r.fields&&(n=r.fields.indexOf("*")>1?n:n.filter((function(e){return r.fields.indexOf(e)>-1}))),s.push({layer:e,fields:n,records:e.data?e.data.getRecords():null,offset:o.length,size:e.shapes.length}),a=a.concat(n),o=o.concat(e.shapes)}));var u=t.uniqifyNames(a,(function(e,t){return e+"_"+t})),c=new sc({geometry_type:"polygon",shapes:o},i,{flat:!1}),f=c.mosaic,l=f.map((function(e,t){for(var n,r,i,a=c.getSourceIdsByTileId(t),o=[],f=0,l=s.length;f<l;f++)i=-1==(r=oA(a,(n=s[f]).offset,n.size))||null===n.records?null:n.records[r],sA(o,n.fields,i);return function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n}(u,o)}));return[{name:"union",geometry_type:"polygon",shapes:f,data:new Vr(l)}]},nu.uniq=function(e,n,r){var i=Kr(e),a=Gs(r.expression,e,n),o=r.max_count||1,s={},u=[],c=!!r.verbose,f=!!r.invert,l=!!r.index,d=e.data?e.data.getRecords():null,p=function(e,t){return u[t]};t.repeat(i,(function(e){var n,r=a(e),i=r in s?s[r]+1:1,p=i<=o;l?(p=!0,(n=d&&d[e])&&(n.index=i)):f&&(p=!p),u[e]=p,s[r]=i,c&&!p&&ht(t.format("Removing feature %i key: [%s]",e,r))})),e.shapes&&(e.shapes=e.shapes.filter(p)),d&&(e.data=new Vr(d.filter(p))),!1!==r.verbose&&ht(t.format("Retained %,d of %,d features",Kr(e),i))},nu.variableSimplify=function(e,n,r){var i,a,o=e[0],s=n.arcs;1!=e.length&&dt("Variable simplification requires a single target layer"),Hr(o)||dt("Target layer is missing path data"),zS(s,r=NS(n,r)),r.interval?i=function(e,t,n,r){var i=uA(e,t,n.arcs);return function(e){return GS(i(e),n,r)}}(r.interval,o,n,r):r.percentage?i=function(e,n,r,i){var a=uA(e,n,r.arcs),o=ua(r.arcs);return function(e){var n=a(e),r=t.parsePercent(n);return o(r)}}(r.percentage,o,n):r.resolution?i=function(e,t,n,r){var i=uA(e,t,n.arcs);return function(e){return VS(i(e),n.arcs,r)}}(r.resolution,o,n,r):dt("Missing a simplification expression"),a=function(e,n,r){var i,a=new Float64Array(n.size());t.initializeArray(a,-1),e.shapes.forEach((function(e,t){i=r(t),Wn(e||[],u)}));for(var o=0,s=a.length;o<s;o++)-1==a[o]&&(a[o]=0);return a;function u(e){var t=e<0?~e:e,n=a[t];(n>i||-1==n)&&(a[t]=i)}}(o,s,i),function(e,t){e.getVertexData().zz,e.forEach2((function(e,n,r,i,a,o){for(var s=t[o],u=1;u<n-1;u++)a[e+u]>=s&&(a[e+u]=1/0)}))}(s,a),s.setRetainedInterval(1e20),kS(n,r),s.flatten()},nu.splitLayerOnGrid=function(e,n,r){var i,a,o,s,u,c,f,l,d=e.shapes,p=e.geometry_type,h=!!r.id_field,g=r.id_field||"__split__",m=(a=yi(e,n),o=r.cols,s=r.rows,u=a.xmin,c=a.ymin,f=a.width(),l=a.height(),s>0!=0&&o>0!=0||dt("Invalid grid parameters"),f>0!=0&&l>0!=0||(o=1,s=1),function(e){var n=Math.floor((e.centerX()-u)/f*o),r=Math.floor((e.centerY()-c)/l*s);return n=t.clamp(n,0,o-1)||0,"r"+(r=t.clamp(r,0,s-1)||0)+"c"+n});return p||dt("Layer has no geometry"),e.data||(e.data=new Vr(d.length)),i=e.data.getRecords(),e.shapes.forEach((function(e,t){var r="point"==p?Ot([e]):n.getMultiShapeBounds(e),a=r.hasBounds()?m(r):"";(i[t]=i[t]||{})[g]=a})),h?e:nu.splitLayer(e,g).filter((function(e){var t=e.data.getRecordAt(0)[g];return e.name=t,e.data.deleteField(g),!!t}))},nu.subdivideLayer=function(e,t,n){return cA(e,t,n)};var wA=Object.freeze({__proto__:null,runCommands:dA,applyCommands:pA,runCommandsXL:hA,testCommands:function(e,t){yA(e,{},(function(e,n){var r,i=n?n.catalog.getDefaultTargets():[];!e&&i.length>0&&(r=i[0].dataset),t(e,r)}))},runParsedCommands:bA,runAndRemoveInfoCommands:_A}),SA={runCommands:dA,applyCommands:pA,runCommandsXL:hA,enableLogging:ct};function AA(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function IA(e,t,n){var r=n[0],i=n[2];return e>i[0]?(t>i[1]?4:t>=r[1]&&5)||6:e>=r[0]?(t>i[1]?3:t>=r[1]&&8)||7:(t>i[1]?2:t>=r[1]&&1)||0}function MA(e){return 0==e||2==e||4==e||6==e}function PA(e,t){return t<8&&t>=0?(t+8-2*e)%8:t}function EA(e,t,n){e.push(function(e,t){if(MA(e))return t[e/2].concat();lt("Invalid corner sector:",e)}(t,n))}function jA(e,t,n,r){var i,a,o=t?IA(t[0],t[1],r):-1,s=IA(n[0],n[1],r);8==o&&8==s?e.push(n):o==s||(-1==o?8==s?e.push(n):MA(s)&&EA(e,s,r):8==o?(FA(e,t,n,r),MA(s)&&EA(e,s,r)):8==s?(FA(e,t,n,r),e.push(n)):(r=function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3];return 0===e?t=[n,r,i,a]:1==e?t=[r,i,a,n]:2==e?t=[i,a,n,r]:3==e?t=[a,n,r,i]:lt("Invalid rotation number"),t}(i=(a=o)>1&&a<8?Math.floor(a/2):0,r),o=PA(i,o),s=PA(i,s),0==o?0===s||1===s||7===s||(2==s||6==s?EA(e,s,r):3==s?FA(e,t,n,r)||EA(e,2,r):4==s?(FA(e,t,n,r)||(Dn.orient2D(t[0],t[1],n[0],n[1],r[0][0],r[0][1])>1?EA(e,6,r):EA(e,2,r)),EA(e,s,r)):5==s&&(FA(e,t,n,r)||EA(e,6,r))):1==o?2==s||0===s?EA(e,s,r):3==s?FA(e,t,n,r)||EA(e,2,r):4==s?(FA(e,t,n,r)||EA(e,2,r),EA(e,4,r)):5==s?FA(e,t,n,r):6==s?(FA(e,t,n,r)||EA(e,0,r),EA(e,6,r)):7==s&&(FA(e,t,n,r)||EA(e,0,r)):lt("Sector error")))}function OA(e,t,n,r,i){var a=Dn.segmentIntersection(t[0],t[1],n[0],n[1],r[0],r[1],i[0],i[1]);a&&e.push(a)}function FA(e,t,n,r){var i=[];return OA(i,t,n,r[0],r[1]),OA(i,t,n,r[0],r[3]),OA(i,t,n,r[1],r[2]),OA(i,t,n,r[2],r[3]),i.length>0&&(e.push.apply(e,i),!0)}function kA(e,t){var n=Pu(t);e.shapes=e.shapes.map((function(e,r){return function(e){var r=[];return ir(e,(function(e){var i=n(e);if(0===i.length)lt("[cleanPolygon()] Defective path:",e);else if(1==i.length)r.push(i[0]);else{var a,o=Dn.getPlanarPathArea(e,t.arcs)>0?1:-1;i.reduce((function(e,n,r){var i=Dn.getPlanarPathArea(n,t.arcs)*o;return i>e&&(a=n,e=i),e}),0),a&&r.push(a)}})),r.length>0?r:null}(e)}))}var NA=Object.freeze({__proto__:null,repairPolygonGeometry:function(e,t,n){var r=Vu(t);return e.forEach((function(e){kA(e,r)})),e},repairSelfIntersections:kA}),CA={};CA.svg=Object.assign({},ul,Kc,Bf,Uf,Yf),Object.assign(CA,{Job:Dh,Dbf:Sl,DbfReader:Sp,DouglasPeucker:MS,geojson:mc,json:{parse:function(e){var t=yh(new jd(e),0);nh(t);var n=sh(t);return nh(t),t.peek()!=$p&&Kp(t.peek(),t.index()),n}},ShpType:Wl,topojson:Ql,Visvalingam:mS,ArcCollection:da,Bounds:jt,clipIterByBounds:function(e,t){for(var n,r,i,a,o=[],s=function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin]]}(t);e.hasNext();)jA(o,r,n=[e.x,e.y],s),r=n,i||(i=n);return(a=AA(i,n))&&o.length>0&&!AA(o[0],o[o.length-1])&&o.push(o[0].concat()),(a&&o.length<4||o.length<2)&&(o=[]),o},CommandParser:dp,DataTable:Vr,editArcs:d_,GeoJSONReader:vh,Heap:qx,NodeCollection:ja,parseDMS:ww,PathIndex:go,PolygonIndex:ho,ShpReader:Fp,Transform:Et}),Object.assign(CA,Os,lv,ka,Lt,hx,wl,lg,ou,tu,Bh,_x,sx,Sx,Mi,hu,Ya,Gr,Mp,Yl,Hd,Rd,Pr,ed,Md,Zs,uo,Fh,ro,Fd,md,Kx,Xx,Jc,Tc,Pg,Oc,Gp,Mh,bw,ec,Qw,uu,Fx,Rx,Sh,od,FS,Fi,bi,R_,Pt,Eh,Ma,cc,lp,bd,cx,pS,hg,Ea,_o,To,Eo,Tp,ju,tr,nl,l_,Tw,Ct,xu,pc,Nu,rc,hv,NA,oc,ix,IS,tw,na,W_,w_,$o,wA,Kf,Gu,sa,fr,jp,Xl,Bp,$S,Is,la,us,On,zh,YS,Ha,s,Ao,xl,Pf,aA,Bs,nd,Jp,ba,rs,ff,jw);var zA=Object.assign({cli:io,cmd:nu,geom:Dn,utils:t,internal:CA},SA);e.exports?e.exports=zA:"object"==typeof window&&window&&(window.mapshaper=zA)}()},451:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=451,e.exports=t}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(747)})();